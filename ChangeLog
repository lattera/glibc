1999-05-24  Jakub Jelinek  <jj@ultra.linux.cz>

	* sysdeps/sparc/bits/wordsize.h: New file.
	* sysdeps/sparc/bits/fenv.h: New file.
	* sysdeps/sparc/fpu_control.h: New file.
	* sysdeps/sparc/gmp-mparam.h: New file.

	* sysdeps/sparc/sparc32/fpu/bits/fenv.h: Remove.
	* sysdeps/sparc/sparc32/fpu/fpu_control.h: Remove.
	* sysdeps/sparc/sparc64/bits/wordsize.h: Remove.
	* sysdeps/sparc/sparc64/fpu/bits/fenv.h: Remove.
	* sysdeps/sparc/sparc64/fpu/fpu_control.h: Remove.
	* sysdeps/sparc/sparc64/gmp-mparam.h: Remove.

	* sysdeps/unix/sysv/linux/sparc/bits/setjmp.h: New file.
	* sysdeps/unix/sysv/linux/sparc/bits/types.h: New file.
	* sysdeps/unix/sysv/linux/sparc/bits/statfs.h: New file.
	* sysdeps/unix/sysv/linux/sparc/sys/ucontext.h: New file.

	* sysdeps/unix/sysv/linux/sparc/sparc32/sys/ucontext.h: Remove.
	* sysdeps/unix/sysv/linux/sparc/sparc64/bits/setjmp.h: Remove.
	* sysdeps/unix/sysv/linux/sparc/sparc64/bits/types.h: Remove.
	* sysdeps/unix/sysv/linux/sparc/sparc64/bits/statfs.h: Remove.
	* sysdeps/unix/sysv/linux/sparc/sparc64/sys/ucontext.h: Remove.

1999-05-24  Ulrich Drepper  <drepper@cygnus.com>

	* login/openpty.c (openpty): Make sure pty does not because
	controlling TTY.

	* ctype/ctype.h: Don't optimize toupper/tolower for C++.

1999-05-23  Roland McGrath  <roland@baalperazim.frob.com>

	* hurd/set-host.c (_hurd_set_host_config): Use mode 0644, not 0600.
	Do proper error return.

1999-05-23  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* malloc/malloc.h: Add __THROW for __MALLOC_P to synch with usage
	of __P in the rest of glibc; define __MALLOC_PMT and use it.
	Reported by Stephan Kulow <coolo@kde.org>.

1999-05-23  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/alpha/fpu/bits/fenv.h: Pretty print.

	* sysdeps/sparc/sparc64/fpu/bits/fenv.h: Remove unneeded #if.

1999-05-22  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* sysdeps/m68k/fpu/bits/fenv.h (fenv_t): Prepend __ to member
	names to protect from user's macro namespace.
	* sysdeps/arm/fpu/bits/fenv.h (fenv_t): Likewise.
	* sysdeps/generic/bits/fenv.h (fexcept_t, fenv_t): Likewise.
	* sysdeps/i386/fpu/bits/fenv.h (fenv_t): Likewise.
	* sysdeps/mips/bits/fenv.h (fenv_t): Likewise.
	* sysdeps/m68k/fpu/feholdexcpt.c, sysdeps/m68k/fpu/fesetenv.c:
	Adapted.
	* sysdeps/arm/fpu/fegetenv.c, sysdeps/arm/fpu/feholdexcpt.c,
	sysdeps/arm/fpu/fesetenv.c: Likewise.
	* sysdeps/i386/fpu/fclrexcpt.c, sysdeps/i386/fpu/feholdexcpt.c,
	sysdeps/i386/fpu/fesetenv.c, sysdeps/i386/fpu/fraiseexcpt.c,
	sysdeps/i386/fpu/fsetexcptflg.c: Likewise.
	* sysdeps/mips/fesetenv.c: Likewise.

1999-05-22  Roland McGrath  <roland@baalperazim.frob.com>

	* sysdeps/generic/bits/sigstack.h (enum SS_*): Remove trailing comma.

1999-05-20  Ulrich Drepper  <drepper@cygnus.com>

	* configure.in: Recognize and allow gcc 2.95.

1999-05-19  Jakub Jelinek  <jj@ultra.linux.cz>

	* sysdeps/generic/bits/elfclass.h: Version common to
	wordsize-32 and wordsize-64.
	* sysdeps/generic/bits/environments.h: Ditto.
	* sysdeps/generic/stdint.h: Ditto.
	* sysdeps/generic/inttypes.h: Ditto.

	* sysdeps/generic/bits/wordsize.h: New file.
	* stdlib/Makefile: Add bits/wordsize.h to headers.

	* sysdeps/sparc/sparc64/bits/wordsize.h: New file.

	* sysdeps/sparc/sparc64/fpu/bits/fenv.h: Allow the same exported
	headers to be used for 32bit and 64bit ABI compilations.
	* sysdeps/sparc/sparc64/fpu/fpu_control.h: Ditto.
	* sysdeps/unix/sysv/linux/sparc/sparc64/bits/setjmp.h: Ditto.
	* sysdeps/unix/sysv/linux/sparc/sparc64/bits/types.h: Ditto.
	* sysdeps/unix/sysv/linux/sparc/sparc64/bits/statfs.h: Ditto.
	* sysdeps/unix/sysv/linux/sparc/sparc64/sys/ucontext.h: Ditto.

	* sysdeps/wordsize-64/bits/elfclass.h: Remove.
	* sysdeps/wordsize-64/bits/environments.h: Remove.
	* sysdeps/wordsize-64/stdint.h: Remove.
	* sysdeps/wordsize-64/inttypes.h: Remove.
	* sysdeps/wordsize-64/bits/wordsize.h: New file.

	* sysdeps/wordsize-32/bits/elfclass.h: Remove.
	* sysdeps/wordsize-32/bits/environments.h: Remove.
	* sysdeps/wordsize-32/stdint.h: Remove.
	* sysdeps/wordsize-32/inttypes.h: Remove.
	* sysdeps/wordsize-32/bits/wordsize.h: New file.

1999-05-19  Jakub Jelinek  <jj@ultra.linux.cz>

	* sysdeps/sparc/sparc64/memcpy.S (__align_cpy_4, __align_cpy_8,
	__align_cpy_16): New functions.
	(__align_cpy_2, __align_cpy_1): New aliases to memcpy.

	* sysdeps/sparc/sparc32/Versions: New file.
	* sysdeps/sparc/sparc64/Versions: New file.
	* sysdeps/sparc/Versions: Remove.

1999-05-19  Jakub Jelinek  <jj@ultra.linux.cz>

	* sysdeps/unix/sysv/linux/configure.in:
	On sparc64-*-linux*, set slibdir to /lib64 if prefix
	is /usr, plus set libdir to ${exec_prefix}/lib64.
	* sysdeps/unix/sysv/linux/configure: Regenerated.
	* config.make.in: Propagate libdir settings from configure
	to the Makefiles.
	* shlib-versions: sparc64-*-linux* dynamic linker is
	/lib64/ld-linux.so.2.

1999-05-18  Thorsten Kukuk  <kukuk@suse.de>

	* nis/nis_lookup.c (nis_lookup): If we run out of memory, close
	RPC connection.

1999-05-18  Jakub Jelinek  <jj@ultra.linux.cz>

	* sysdeps/sparc/sparc64/rawmemchr.S: New file.
	* sysdeps/sparc/sparc32/sparcv9/rawmemchr.S: New file.

	* sysdeps/sparc/sparc64/memchr.S: Fix if the second argument
	contains garbage in bits 8-63.
	* sysdeps/sparc/sparc64/memset.S: Ditto.
	* sysdeps/sparc/sparc64/strchr.S: Ditto.

1999-05-18  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/wordsize-64/stdint.h (INTPTR_MAX): Add missing ).

1999-05-17  David S. Miller  <davem@redhat.com>

	* sysdeps/sparc/sparc32/atomicity.h: New file.
	* sysdeps/sparc/sparc32/sparcv9/atomicity.h: New file.
	* sysdeps/sparc/sparc64/atomicity.h: New file.
	* sysdeps/sparc/sparc32/sparcv9/Makefile: Add -Wa,-Av9a to
	sysdep-CFLAGS.

1999-05-18  Richard Henderson  <rth@twiddle.net>

	* sysdeps/alpha/memchr.S: Zap high byte of length.  Reschedule.

1999-05-04  Zack Weinberg  <zack@rabi.phys.columbia.edu>

	* argp/argp.h, assert/assert.h, misc/sys/cdefs.h,
	posix/sys/types.h: Handle the case of __GNUC__=3,
	__GNUC_MINOR__=(anything).

1999-05-18  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* sysdeps/i386/i486/bits/string.h (rawmemchr): Remove unneccessary
	if _FORCE_INLINES.

1999-05-17  Ulrich Drepper  <drepper@cygnus.com>

	* elf/Makefile (distribute): Remove dl-origin.h.
	Add dl-dst.h and gen-trusted-dirs.awk.

1999-05-17  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* sysdeps/i386/i486/Versions: New file with inline functions from
	sysdeps/i386/i486/bits/string.h for now.

	* sysdeps/i386/Versions: Add inline functions from
	sysdeps/i386/bits/string.h.

	* string/Versions: Add inline functions from <bits/string2.h>.

	* string/Makefile (routines): Add string-inlines.
	* string/string-inlines.c: New file, used for implementation of
	extern inline functions.

	* sysdeps/i386/i486/bits/string.h: Use _FORCE_INLINES to generate
	non inlined versions of functions.
	* string/bits/string2.h: Likewise.
	* sysdeps/i386/bits/string.h: Likewise.

1999-05-17  Ulrich Drepper  <drepper@cygnus.com>

	* inet/arpa/tftp.h: Add second packed attribute.

1999-05-16  Wolfram Gloger  <wmglo@dent.med.uni-muenchen.de>

	* malloc/malloc.c: Cleanup to bring in line with released
	stand-alone version `ptmalloc'.  Update some comments.
	(internal_function): Move fallback definition so that the source
	compiles outside of libc, and use it in more places.
	(malloc_atfork): Fix when malloc_check is in use.

1999-05-16  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* stdlib/tst-strtod.c: Fix typo.

1999-05-16  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* elf/dl-close.c (_dl_close): Add cast to avoid warning about
	const incorrectness.

1999-05-16  Roland McGrath  <roland@baalperazim.frob.com>

	* sysdeps/generic/bits/termios.h (CRTSCTS): New macro.

1999-05-16  Thorsten Kukuk  <kukuk@suse.de>

	* sunrpc/etc.rpc: Add portmapper, rstat_svc and pcnfs.
	* sunrpc/key_call.c: Fix memory leak, close file handle.
	* nis/nis_creategroup.c: Use malloc instead of calloc,
	set ctime and mtime.
	* nis/nis_subr.c: Check for realloc result.
	* nis/nis_file.c: Fix memory leak.
	* nis/nis_table.c: Pretty print.
	* nis/nis_getservlist.c: Likewise.
	* nis/nis_ismember.c: Likewise.
	* nis/nis_lookup.c: Likewise.
	* nis/nis_ping.c: Likewise.
	* nis/nis_removemember.c: Likewise.
	* nis/nis_util.c: Likewise, check calloc result.

1999-05-16  Roland McGrath  <roland@baalperazim.frob.com>

	* sysdeps/unix/sysv/linux/sys/socketvar.h: Moved to ...
	* sysdeps/generic/sys/socketvar.h: ... here.
	* sysdeps/unix/sysv/linux/netinet/in_systm.h: Moved to ...
	* sysdeps/generic/netinet/in_systm.h: ... here.
	* sysdeps/unix/sysv/linux/Dist: Remove netinet/in_systm.h,
	sys/socketvar.h.
	* sysdeps/unix/sysv/linux/Makefile (sysdep_headers): Likewise.
	* inet/Makefile (headers): Add netinet/in_systm.h here.
	* socket/Makefile (headers): Add sys/socketvar.h here.

1999-05-15  Ulrich Drepper  <drepper@cygnus.com>

	* stdlib/strtol.c: Optimize inner loop of long long versions.

	* sysdeps/gnu/utmpx.h: Add needed type definitions according to
	Unix98.  Add forward declaration of struct utmp.

1999-05-14  Ulrich Drepper  <drepper@cygnus.com>

	* nis/nis_getservlist.c (nis_getservlist): Use malloc instead of
	calloc.

	* nis/nis_checkpoint.c (nis_checkpoint): Fix memory leaks.
	* nis/nis_addmember.c (nis_addmember): Fix memory leak.  Test
	memory allocation results.

1999-05-14  Mark Kettenis  <kettenis@gnu.org>

	* sysdeps/generic/getutmp.c: Include <string.h>
	(getutmp): Rewrite to only copy those members that are really
	present in `struct utmp'.
	* sysdeps/generic/getutmpx.c: Likewise.

1999-05-14  Ulrich Drepper  <drepper@cygnus.com>

	* nss/getXXbyYY.c: Add free_mem function which disposes all
	statically allocated memory when debugging.
	* nss/getXXent.c: Likewise.
	* nss/nsswitch.c: Likewise.

1999-05-13  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/gnu/getutmpx.c: New file.
	* sysdeps/gnu/getutmp.c: New file.

1999-05-13  H.J. Lu  <hjl@gnu.org>

	* login/Versions (getutmpx): Added to GLIBC_2.1.1.
	(getutmp): Likewise.

	* sysdeps/gnu/Makefile (sysdep_routines): Add getutmp and
	getutmpx for login.

	* sysdeps/gnu/utmpx.h (getutmp): Added.
	(getutmpx): Likewise.

	* sysdeps/generic/getutmp.c: New file.

	* sysdeps/generic/getutmpx.c: New file.

1999-05-13  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* glibcbug.in (BUGGLIBC): Change address to
	libc-alpha@sourceware.cygnus.com.

1999-05-12  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* resolv/arpa/nameser.h: Add C++ protectors.

1999-05-08  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* iconvdata/gconv-modules: Fix alias for CP1255.  Reported by
	Elad Tsur <eladts@post.tau.ac.il>.

1999-05-11  Ulrich Drepper  <drepper@cygnus.com>

	* elf/Versions (ld.so) [GLIBC_2.1.1]: Add _dl_lazy.
	* elf/dl-open.c (_dl_open_worker): Only relocate newly loaded objects
	lazily if LD_BIND_NOW is not set.
	* elf/dl-support.c (_dl_lazy): New variable.
	(non_dynamic_init): Set _dl_lazy according to LD_BIND_NOW envvar.
	* elf/rtld.c (_dl_lazy): new global variable.
	( dl_main): Remove lazy, replace it by _dl_lazy.

1999-05-06  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* locale/setlocale.c (new_composite_name): Check also whether the
	first category name differs.

1999-05-11  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* sysdeps/unix/sysv/linux/ftime.c: Use the bsd implementation, not
	the generic one.

1999-05-11  Philip Blundell  <pb@nexus.co.uk>

	* sysdeps/generic/bits/socket.h (struct sockaddr_storage): New
	structure; storage suitable for any socket address.
	* sysdeps/unix/sysv/linux/bits/socket.h (struct sockaddr_storage):
	Likewise.
	* sysdeps/unix/sysv/linux/mips/bits/socket.h (struct
	sockaddr_storage): Likewise.

	* inet/netinet/in.h: Use ULONG_MAX not ~0 to test for a 64-bit
	platform.

1999-05-10  Ulrich Drepper  <drepper@cygnus.com>

	* hesiod/Versions: Change _nss_hesiod_getpwuid and
	_nss_hesiod_getgrgid to _nss_hesiod_getpwuid_r and
	_nss_hesiod_getgrgid_r respectively.  Fixes pr libc/1115.

1999-05-09  Mark Kettenis  <kettenis@gnu.org>

	* hurd/get-host.c (_hurd_get_host_config): Return an empty value
	if the file is empty.

1999-05-07  Ulrich Drepper  <drepper@cygnus.com>

	* elf/do-lookup.h: Fix typo in comment.

	* sysdeps/unix/sysv/linux/fstatvfs.c (fstatvfs): Set f_frsize to
	f_bsize to help some broken programs.

	* stdio-common/tst-printf.c: Add test case for last _itoa problem.

	* stdio-common/vfprintf.c: Fix typo.

1999-05-06  Ulrich Drepper  <drepper@cygnus.com>

	* elf/link.h (struct link_map): New field l_phdr_allocated.
	* elf/dl-load.c (_dl_map_object_from_fd): Don't depend on having
	the program header being part of any loaded segment.  If it is not
	allocate memory and set l_phdr_allocated flag.
	* elf/dl-close.c (_dl_close): Free l_phdr if necessary.

	* nss/digits_dots.c: Correct return value interpretation of
	inet_ntoa.  Fix PR libc/1109.

1999-05-06  Zack Weinberg  <zack@rabi.columbia.edu>

	* sysdeps/sparc/sparc32/sparcv9/Dist: New file.

1999-05-06  Thorsten Kukuk  <kukuk@suse.de>

	* stdlib/fpioconst.c (__tens): Export also for 64bit platforms.
	* stdlib/fpioconst.c: Move #endif before end of struct.

1999-05-05  Ulrich Drepper  <drepper@cygnus.com>

	* Versions.def (ld.so): Add GLIBC_2.1.1.
	* elf/Makefile (routines): Add dl-origin.
	(tests): Add origtest.  Add dependencies for the program.
	* elf/Versions (ld.so) [GLIBC_2.1.1]: Add _dl_origin_path,
	_dl_platformlen, _dl_dst_count and _dl_dst_substitute.
	* elf/dl-deps.c (expand_dst): New macro.  Expand DSTs in filename.
	(_dl_map_object_deps): Use expand_dst to expand DSTs in DT_NEEDED,
	DT_AUXILIARY, and DT_FILTER filenames.
	* elf/dl-load.c (expand_dynamic_string_token): Explode into
	two functions and three macros.
	(_dl_dst_count, _dl_dst_substitute): New functions.
	* elf/dl-dst.h: New file.
	* elf/dl-open.c (_dl_open): Take extra parameter with address of
	caller.  Pass address in args structure.
	(dl_open_worker): Recognize and expand DSTs in filename.
	* elf/ldsodefs.h (_dl_open): Adapt prototype.
	* elf/dlopen.c (dlopen_doit): Pass caller address to _dl_open.
	(__dlopen_check): Pass caller address to dlopen_doit in args.
	* elf/dlopendoit.c: Likewise.
	* iconv/gconv_dl.c: Adapt call of _dl_open.
	* nss/nsswitch.c: Likewise.
	* elf/origtest.c: New file.
	* sysdeps/generic/dl-origin.h: Moved to...
	* sysdeps/generic/dl-origin.c: ...here.
	* sysdeps/unix/sysv/linux/dl-origin.h: Moved to...
	* sysdeps/unix/sysv/linux/dl-origin.c: ...here.

	* stdio-common/_itoa.c (_itoa): Fix special 32bit platform case
	with specific bases and only few bits set in second word.

	* timezone/Makefile (install-others): Create target directory
	before creating tzfiles.

1999-05-05  Thorsten Kukuk  <kukuk@suse.de>

	* nis/nis_file.c (readColdStartFile): Allocate memory only after
	the file is opened successfully.

	* nis/nis_table.c: Fix some memory leaks.

1999-05-04  Ulrich Drepper  <drepper@cygnus.com>

	* elf/dl-load.c (expand_dynamic_string_token): Rewrite to loose st
	variable.

	* elf/dl-load.c (expand_dynamic_string_token): Recognize { }
	around DST.  Correctly ignore ORIGIN IN SUID binaries.

1999-05-03  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/generic/strtok_r.c: Use rawmemchr instead of strchr.
	* sysdeps/generic/strtok.c: Likewise.

	* string/tester.c: Add test of rawmemchr.

	* sysdeps/i386/bits/select.h (__FD_ZERO): Remove memory output
	specification.  It's not necessary.

	* elf/Makefile (trusted-dirs.st): Use gen-trusted-dirs.awk.
	* elf/gen-trusted-dirs.awk: New file.
	* elf/dl-load.c (systems_dirs): Moved into file scope.  Initialize
	from SYSTEM_DIRS macro.
	(system_dirs_len): New variable.  Contains lengths of system_dirs
	strings.
	(fillin_rpath): Rewrite for systems_dirs being a simple string.
	Improve string comparisons.  Change parameter trusted to be a flag.
	Change all callers.
	(_dt_init_paths): Improve using new format for system_dirs.

	* elf/dl-load.c (expand_dynamic_string_token): Don't expand
	$ORIGIN for SUID binaries.

	* sysdeps/unix/sysv/linux/arm/Dist: Add sigrestorer.S.

1999-05-02  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* sunrpc/Makefile: Generate dependencies for all flavors of
	librpcsvc objects.
	(rpcgen-cmd): Pass -Y flag here and remove it from the macro
	invocations.

1999-05-02  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* elf/dlopenold.c: Move #if down after includes to get
	dependencies right.

1999-05-01  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* sysdeps/generic/bzero.c: Undefine __bzero.

1999-05-02  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/unix/sysv/linux/netax25/ax25.h: Update from kernel header.
	* sysdeps/unix/sysv/linux/netrom/netrom.h: Likewise.
	* sysdeps/unix/sysv/linux/netrose/rose.h: Likewise.
	Patch by Craig Small <csmall@scooter.eye-net.com.au>.

	* sysdeps/posix/getaddrinfo.c (gaih_inet_serv): Change fourth
	parameter to struct gaih_servtuple *.  Adapt appropriately.
	(gaih_inet): Use alloca to allocate room for gaih_inet_serv calls.
	This fixes a memory leak.
	Reported by Mikolaj J. Habryn <dichro-glibcbug@rcpt.to>.

	* sysdeps/unix/sysv/linux/sys/procfs.h: Remove greg_t, gregset_t,
	and fpregset_t definition.  They are defined in ucontext.h.

1999-04-14  Scott Bambrough  <scottb@netwinder.org>

	* sysdeps/unix/sysv/linux/arm/net/ethernet.h: struct ether_addr
	and struct ether_header must be packed on the ARM.  The default
	alignment constraints add padding to the end of the structures.

1999-04-14  Scott Bambrough  <scottb@netwinder.org>

	* inet/arpa/tftp.h: struct tftphdr must be packed on the ARM.  The
	default alignment constraints add padding to the end of the
	structure and between members.

1999-05-02  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/generic/dl-cache.c (_dl_load_cache_lookup): Use
	_dl_cache_libcmp instead of strcmp.

	* sysdeps/generic/glob.c (glob_in_dir): It's no error if opendir
	fails on a file.
	Reported by Sergei Ivanov <svivanov@pdmi.ras.ru> [PR libc/1032].

1998-03-30  Joel Klecker  <espy@debian.org>

	* sysdeps/unix/sysv/linux/sparc/sparc32/Makefile
	(sysdep-others,install-bin): Add lddlibc4.

1999-05-02  H.J. Lu  <hjl@gnu.org>

	* timezone/zic.c (dolink): Remove the symlink destination first.

	* catgets/open_catalog.c (__open_catalog): Set catalog->status
	to "nonexisting" if failed to open the file.

1999-05-01  Ulrich Drepper  <drepper@cygnus.com>

	* string/bits/string2.h: Only use __builtin_memset for egcs 1.1 and
	gcc3.

	* sysdeps/i386/i486/bits/string.h: Don't use and define __memset_gg.
	Prevent warnings from multiplication with 0x01010101 by another cast.

1999-04-30  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* string/bits/string2.h (memset): Revert to previous version if
	unaligned writes are not available.

1999-04-30  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/i386/i486/bits/string.h (__memset_gc): Help generating
	better code in presence of the asm.

1999-04-30  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* stdlib/fmtmsg.c (keywords): Increase array size for faster
	indexing.

	* locale/localeinfo.h (_nl_category_names): Increase array element
	size for faster indexing.
	* locale/setlocale.c (_nl_category_names): Adjusted.

1999-04-30  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* iconv/gconv_conf.c (add_alias): Remove wrong cast.

1999-05-01  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* sysdeps/m68k/stackinfo.h: New file.

1999-04-30  Ulrich Drepper  <drepper@cygnus.com>

	* string/tester.c (test_strchrnul): New function.
	(test_memset): Test one more special case.

	* sysdeps/i386/strchrnul.S: Fix bugs which lead to wrong results in
	25% of all cases.

	* sysdeps/i386/i486/bits/string.h: Replace __uintXX_t types with
	base types.

	* string/bits/string2.h: Fix bugs I introduced in last change.

	* sysdeps/i386/i486/bits/string.h (memcmp): Don't introduce partial
	register stall.
	Extend memset optimization.
	Correct i686 version of memchr.

1999-04-30  Roland McGrath  <roland@baalperazim.frob.com>

	* sysdeps/i386/bzero.c: Add #undef __bzero.

	* hurd/hurdinit.c (_hurd_new_proc_init): Don't do initial SIGTRAP if
	EXEC_SIGTRAP was set in the incoming exec flags--that indicates the
	exec server simulated a SIGTRAP before we even started up, so gdb is
	already happy.

1999-04-30  Ulrich Drepper  <drepper@cygnus.com>

	* nss/digits_dots.c: Always initialize not_ok.

1999-04-30 09:02 -0400  Zack Weinberg  <zack@rabi.columbia.edu>

	* string/bits/string2.h (memset): Avoid arithmetic overflow at
	compile time, which produces obnoxious warnings.  If GCCv2 is
	in use, map __bzero to __builtin_memset to enable that
	optimization.

1999-04-29  Ulrich Drepper  <drepper@cygnus.com>

	* string/bits/string2.h: Add more memset optimizations.

	* resolv/inet_addr.c (inet_aton): Optimize switch statement away.

	* resolv/inet_pton.c (inet_pton4): Little optimizations.
	(inet_pton6): Likewise.

	* nss/getXXbyYY_r.c: Include assert.h.
	* nss/getXXbyYY.c: Likewise.

1999-04-29  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* termios/tcgetsid.c (tcgetsid): Rename variable to
	tiocgsid_does_not_work.

1999-04-29  Ulrich Drepper  <drepper@cygnus.com>

	* inet/getnameinfo.c (nrl_domainname): Fix last patch.

1999-04-28  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* nss/digits_dots.c: Use inet_aton to parse IPv4 numbers.
	This allows e.g. gethostbyname to accept "10.1234".
	Reported by Alexander V. Lukyanov <lav@long.yar.ru> [PR libc/1096].

	* nss/test-netdb.c (test_hosts): Add test for gethostbyname and
	non quad IPv4 numbers.

1999-04-29  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* resolv/res_hconf.c (_res_hconf_init): Remove unused variable end.

1999-04-28  Ulrich Drepper  <drepper@cygnus.com>

	* argp/argp-ba.c (argp_program_bug_address): Don't initialize with 0.
	* argp/argp-parse.c (_argp_hang): Likewise.
	* argp/argp-pv.c (argp_program_version): Likewise.
	* argp/argp-pvh.c (argp_program_version_hook): Likewise.
	* inet/ether_hton.c (ether_hton, startp): Likewise.
	* inet/ether_ntoh.c (ether_ntoh, startp): Likewise.
	* inet/getnetgrent_r.c (setup, startp): Likewise.
	* intl/loadmsgcat.c (_nl_msg_cat_cntr): Likewise.
	* intl/localealias.c (string_space, string_space_act, string_space_max,
	nmap, maxmap): Likewise.
	* libio/iopopen.c (proc_file_chain): Likewise.
	* libio/oldiopopen.c (old_proc_file_chain): Likewise.
	* locale/lc-collate.c (__collate_table, __collate_extra,
	__collate_element_hash, __collate_element_strings,
	__collate_element_values): Likewise.
	* malloc/mcheck.c (mcheck_used): Likewise.
	* malloc/mtrace.c (added_atexit_handler): Likewise.
	* malloc/set-freeres.c (already_called): Likewise.
	* misc/getpass.c (getpass) [buf, bufsize]: Likewise.
	* misc/syslog.c (LogStat, LogTag): Likewise.
	* nss/XXX-lookup.c (DATABASE_NAME_SYMBOL): Likewise.
	* nss/getXXbyYY_r.c (startp): Likewise.
	* posix/getopt.c (optarg, __getopt_initialized): Likewise.
	* posix/regex.c (init_syntax_once) [done]: Likewise.
	(debug): Likewise.
	* string/strfry.c (init): Likewise.
	* sunrpc/svc_run.c (svc_top): Likewise.
	* posix/euidaccess.c (have_ids): Likewise.
	* sysdeps/unix/sysv/linux/poll.c (must_emulate): Likewise.
	* sysdeps/unix/sysv/linux/ttyname.c (__ttyname, namelen): Likewise.
	* time/getdate.c (getdate_err): Likewise.
	* time/tzfile.c (transitions, type_idxs, types, zone_names, leaps):
	Likewise.
	* time/tzset.c (old_tz, is_initialized): Likewise.

	* inet/getnameinfo.c (nrl_domainname): Rewrite to allow initialization
	of static data with zero.
	* signal/allocrtsig.c (init): Likewise.

	* string/Makefile (routines): Add strchrnul.
	* string/Versions [GLIBC_2.1.1]: Add strchrnul.
	* string/string.c: Add strchrnul prototype.
	* include/string.h: Add __strchrnul prototype.
	* sysdeps/generic/strchrnul.c: New file.
	* sysdeps/i386/strchrnul.S: New file.
	* sysdeps/i386/bits/string.c: Add strchrnul optimization.
	* sysdeps/i386/i486/bits/string.c: Likewise.
	* argp/argp-help.c (argp_args_usage): Use __strchrnul.
	* inet/ether_line.c (ether_line): Likewise.
	* nscd/nscd_conf.c (nscd_parse_file): Likewise.
	* nss/nsswitch.c (nss_parse_file): Likewise.
	* posix/execvp.c (execvp): Likewise.
	* posix/fnmatch.c (internal_fnmatch): Likewise.
	* resolv/res_hconf.c (_res_hconv_init): Likewise.
	* resolv/res_init.c (res_init): Likewise.
	* stdlib/fmtmsg.c (init): Likewise.
	* stdlib/getsubopt.c (getsubopt): Likewise.

	* catgets/catgets.c (catopen): Only allocate one memory block.
	(catclose): Only one free call necessary.

	* catgets/open_catalog.c (__open_catalog): Simplify handling of
	file descriptor.

	* ctype/ctype-extn.c: Make __toascii_l and __isascii_l alias instead
	of real functions.  Simplify _tolower and _toupper.

	* grp/initgroups.c (compat_call): Remove unnecessary use of pointer
	variable.

	* iconv/gconv.h (struct gconv_info): Change data element from pointer
	to array of size 0.
	* iconv/gconv_open.c (__gconv_open): Allocate structures accordingly.
	* iconv/gconv_close.c (__gconv_close): Don't free data.

	* iconv/gconv_conf.c (add_alias): Avoid searching in tree twice to
	insert new alias.

	* iconv/gconv_db.c (add_derivation): More efficient copying.  Check
	for error while inserting in tree.

	* include/time.h: Pretty print.

	* inet/ruserpass.c: Rewrite use of toktab to avoid string pointers
	in table and lots of relocations.
	* posix/regex.c (regerror): Rewrite use of re_error_msgid to avoid
	string pointers in table and lots of relocations.

	* intl/finddomain.c: Remove definition of strchr macro.

	* io/ftw.c (nftw_arr, ftw_arr): Make const.

	* locale/loadlocale.c (_nl_load_locale): Optimize string copying.

	* locale/localeinfo.h (_nl_category_names): Change into an array with
	fixed width char string elements.
	* locale/setlocale.c (_nl_category_names): Likewise.
	(_nl_current): Make global.
	* locale/nl_langinfo.c (nldata): Removed.  Use _nl_current now.

	* malloc/Makefile (distribute): Add stackinfo.h.
	* sysdeps/generic/stackinfo.h: New file.
	* sysdeps/i386/stackinfo.h: New file.
	* posix/execl.c: Use stackinfo.h in optimizing alloca use.
	* posix/execle.c: Likewise.
	* posix/execlp.c: Likewise.

	* nis/nis_table.c (__create_ib_request): Always use realloc.

	* posix/execvp.c (execute): Rename to script_execute and keep only
	code to execute using shell.
	(execvp): Call execv directly and only fall back on script_execute.

	* resolv/inet_net_pton.c (inet_net_pton_ipv4): Remove digits define
	and always use xdigits instead.

	* resolv/res_init.c (res_init): Use rawmemchr instead of strchr
	where appropriate.

	* stdlib/fpioconst.h (__tens): New declaration.
	(struct mp_power): Remove array, add arrayoff element.
	* stdlib/fpioconst.c: Replace definitions of _ten_p* arrays by one
	__tens array and add in _fpioconst_pow10 offsets into __tens.
	* stdio-common/printf_fp.c: Rewrite to use new __tens array.
	* stdlib/strtod.c: Likewise.

	* stdlib/a64l.c (a64l_table): Avoid unnecessary elements.

	* stdlib/exit.c: Rewrite to use __exit_funcs being as sign for end
	of the list.
	* stdlib/atexit.c (__exit_funcs): Don't initialize.

	* stdlib/fmtmsg.c (keywords): Make name element fixed width array.

	* sunrpc/clnt_perr.c: Rewrite clnt_sperrno and auth_errmsg to use
	a single and an array with offsets.

	* sunrpc/des_soft.c (partab): Make it const.

	* sunrpc/key_call.c (trytimeout, tottimeout): Make const.
	(__key_encryptsession_pk_LOCAL): Don't initialize with 0.
	(__key_decryptsession_pk_LOCAL): Likewise.
	(__key_gendes_LOCAL): Likewise.
	(MESSENGER): Mark const.
	(key_call_private_main): Don't initialize with 0.
	(use_keyenvoy): Don't initialize with 0.
	(key_call): Rewrite to reverse logic of use_doors variable.

	* sunrpc/netname.c (OPSYS): Define as array, not pointer.
	(startp): Don't initialize with zero.

	* sunrpc/openchild.c (_openchild): Make first argument const.

	* sunrpc/pmap_rmt.c (timeout): Mark const.
	* sunrpc/xcrypt.c (hex): Likewise.

	* sysdeps/unix/sysv/linux/getcwd.c: Rewrite to allow omitting
	initialization of global variables.
	* sysdeps/unix/sysv/linux/getpt.c: Likewise.
	* sysdeps/unix/sysv/linux/if_index.c: Likewise.
	* termios/tcgetsid.c: Likewise.

	* sysdeps/unix/sysv/linux/i386/dl-procinfo.h (x86_cap_flags): Change
	fxsr to osfxsr.

	* time/tzfile.c (__tzfile_read): Rewrite to allocate only one memory
	block.  Add function to free memory if wanted.
	* time/tzset.c (tzset_internal): Pass extra argument to __tzfile_read.

	* wcsmbs/wcsmbsload.c (to_wc, to_mb): Correct initializers.

	* wcsmbs/wmemset.c: Little code optimization.

1999-04-23  Paul Eggert  <eggert@twinsun.com>

	* stdlib/strtoull.c: Surround strong_alias and weak_alias with
	ifdef _LIBC.

1999-04-28  Roland McGrath  <roland@baalperazim.frob.com>

	* sysdeps/mach/hurd/getdents.c (__getdirentries): Remove
	implementation and just always fail with ENOSYS.  This entry point is
	obsolete.  Add link warning to that effect.

1999-04-27  Roland McGrath  <roland@baalperazim.frob.com>

	* hurd/get-host.c: Include <hurd/lookup.h>.

1999-04-28  Ulrich Drepper  <drepper@cygnus.com>

	* malloc/malloc.c (rEALLOc): Only free memory for size 0 if oldmem
	is != NULL.

1999-04-28  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* malloc/malloc.c (REALLOC_ZERO_BYTES_FREES): Define it to follow
	ISO C9x and Unix98.

1999-04-28  Ulrich Drepper  <drepper@cygnus.com>

	* libio/iofopncook.c (_IO_cookie_seek): Correct return value.
	Patch by Peter Miller <millerp@canb.auug.org.au>.

1999-04-27  Thorsten Kukuk  <kukuk@suse.de>

	* sunrpc/pmap_clnt.c: Add own get_myaddress function, which
	prefers loopback device.

1999-04-28  Ulrich Drepper  <drepper@cygnus.com>

	* posix/fnmatch.c (internal_fnmatch): Finish incomplete
	no_leading_period change.

	* posix/testfnm.c: More test cases.

1999-04-27  Ulrich Drepper  <drepper@cygnus.com>

	* include/dirent.h: Remove __getdirentries declaration, add __getdents
	and __getdents64.
	* sysdeps/unix/readdir.c: Use __getdents, not __getdirentries.
	* sysdeps/unix/readdir_r.c: Likewise.
	* sysdeps/unix/sysv/linux/readdir64.c: Likewise.
	* sysdeps/unix/sysv/linux/readdir64_r.c: Likewise.
	* sysdeps/unix/sysv/linux/getdents.c: Define __getdents, not
	__getdirentries.  Remove fourth argument.
	* sysdeps/unix/sysv/linux/getdirentries.c: New file.
	* sysdeps/unix/sysv/linux/getdirentries64.c: New file.
	* sysdeps/unix/sysv/linux/Makefile [subdir=dirent] (sysdep_routines):
	Add getdirentries and getdirentries64.
	* sysdeps/unix/sysv/linux/Dist: Add getdirentries and getdirentries64.

	* posix/fnmatch.c (internal_fnmatch): Correctly reset string
	pointer in case of an invalid [[: expression.

	* posix/testfnm.c: Add more test cases.

1999-04-27  Roland McGrath  <roland@baalperazim.frob.com>

	* hurd/hurdexec.c (_hurd_exec): If SIGKILL present in _hurdsig_traced
	set, pass EXEC_SIGTRAP flag in exec RPC.

1999-04-26  Ulrich Drepper  <drepper@cygnus.com>

	* posix/fnmatch.c (internal_fnmatch): Renamed from fnmatch.  Take
	extra parameter.  Fix several more bugs involving wildcard and
	ranges.
	(fnmatch): New function.  Call internal_fnmatch.

	* posix/testfnm.c: More test cases.

1999-04-03  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* manual/install.texi (Configuring and compiling): Explain that
	files are changed in the source directory.
	Closes PR libc/981.
	(Configuring and compiling): Explain situation with PARALLELMFLAGS
	in the source directory.

1999-04-24  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* locale/programs/ld-ctype.c: Spelling fixes.
	(ctype_finish): Fix argument of error message format.
	* locale/programs/ld-messages.c: Spelling fixes.
	* locale/programs/ld-monetary.c: Spelling fixes.
	* locale/programs/ld-time.c (time_finish): Make sure that name and
	format of era_entries are adjacent.
	(time_output): Reduce the size of the io vector.

1999-04-25  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* manual/filesys.texi (Attribute Meanings): Move a misplaced
	paragraph.

1999-04-23  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* locale/programs/ld-collate.c (collate_output): Convert
	undefined_offset to an array index.  Fix computation of other
	endian extra table.

1999-04-26  Roland McGrath  <roland@baalperazim.frob.com>

	* hurd/get-host.c (_hurd_get_host_config): If ENOENT opening file,
	return success with empty value.

1999-04-26  Ulrich Drepper  <drepper@cygnus.com>

	* posix/fnmatch.c: Include string.h also for glibc.
	(fnmatch, case '?'): Optimize if cascades a bit.
	(fnmatch, case '*'): Correct handling if FNM_PATHNAME is set.

	* posix/testfnm.c: Add test cases for * with FNM_PATHNAME errors.

1999-04-24  Ulrich Drepper  <drepper@cygnus.com>

	* iconv/gconv_builtin.h: Add definitions for UTF16 builtins.
	* iconv/gconv_int.h: Declare UTF16 functions.
	* iconv/gconv_simple.c: Add UTF16 conversion functions.

1999-04-20  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* posix/wordexp.c (parse_param): Fix type of offset to allow it to
	be used correctly as parameter for parse_dollars/parse_tilde.

1999-04-19  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* manual/conf.texi (Utility Limits): Remove duplicate description
	of BC_DIM_MAX.

1999-04-19  Ulrich Drepper  <drepper@cygnus.com>

	* wcsmbs/mbsnrtowcs.c (__mbsnrtowcs): Correctly initialize
	outbufend for dst==NULL.

1999-04-18  Ulrich Drepper  <drepper@cygnus.com>

	* wcsmbs/mbsrtowcs.c (__mbsrtowcs): Correctly initialize outbufend
	for dst==NULL.
	Fixes PR libc/1084.

	* socket/sys/socket.h: Define SHUT_RD, SHUT_WR, and SHUT_RDWR.
	Fixes PR libc/1083.

1999-04-18  Thorsten Kukuk  <kukuk@suse.de>

	* sunrpc/Makefile: Remove special handling of bootparam.x,
	add rpcsvc/bootparam.h to headers.
	* sunrpc/rpcsvc/bootparam.h: New, for backward compatibility.
	* sunrpc/rpcsvc/bootparam.x: Renamed to...
	* sunrpc/rpcsvc/bootparam_prot.x: ...this.

1999-04-18  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/unix/bsd/poll.c (__poll): Add more compatiblity code to
	detect and handle invalid descriptors.

1999-04-17  Thorsten Kukuk  <kukuk@suse.de>

	* timezone/zic.c (dolink): Append complete path not only filename
	to ../ list.

1999-04-17  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* iconvdata/ibm874.c (TABLES, CHARSET_NAME): Follow name change.

1999-04-17  Ulrich Drepper  <drepper@cygnus.com>

	* iconvdata/gconv-modules: Rename CP874 to IBM874.
	* iconvdata/Makefile: Likewise.
	* iconvdata/cp874.h: Removed.
	* iconvdata/cp874.c: Renamed to...
	* iconvdata/ibm874.c: ...this.

1999-04-16  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/unix/sysv/linux/bits/types.h: Correct
	signed/unsigned-ness of blkcnt and fsblkcnt.
	* sysdeps/unix/sysv/linux/alpha/bits/types.h: Likewise.
	* sysdeps/unix/sysv/linux/mips/bits/types.h: Likewise.

	* sysdeps/unix/sysv/linux/bits/socket.h: Add SOL_PACKET, SOL_ATM,
	SOL_AAL, and SOL_IRDA.

1999-04-15  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* sysdeps/unix/sysv/linux/fstatvfs.c: Set f_frsize to zero.  Don't
	include "linux_fsinfo.h".
	Based on a patch by H.J. Lu <hjl@gnu.org>.

1999-04-16  Thorsten Kukuk  <kukuk@suse.de>

	* sunrpc/rpc_cout.c (print_header): Use int32_t pointer, not long.

1999-04-16  Ulrich Drepper  <drepper@cygnus.com>

	* nscd/cache.c (prune_cache): Only disable file checking for
	future if the file does not exist.
	Update file_mtime if cache was flushed.

1999-04-15  David S. Miller  <davem@redhat.com>

	* sysdeps/sparc/sparc32/strcat.S: Avoid using register g6.
	* sysdeps/sparc/sparc32/strcpy.S: Likewise.

1999-04-15  Scott Bambrough  <scottb@netwinder.org>

	* sysdeps/unix/sysv/linux/arm/sigaction.c: Fix typo in preventing
	compilation of file.

1999-04-15  Ulrich Drepper  <drepper@cygnus.com>

	* Versions.def: Add GLIBC_2.1.1 to libpthread.

	* iconvdata/Makefile (modules): Add KOI8-U.
	(distribute): Add koi8-u.c.
	(gen-8bit-gap-modules): Add koi8-u.
	* iconvdata/gconv-modules: Add KOI8-U entries.
	* iconvdata/koi8-u.c: New file.

1999-04-13  Thorsten Kukuk  <kukuk@suse.de>

	* sunrpc/auth_des.c: 64bit fixes, security fixes.
	* sunrpc/auth_none.c: Pretty print.
	* sunrpc/auth_unix.c: Likewise.
	* sunrpc/authdes_prot.c: Likewise.
	* sunrpc/authuxprot.c: Likewise.
	* sunrpc/bindrsvprt.c: Likewise.
	* sunrpc/clnt_gen.c: Likewise.
	* sunrpc/rpc/xdr.h: Likewise.
	* sunrpc/rpc/auth_des.h: Add rpc_timeval struct.
	* sunrpc/rpc_cmsg.c: Don't use *long pointers.
	* sunrpc/rtime.c: Use new rpc_timeval.
	* sunrpc/svc_authux.c: Don't use *long pointers.
	* sunrpc/svcauth_des.c: Likewise + security fixes.
	* sunrpc/xdr_mem.c: Don't use *long pointers.
	* sunrpc/xdr_rec.c: Likewise.
	* sunrpc/xdr_sizeof.c: Likewise.
	* sunrpc/xdr_stdio.c: Likewise.

1999-04-15  Ulrich Drepper  <drepper@cygnus.com>

	* sunrpc/clnt_udp.c (clntudp_call): Move initialization of anyup
	so that it is redone for each sending.

1999-04-15  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* sunrpc/clnt_udp.c (clntudp_call): Initialize anyup.

1999-04-15  Ulrich Drepper  <drepper@cygnus.com>

	* iconv/gconv_db.c (__gconv_find_transform): If conversion is
	known to not exist don't try to load shared objects.
	Patch by Petr Vandrovec Ing. VTEI <VANDROVE@vc.cvut.cz>.

	* nscd/cache.c (prune_cache): The table might not be unused.  In
	this case do nothing.

	* catgets/gencat.c (read_input_file): Don't drop white spaces
	between number/identifier and string.
	Patch by Dima Barsky <dima@pwd.hp.com>.
	If no white space at all follows number/identifier remove existing
	message with the number/identifier.

1999-04-14  H.J. Lu  <hjl@gnu.org>

	* sunrpc/clnt_udp.c (is_network_up): New function.
	(clntudp_call): Call is_network_up () to check if any network
	interface is up in case of timeout.

1999-04-14  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* wctype/test_wcfuncs.c: New file, tests towlower and towupper.
	* wctype/Makefile (tests): Add test_wcfuncs.

1999-04-14  Jakub Jelinek  <jj@ultra.linux.cz>

	* scripts/config.sub: Allow sparcv[6789]-* and sparcv8plus{,a}-*
	architectures.
	* sysdeps/sparc/sparc32/sparcv8/Makefile: Use sysdep-CFLAGS
	instead of CFLAGS.
	* sysdeps/sparc/sparc32/sparcv8/Makefile: Use sysdep-CFLAGS
	instead of CFLAGS. For gnulib and string directories use
	-Wa,-Av9a gcc ASFLAGS.
	* sysdeps/sparc/sparc32/sparcv9/memmove.c: New file.
	* sysdeps/unix/sysv/linux/sparc/sparc32/dl-procinfo.h: New file.
	* sysdeps/unix/sysv/linux/sparc/sparc64/dl-procinfo.h: New file.
	* shlib-versions: Handle sparcv[6789]-* and sparcv8plus{,a}-*
	the same way as sparc-*.

1999-04-14  Ulrich Drepper  <drepper@cygnus.com>

	* locale/programs/locfile.c (locfile_read): Fix typo.
	Patch by Kaoru Fukui <k_fukui@highway.ne.jp>.

1999-04-14  Scott Bambrough  <scottb@netwinder.org>

	* sysdeps/unix/sysv/linux/arm/socket.S: Socket calls could not be
	restarted after being interrupted by a signal.  The parameters on
	the stack were corrupted by the signal handler.

	* sysdeps/unix/sysv/linux/arm/mmap.S: mmap calls could not be
	restarted after being interrupted by a signal.  The parameters on
	the stack were corrupted by the signal handler.

1999-04-14  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* wctype/wcfuncs.c (towlower): Use __ctype_tolower.
	Reported by Kalle Olavi Niemitalo <tosi@ees2.oulu.fi>

1999-04-12  Tim Waugh  <tim@cyberelk.demon.co.uk>

	* posix/wordexp-test.c: In field-splitting test cases where
	subshells were involved, unset IFS first: some shells (ash) use
	IFS even when no expansion is performed.

1999-04-13  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* libio/obprintf.c (_IO_obstack_overflow): Put the write end at
	the real end of the chunk, not some random point inbetween.
	(_IO_obstack_xsputn): Likewise.  Actually copy the data into the
	obstack when growing.  Use fast version of obstack_blank when
	shrinking.
	(struct _IO_obstack_file): Use _IO_FILE_plus instead of explicitly
	allocating the vtable pointer.
	(_IO_obstack_vprintf): Adjust for above change and avoid
	unnecessary casts.  Use fast version of obstack_blank when
	shrinking.
	Fixes PR libc/1075.

1999-04-12  Ulrich Drepper  <drepper@cygnus.com>

	* iconvdata/gconv-modules: Fix typo.  Add UJIS alias.
	Reported by GOTO Masanori <gotom@cs.titech.ac.jp>.

1999-04-11  Tim Waugh  <tim@cyberelk.demon.co.uk>

	* posix/wordexp.c (wordexp): Fix a leak when an invalid character
	is seen, as well as fixing semantics.  Don't reset the word count
	to zero when an invalid character is seen, but leave it as it was
	(this makes a difference with WRDE_APPEND).

	* posix/wordexp-test.c: More test cases.

	* posix/wordexp.c (parse_param): In words like ${var#pattern},
	always expand pattern when it is needed.  Also, handle quoting in
	pattern properly.

1999-04-12  Philip Blundell  <philb@gnu.org>

	* elf/elf.h: Update ARM definitions to match current gas2.

	* sysdeps/arm/bits/endian.h: Support big endian operation.

	* sysdeps/unix/sysv/linux/arm/ioperm.c (_outw, _outb, _outl):
	Don't bother range checking the port number.

	* sysdeps/unix/sysv/linux/arm/vfork.S: New file.

	* sysdeps/unix/sysv/linux/arm/sysdep.h (INLINE_SYSCALL): Include
	the syscall name in assembler output for ease of debugging.

	* sysdeps/unix/sysv/linux/arm/sigaction.c: Don't rely on undefined
	compiler behaviour.
	* sysdeps/unix/sysv/linux/arm/sigrestorer.S: New file.
	* sysdeps/unix/sysv/linux/arm/Makefile [$(subdir) = signal]
	(sysdep_routines): Add sigrestorer.

	* string/tester.c (test_strcpy): Add new tests for unaligned
	arguments.
	* sysdeps/arm/bits/string.h: Delete inline implementations of
	strcpy and stpcpy.

1999-04-11  Ulrich Drepper  <drepper@cygnus.com>

	* libio/Makefile (CPPFLAGS-.o): Don't define IO_DEBUG.

1999-04-10  Mark Kettenis  <kettenis@gnu.org>

	* sysdeps/mach/hurd/Dist: Add clk_tck.c.

1999-04-10  Ulrich Drepper  <drepper@cygnus.com>

	* iconvdata/Makefile (modules): Add TIS-620.
	(distribute): Add tis-620.c.
	(gen-8bit-gap-modules): tis-620.
	* iconvdata/tis-620.c: New file.
	* iconvdata/gconv-modules: Add TIS-620 entries.

	* iconvdata/asmo_449.c: Correct comment.

1999-04-10  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* manual/install.texi (Configuring and compiling): Comment out
	description of --disable-static since this doesn't work currently
	(see change by Ulrich Drepper on 1998-12-07 for configure.in).

1999-04-10  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/generic/dl-cache.c (_dl_load_cache_lookup): Rewrite to
	use binary search.
	Based on a patch by Jakub Jelinek <jj@sunsite.ms.mff.cuni.cz>.

1999-04-08  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* scripts/test-installation.pl (installation_problem): Skip
	libnss1_* libraries from glibc-compat add-on.

1999-04-07  H.J. Lu  <hjl@gnu.org>

	* io/Versions (__dup2, __pipe): Added to GLIBC_2.0 for
	libstdc++ 2.7.2.
	* posix/Versions (__waitpid): Likewise.

1999-04-08  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* manual/install.texi (Reporting Bugs): Add section about reported
	bugs and correct email address of glibcbug script.

1999-04-01  Thorsten Kukuk  <kukuk@suse.de>

	* sunrpc/Versions: Add new xdr functions to GLIBC_2.1.1
	* sunrpc/xdr.c: Add xdr_hyper, xdr_u_hyper, xdr_longlong_t and
	xdr_u_longlong_t. Based on patch from Dan Shechter
	<damageboy@isdn.net.il>.
	* sunrpc/xdr_intXX_t.c: Implement xdr_int64_t, xdr_uint64_t
	* sunrpc/rpc/xdr.h: Add prototypes for new xdr functions.

	* nis/nis_lookup.c (nis_lookup): Don't overwrite RPC error code.

1999-04-07  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* sysdeps/unix/sysv/linux/getdents.c (__getdirentries): Return
	directly if getdents returns with error set.

1999-04-05  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* locale/langinfo.h (THOUSEP): Rename second occurence of
	THOUSANDS_SEP to THOUSEP.
	Reported by Roman Belenov <roman@nstl.nnov.ru>.

1999-04-05  Roland McGrath  <roland@baalperazim.frob.com>

	* hurd/STATUS: File removed.  Moved items that are still relevant into
	TODO list in hurd source.

1999-03-26  Mark Kettenis  <kettenis@gnu.org>

	* sysdeps/mach/hurd/bits/time.h: New file.
	* sysdeps/mach/hurd/getrusage.c: New file.
	* sysdeps/mach/hurd/clk_tck.c: New file.
	* sysdeps/mach/hurd/Versions (libc) [GLIBC_2.1.1]: Add __libc_clk_tck.
	* sysdeps/mach/hurd/Makefile [$(subdir) = posix]
	(sysdep_routines): Add clk_tck.
	* sysdeps/mach/hurd/times.c: Removed, since getrusage is now
	implemented.

1999-04-02  Ulrich Drepper  <drepper@cygnus.com>

	* misc/syslog.c (closelog_internal): Do not reset LogTag here.
	(closelog): But instead here.
	Patch by Alan Curry <pacman@cqc.com> [PR libc/1061].

1999-04-02  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* elf/Makefile (CFLAGS-multiload.c): Change to allow building in
	the source directory.  Fixes PR libc/1059.

1999-04-01  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* sysdeps/unix/sysv/linux/ttyname.c (ttyname): Terminate the string.
	* sysdeps/unix/sysv/linux/ttyname_r.c (__ttyname_r): Likewise.

1999-04-01  Ulrich Drepper  <drepper@cygnus.com>

	* iconvdata/TESTS: Add ISO-8859-14 and ISO-8859-15.
	* iconvdata/testdata/ISO-8859-14: New file.
	* iconvdata/testdata/ISO-8859-14..UTF8: New file.
	* iconvdata/testdata/ISO-8859-15: New file.
	* iconvdata/testdata/ISO-8859-15..UTF8: New file.

1999-03-31  Ulrich Drepper  <drepper@cygnus.com>

	* iconvdata/testdata/CP1258: New file.
	* iconvdata/testdata/CP1258..UTF8: New file.
	* iconvdata/TESTS: Add CP1258 entry.

	* iconvdata/cp874.h (to_ucs4): Add Euro sign.

	* timezone/africa: Update from tzdata1999d.
	* timezone/europe: Likewise.
	* timezone/northamerica: Likewise.

1999-03-31  Mark Kettenis  <kettenis@gnu.org>

	* login/programs/pt_chown.c (main): Save effective user ID before
	dropping priviliges and use this to check if the program is
	properly installed.

1999-03-31  Ulrich Drepper  <drepper@cygnus.com>

	* iconvdata/testdata/CP1254: Update for charmap changes.
	* iconvdata/testdata/CP1254..UTF8: Likewise.
	* iconvdata/testdata/CP1255: Likewise.
	* iconvdata/testdata/CP1255..UTF8: Likewise.
	* iconvdata/testdata/CP1256: Likewise.
	* iconvdata/testdata/CP1256..UTF8: Likewise.
	* iconvdata/testdata/CP1257: Likewise.
	* iconvdata/testdata/CP1257..UTF8: Likewise.

	* iconvdata/Makefile (distribute): Remove cp1258.h.
	(gen-8bit-gap-modules): Add cp1258.
	* iconvdata/cp1258.h: Removed.

1999-03-30  Ulrich Drepper  <drepper@cygnus.com>

	* timezone/tst-timezone.c (tests): Add more cases.
	(check_tzvars): Mark errors clearer.
	(main): Likewise.

1999-03-30 20:59 -0500  Zack Weinberg  <zack@rabi.phys.columbia.edu>

	* login/programs/pt_chown.c: Drop privileges if invoked with
	arguments.  Don't close the master pty.

1999-03-30  Ulrich Drepper  <drepper@cygnus.com>

	* time/tzfile.c (__tzfile_read): Process transitions from the rear.
	Minor optimization.

1999-03-29  Ulrich Drepper  <drepper@cygnus.com>

	* elf/rtld.c (process_envvars): Do not automatically prevent lazy
	relocation for SUID binaries.

1999-03-29  Paul Eggert  <eggert@twinsun.com>

	* libio/iopopen.c (_IO_new_proc_open): Don't modify proc_file_chain
	while in child process.

1999-03-29  Jakub Jelinek  <jj@ultra.linux.cz>

	* sysdeps/sparc/sparc32/sparcv8/Makefile: New file.
	* sysdeps/sparc/sparc32/sparcv8/rem.S: Delay after write %y.
	* sysdeps/sparc/sparc32/sparcv8/sdiv.S: Likewise.
	* sysdeps/sparc/sparc32/sparcv8/udiv.S: Likewise.
	* sysdeps/sparc/sparc32/sparcv8/urem.S: Likewise.

	* sysdeps/sparc/sparc32/sparcv9/bcopy.c: New file.
	* sysdeps/sparc/sparc32/sparcv9/bzero.c: New file.
	* sysdeps/sparc/sparc32/sparcv9/memchr.S: New file.
	* sysdeps/sparc/sparc32/sparcv9/memcmp.S: New file.
	* sysdeps/sparc/sparc32/sparcv9/memcpy.S: New file.
	* sysdeps/sparc/sparc32/sparcv9/memset.S: New file.
	* sysdeps/sparc/sparc32/sparcv9/stpcpy.S: New file.
	* sysdeps/sparc/sparc32/sparcv9/strcat.S: New file.
	* sysdeps/sparc/sparc32/sparcv9/strchr.S: New file.
	* sysdeps/sparc/sparc32/sparcv9/strcmp.S: New file.
	* sysdeps/sparc/sparc32/sparcv9/strcpy.S: New file.
	* sysdeps/sparc/sparc32/sparcv9/strcspn.S: New file.
	* sysdeps/sparc/sparc32/sparcv9/strlen.S: New file.
	* sysdeps/sparc/sparc32/sparcv9/strncpy.S: New file.
	* sysdeps/sparc/sparc32/sparcv9/strpbrk.S: New file.
	* sysdeps/sparc/sparc32/sparcv9/strrchr.c: New file.
	* sysdeps/sparc/sparc32/sparcv9/strspn.S: New file.
	* sysdeps/sparc/sparc32/sparcv9/dotmul.S: New file.
	* sysdeps/sparc/sparc32/sparcv9/rem.S: New file.
	* sysdeps/sparc/sparc32/sparcv9/sdiv.S: New file.
	* sysdeps/sparc/sparc32/sparcv9/udiv.S: New file.
	* sysdeps/sparc/sparc32/sparcv9/umul.S: New file.
	* sysdeps/sparc/sparc32/sparcv9/urem.S: New file.
	* sysdeps/sparc/sparc32/sparcv9/Makefile: New file.
	* sysdeps/sparc/sparc32/sparcv9/stpncpy.S: New file.
	* sysdeps/sparc/sparc32/sparcv9/strncmp.S: New file.

	* sysdeps/sparc/sparc32/bcopy.c: New file.
	* sysdeps/sparc/sparc32/bzero.c: New file.
	* sysdeps/sparc/sparc32/memchr.S: New file.
	* sysdeps/sparc/sparc32/memcpy.S: New file.
	* sysdeps/sparc/sparc32/memmove.c: New file.
	* sysdeps/sparc/sparc32/memset.S: New file.
	* sysdeps/sparc/sparc32/stpcpy.S: New file.
	* sysdeps/sparc/sparc32/strchr.S: New file.
	* sysdeps/sparc/sparc32/strrchr.c: New file.
	* sysdeps/sparc/sparc32/strcpy.S: New file.
	* sysdeps/sparc/sparc32/strlen.S: New file.
	* sysdeps/sparc/sparc32/strcat.S: New file.
	* sysdeps/sparc/sparc32/strcmp.S: New file.

	* sysdeps/sparc/sparc64/bcopy.c: New file.
	* sysdeps/sparc/sparc64/bzero.c: New file.
	* sysdeps/sparc/sparc64/memchr.S: New file.
	* sysdeps/sparc/sparc64/memcmp.S: New file.
	* sysdeps/sparc/sparc64/memcpy.S: New file.
	* sysdeps/sparc/sparc64/memset.S: New file.
	* sysdeps/sparc/sparc64/stpcpy.S: New file.
	* sysdeps/sparc/sparc64/strcat.S: New file.
	* sysdeps/sparc/sparc64/strchr.S: New file.
	* sysdeps/sparc/sparc64/strcmp.S: New file.
	* sysdeps/sparc/sparc64/strcpy.S: New file.
	* sysdeps/sparc/sparc64/strcspn.S: New file.
	* sysdeps/sparc/sparc64/strlen.S: New file.
	* sysdeps/sparc/sparc64/strncpy.S: New file.
	* sysdeps/sparc/sparc64/strpbrk.S: New file.
	* sysdeps/sparc/sparc64/strrchr.c: New file.
	* sysdeps/sparc/sparc64/strspn.S: New file.
	* sysdeps/sparc/sparc64/stpncpy.S: New file.
	* sysdeps/sparc/sparc64/strncmp.S: New file.

	* sysdeps/unix/sysv/linux/sparc/sparc32/Makefile (ASFLAGS-.os):
	Append -fPIC, don't replace.

	* configure.in: Recognize sparcv8plus / sparcv9.

1999-03-27  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* malloc/obstack.h (obstack_free): Explicitly convert __obj to
	char * to avoid C++ warning.
	Patch by yasushi@cs.washington.edu [PR libc/1035].

1999-03-29  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* manual/filesys.texi (Temporary Files): mktemp and mkstemp are
	declared in stdlib.h, correct return value of mkstemp.
	Reported by Andries Brouwer <Andries.Brouwer@cwi.nl>.

	* sysdeps/unix/sysv/linux/net/if_arp.h (ARPHDRD_FC*): New defines
	from Linux 2.2.5.

1999-03-28  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* misc/regexp.h (compile): Cast some pointers to (char *) to avoid
	C++ warning.

	* ctype/ctype.h (tolower, toupper): Add __THROW declaration to
	inline functions.  Closes PR libc/1049.

1999-03-25  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* timezone/README: Update from tzdata1999c and tzcode1999c.

	* timezone/africa: Update from tzdata1999c.
	* timezone/antarctica: Likewise.
	* timezone/asia: Likewise.
	* timezone/australasia: Likewise.
	* timezone/europe: Likewise.
	* timezone/northamerica: Likewise.
	* timezone/southamerica: Likewise.
	* timezone/zone.tab: Likewise.

	* timezone/zic.c: Update from tzcode1999c.

1999-03-26  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* Makerules: Add $(common-objpfx)Versions.all to common-generated
	outside of ifndef avoid-generated.

	* libio/oldiofdopen.c (_IO_old_fdopen): Bring over recent changes
	in iofdopen.c.
	* libio/oldiofopen.c (_IO_old_fopen): Bring over recent changes in
	iofopen.c.
	* libio/oldiofclose.c (_IO_old_fclose): Bring over recent changes
	in iofclose.c.
	* libio/oldfileops.c (_IO_old_file_underflow, _IO_old_file_sync,
	_IO_old_file_seekoff): Bring over recent changes in fileops.c.

1999-03-26  Mark Kettenis  <kettenis@gnu.org>

	* sysdeps/mach/hurd/Makefile: Only install libc_p.a linker script
	if we build the profiled library.

1999-03-26  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* math/Makefile (gmp-objs): Add inlines.  Reported by Andreas
	Jaeger <aj@arthur.rhein-neckar.de>

1999-03-25  Roland McGrath  <roland@yaumatei.ai.mit.edu>

	* sysdeps/mach/hurd/i386/Makefile [$(subdir) = csu]
	(CFLAGS-initfini.s): New variable, add -DWEAK_GMON_START.
	This does for Hurd/i386 what the 1998-09-08 change did for Linux/i386.

1999-03-24  Roland McGrath  <roland@baalperazim.frob.com>

	* Makeconfig (sysd-sorted): Use $(..) on rhs of patsubst, so this rule
	works properly in subdirs.

1999-03-23  Roland McGrath  <roland@baalperazim.frob.com>

	* sysdeps/mach/hurd/Makefile: Undo last change.
	[$(subdir) = mach] (lib-noranlib): Depend on libmachuser-link.so.
	[$(subdir) = hurd] (lib-noranlib): Depend on libhurduser-link.so.

	* mach/Machrules (+preinit, +postinit, +interp,
	LDFLAGS-$(interface.so)): Variables removed.  Interface libraries get
	linked just like other shared libraries.
	(interface.so): Fix typo in defn, so it works.
	($(objpfx)$(interface.so)): Make it depend on libc.so.

1999-03-21  Roland McGrath  <roland@baalperazim.frob.com>

	* sysdeps/mach/hurd/Makefile (subdir_lib): Depend on
	$(link-rpcuserlibs).

1999-03-22  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* elf/Makefile ($(inst_slibdir)/$(rtld-version-installed-name),
	$(inst_slibdir)/$(rtld-installed-name), ldso_install): Disable
	targets if not building shared libraries.

1999-03-22  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* configure.in: Also look in $PATH when searching for
	install-info.  Remove autoconf bug workaround and require autoconf
	2.13.

1999-03-21  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* db/Makefile: Don't try to install shared library link if not
	building with shared libs.

1999-03-19  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* rt/Makefile: Link against static library if no shared lib is
	available.

	* localedata/Makefile: The shells scripts implementing the test
	require the dynamic linker which is not available with
	--disable-shared.  Skip the test if --disable-shared is given.

	* linuxthreads/Makefile: Link test against static libpthread if no
	shared lib is available.

	* iconvdata/Makefile (tests): Run iconv-test only if we're
	building shared libraries.
	* elf/Makefile (tests): Likewise for elf tests.

	* posix/Makefile: The test frameworks globtest and wordexp-test
	require the dynamic linker which is not available with
	--disable-shared.  Skip the test if --disable-shared is given.

	* grp/Makefile (otherlibs): For static nss build link against
	necessary libs.

1999-03-19  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* debug/Makefile (install-bin): Install and build catchsegv only
	if build-shared == yes.  Reported by jussi@jlaako.pp.fi [PR
	libc/965].

1999-03-20  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* time/tzfile.c (__tzfile_read): Handle the case where there are
	transitions but no DST.

1999-03-20  Roland McGrath  <roland@baalperazim.frob.com>

	* mach/Machrules (extra-libs-others): Add $(interface-library) here
	too, so it gets built in the others pass rather than the lib pass.
	This is necessary since the RPC libraries need to be linked against
	libc.

1999-03-19  Roland McGrath  <roland@baalperazim.frob.com>

	* sysdeps/generic/segfault.c: Include <stdio-common/_itoa.h> for
	_itoa_word decl.

	* sysdeps/mach/hurd/Makefile (link-rpcuserlibs): New variable.
	($(common-objpfx)libc.so): Depend on that instead of $(rpcuserlibs).
	($(link-rpcuserlibs)): New static pattern rule; link intermediate
	versions of lib{mach,hurd}user.so without reference to libc.so,
	then link libc.so against that to get deps and symbol versions, then
	finally link real lib*user.so against libc.so.

	* sysdeps/mach/hurd/fcntl.c (__fcntl: case F_GETLK,F_SETLK,F_SETLKW):
	Support whole-file locking (only) by using the file_lock RPC.  This
	has very wrong semantics, but is better than nothing for the time
	being.  (Correct POSIX.1 locking will require new RPCs in the Hurd
	protocols that will be somewhat hairy to specify.)

1999-03-17  Mark Kettenis  <kettenis@gnu.org>

	* sysdeps/mach/hurd/ptsname.c: New file.

1999-03-20  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* timezone/asia: Fix rule in Asia/Nicosia entry.

1999-03-16  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* manual/getopt.texi (Using Getopt): Explain "::" in option
	string.  Reported by Yuri Niyazov <yuricake@geocities.com>.

1999-03-18  Thorsten Kukuk  <kukuk@suse.de>

	* sunrpc/clnt_unix.c: Fix creation of parameters for
	sendmsg/recvmsg on non intel platforms.
	* sunrpc/svc_unix.c: Likewise.

1999-03-18  Philip Blundell  <philb@gnu.org>

	* sysdeps/unix/sysv/linux/arm/getgroups.c: New file.  Use the i386
	implementation.

1999-03-19  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* timezone/africa: Update from tzdata1999b.
	* timezone/asia: Likewise.
	* timezone/australasia: Likewise.
	* timezone/europe: Likewise.
	* timezone/northamerica: Likewise.
	* timezone/southamerica: Likewise.
	* timezone/zone.tab: Likewise.

	* timezone/README: Mention tzdata1999b.

1999-03-17  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/generic/segfault.c (write_strsignal): New function.
	(catch_segfault): Use it instead of calling strsignal.

1999-03-16  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* iconv/gconv.c (__gconv): Change type of last_start to unsigned
	char to avoid warning.

1999-03-15  Ulrich Drepper  <drepper@cygnus.com>

	* iconv/iconv.c (iconv): Correctly cast parameters for __gconv.

	* iconvdata/iso-2022-kr.c (EMIT_SHIFT_TO_INIT): Change type of
	outbuf to unsigned char to avoid warning.

1999-03-11  David S. Miller  <davem@redhat.com>

	* sysdeps/sparc/sparc32/fpu/fpu_control.h: Add missing trap enable
	masks.
	* sysdeps/sparc/sparc64/fpu/fpu_control.h: Likewise.

1999-03-15  Ulrich Drepper  <drepper@cygnus.com>

	* iconv/gconv.h (gconv_fct): Change parameter from `char' to
	`unsigned char'.
	(gconv_step_data): Likewise.
	* iconv/gconv_int.h (__gconv): Likewise.
	(__BUILINT_TRANS): Likewise.
	* iconv/gconv.c (__gconv): Likewise.
	* iconv/iconv.c (iconv): Add casts for call of __gconv.
	* iconv/skeleton.c: Change local parameters and variable from `char' to
	`unsigned char'.  Remove casts from calls into modules.
	* iconvdata/iso-2022-jp.c (gconv): Change local variable outbuf from
	`char' to `unsigned char'.
	* wcsmbs/btowc.c: Change pointers from `char *' to `unsigned char *'.
	* wcsmbs/mbrtowc.c: Likewise.
	* wcsmbs/mbsnrtowcs.c: Likewise.
	* wcsmbs/mbsrtowcs.c: Likewise.
	* wcsmbs/wcrtomb.c: Likewise.
	* wcsmbs/wcsnrtombs.c: Likewise.
	* wcsmbs/wcsrtombs.c: Likewise.
	* wcsmbs/wctob.c: Likewise.

1999-03-15  Mark Kettenis  <kettenis@gnu.org>

	* sysdeps/mach/hurd/Versions (ld.so) [GLIBC_2.0]: Add
	__hurd_sigthread_stack_base, __hurd_sigthread_stack_end,
	__hurd_sigthread_variables, __hurd_threadvar_stack_mask,
	__hurd_threadvar_stack_offset, __close, __fxstat, __getcwd,
	__getpid, __libc_read, __libc_write, __lseek, __mmap, __open,
	__xstat, _exit, _hurd_intr_rpc_mach_msg and abort.

1999-03-15  Mark Kettenis  <kettenis@gnu.org>

	* sysdeps/mach/hurd/poll.c (__poll): Correctly pass NULL to
	_hurd_select if TIMEMOUT is -1.

1999-03-15  Mark Kettenis  <kettenis@gnu.org>

	* sysdeps/mach/hurd/recvfrom.c (recvfrom): Allow ADDR to be NULL.

1999-03-15  Ulrich Drepper  <drepper@cygnus.com>

	* elf/dl-load.c: Compute rtld_search_dir array size correctly.
	Reported by Yasushi Saito <yasushi@cs.washington.edu>.

1999-03-15  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* manual/libc.texinfo: Undo last change for now.

1999-03-15  Ulrich Drepper  <drepper@cygnus.com>

	* intl/locale.alias: Add entries for Croatian.
	Patch by Tomislav Vujec <tvujec@CARNet.hr>.

1999-03-13  Mark Kettenis  <kettenis@gnu.org>

	* sysdeps/unix/bsd/getpt.c (__getpt): Do not use `isatty' to check
	if the opened master pty really is a pty.  `isatty' checks for
	tty-ness and a pty is not a tty.  Return ENOENT instead of ENFILE
	if we are out of pty's.

1999-03-13  Mark Kettenis  <kettenis@gnu.org>

	* sysdeps/generic/utmp_file.c (setutent_file): Make sure the just
	opened file is closed on exec.
	* login/utmp_daemon.c (setutent_daemon): Likewise for the just
	opened socket.

1999-03-13  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* manual/llio.texi (File Position Primitive): Reformat @end
	command.  Patch by Bruno Haible <haible@ilog.fr> [PR libc/1020].

1999-03-14  Ulrich Drepper  <drepper@cygnus.com>

	* nscd/nscd_getpw_r.c (nscd_getpw_r): Set `errno' correctly if no
	entry is found.
	* nscd/nscd_getgr_r.c (nscd_getgr_r): Likewise.
	* nscd/nscd_gethst_r.c (nscd_gethst_r): Likewise.

	* locale/programs/localedef.c (main): Initialize `cat' to please
	the compiler.

1999-03-14  Roland McGrath  <roland@baalperazim.frob.com>

	* hurd/hurdlookup.c (__hurd_file_name_lookup_retry): Under O_NOFOLLOW,
	check for root-owned symlinks and reject them too.

1999-03-09  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* stdio-common/printf_fphex.c: Move to ...
	* sysdeps/generic/printf_fphex.c: ... here.  Fix exponent of
	extended precision number.
	* sysdeps/m68k/printf_fphex.c: New file.

1999-03-09  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* manual/stdio.texi: Fix typos.

1999-03-09  Ulrich Drepper  <drepper@cygnus.com>

	* version.h (VERSION): Bump to 2.1.1.

1999-03-09  Thorsten Kukuk  <kukuk@suse.de>

	* nis/ypclnt.c: Try only twice to connect to NIS server.

1999-03-09  Roland McGrath  <roland@baalperazim.frob.com>

	* hurd/hurdexec.c (_hurd_exec): Add missing `else' in last change.

1999-03-09  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* stdlib/strtod.c (round_and_return): Fix rounding of denormals.
	(DENORM_EXP): New define.  Use it as the exponent for a denormal.
	* stdlib/strtold.c: Moved to ...
	* sysdeps/generic/strtold.c: ... here.
	* sysdeps/m68k/strtold.c: New file.

1999-03-09  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* stdio-common/printf_fphex.c (__printf_fphex): Print no decimal
	point if the precision is zero, even if the mantissa is non-zero.

1999-03-09  Roland McGrath  <roland@baalperazim.frob.com>

	* sysdeps/mach/hurd/ioctl.c (__ioctl): Move the marshalling of the
	arguments into the request message buffer inside `send_rpc'
	subfunction.  We must repeat the marshalling when retrying the RPC
	after a SIGTTOU delivery.

	* hurd/ctty-input.c (_hurd_ctty_input): Use early short-circuit code
	path when there is no ctty port.
	* hurd/ctty-output.c (_hurd_ctty_output): Likewise.
	Move sigstate check inside loop so we recheck after handling a signal.

1999-03-05  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* manual/llio.texi (Open-time Flags): Clarify that O_SHLOCK and
	O_EXLOCK are BSD extensions.
	Reported by Jochen Voss <voss@mathematik.uni-kl.de> [PR libc/985].

1999-03-08  Ulrich Drepper  <drepper@cygnus.com>

	* manual/signal.texi (Termination in Handler): Correct example.
	Install default handler before reraising the signal.
	Patch by Jochen Voss <voss@mathematik.uni-kl.de>.

1999-03-08  Roland McGrath  <roland@baalperazim.frob.com>

	* hurd/hurdexec.c (_hurd_exec): Handle ARGV or ENVP parameters being
	null, in which case send an empty string.

1999-03-02  Mark Kettenis  <kettenis@gnu.org>

	* Makerules (LD_FLAGS-c.so): Add -u __register_frame to force the
	backward compatibility EH functions to be linked when using
	gcc-2.8.1.  Patch by Zack Weinberg <zack@rabi.columbia.edu>.

1999-03-08  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* sysdeps/unix/sysv/linux/ttyname.c (ttyname): Undo last change.
	/dev/pts status may change during runtime.

1999-03-08  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* sysdeps/unix/sysv/linux/ttyname_r.c (__ttyname_r): Undo last
	change.  /dev/pts status can change during runtime.

1999-03-07  Thorsten Kukuk  <kukuk@suse.de>

	* sunrpc/svc_tcp.c (readtcp): go into fatal error state if
	poll reports error.
	* nis/nss_nisplus/nisplus-parser.c: Avoid duplicate strlen calls,
	add some more sanity checks.
	* nis/nss_nisplus/nisplus-pwd.c: Include nisplus-parser.h for
	parser prototype.

1999-03-05  Thorsten Kukuk  <kukuk@suse.de>

	* sunrpc/rpc/xdr.h: Add x_getint32/x_putint32 to xdr_ops,
	change XDR_GETINT32/XDR_PUTINT32 to sue new functions.
	* sunrpc/xdr_mem.c: Add xdrmem_getint32, xdrmem_putint32.
	* sunrpc/xdr_rec.c: Add xdrrec_getint32, xdrrec_putint32.
	* sunrpc/xdr_sizeof.c: Add x_putint32, add dummy function
	for x_getint32.
	* sunrpc/xdr_stdio.c: Add xdrstdio_getint32, xdrstdio_putint32.
	* nis/nis_print.c: Fix ctime argument for platforms where
	sizeof (time_t) != sizeof (int).

1999-03-07  Mark Kettenis  <kettenis@gnu.org>

	* sysdeps/unix/bsd/clock.c (timeval_to_clock_t): Use
	CLOCKS_PER_SEC instead of CLK_TCK.

1999-03-05  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/unix/sysv/linux/ttyname_r.c (__ttyname_r): Remember
	whether /dev/pts is available.
	* sysdeps/unix/sysv/linux/ttyname.c (ttyname): Fix handling of
	dev_pts_available.

	* posix/globtest.sh: Make common_objpfx path absolute and and db2
	and hesiod directory to library path [PR libc/1007].

1999-03-05  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* resolv/inet_addr.c (inet_aton): Don't allow componets >
	255.  Patch by Bruno Haible <haible@ilog.fr> [PR libc/1010].

1999-03-05  Geoff Keating  <geoffk@ozemail.com.au>

	* sysdeps/powerpc/dl-machine.c (__elf_machine_runtime_setup):
	DT_PLTGOT has already been relocated.
	(__elf_machine_fixup_plt): Likewise.
	Minor cleanups.

1999-03-04  Roland McGrath  <roland@baalperazim.frob.com>

	* hurd/hurdlookup.c (__hurd_file_name_lookup): Comment fix.

1999-03-03  Ulrich Drepper  <drepper@cygnus.com>

	* wcsmbs/wcsmbsload.c (add_slashes): Rename to norm_add_slashes
	and fold string to uppercase [PR libc/1005].

1999-03-03  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* elf/dl-load.c (lose): Fix return type.

1999-03-03  Roland McGrath  <roland@baalperazim.frob.com>

	* sysdeps/mach/hurd/bits/fcntl.h
	[__USE_GNU] (O_NOFOLLOW, O_DIRECTORY): New macros.
	* hurd/hurdlookup.c (__hurd_file_name_lookup): If O_NOFOLLOW is set,
	set O_NOTRANS as well.
	(__hurd_file_name_lookup_retry): At successful end of lookup,
	if O_NOFOLLOW set, io_stat the resultant port and fail with ENOENT if
	it is a translated node not owned by root.
	(__hurd_file_name_lookup): If O_DIRECTORY is set, put a trailing slash
	on the file name passed to LOOKUP.

1999-03-02  Ulrich Drepper  <drepper@cygnus.com>

	* manual/time.texi (High Resolution Timer): Correct computation in
	example.  Reported by jjf@devel.cemsys.com.

1999-03-02  Philip Blundell  <pb@nexus.co.uk>

	* sysdeps/arm/dl-machine.h (elf_machine_runtime_setup): DT_PLTGOT
	entry is already relocated.

1999-03-01  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* resolv/res_hconf.c (parse_line): Skip empty lines.  Bug reported
	by Marcus Harnisch <marcus@harnisch.isdn.cs.tu-berlin.de>.

1999-03-01  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* sysdeps/i386/sys/ucontext.h (ucontext): Rename field uc_links to
	uc_link which is the right name according to Unix98.
	Reported by Craig Metz [PR libc/1001].
	* sysdeps/arm/sys/ucontext.h (ucontext): Likewise.
	* sysdeps/m68k/sys/ucontext.h (ucontext): Likewise.
	* sysdeps/mips/sys/ucontext.h (ucontext): Likewise.
	* sysdeps/unix/sysv/linux/alpha/sys/ucontext.h (ucontext): Likewise.
	* sysdeps/unix/sysv/linux/i386/sys/ucontext.h (ucontext): Likewise
	* sysdeps/unix/sysv/linux/powerpc/sys/ucontext.h (ucontext): Likewise.

1999-02-25  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* manual/libc.texinfo: Wrap @top node inside @ifnottex instead of
	@ifinfo.

1999-02-25  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* iconvdata/Makefile: Always include iconv-rules, but disable rule
	to regenerate it if avoid-generated.

	* Makeconfig: Always include sys-dirs, but disable rule to
	regenerate it when avoid-generated.

	* sysdeps/unix/Makefile: Put `ifndef avoid-generated' only around
	rule to generate sysd-syscalls.

	* elf/Makefile (generated): Remove $(objpfx) from names.

1999-02-28  Mark Kettenis  <kettenis@gnu.org>

	* sysdeps/mach/hurd/getsockname.c (getsockname): Set *LEN to the
	actual length if the adress length is smaller than the input
	value.  Change type of *LEN paramater to socklen_t.
	* sysdeps/mach/hurd/getpeername.c (getpeername): Likewise.
	* sysdeps/mach/hurd/accept.c (accept): Likewise.
	* sysdeps/mach/hurd/recvfrom.c (recvfrom): Likewise.
	* sysdeps/mach/hurd/sendto.c (sendto): Change type of ADDR_LEN
	paramater to socklen_t.

1999-02-28  Roland McGrath  <roland@baalperazim.frob.com>

	* hurd/hurd-raise.c (_hurd_raise_signal): Send "poll request"
	msg_sig_post RPC (with SIGNO=0), rather than generating signal (again)
	with the RPC.

1999-02-27  Roland McGrath  <roland@baalperazim.frob.com>

	* sysdeps/mach/getsysstats.c (__get_nprocs_conf, __get_nprocs,
	__get_phys_pages): Cast &HBI to silence warning.

	* hurd/Makefile (routines): Add hurdchdir and hurdfchdir.
	* hurd/hurdchdir.c: New file.
	* hurd/hurdfchdir.c: New file.
	* sysdeps/mach/hurd/chroot.c: Call
	_hurd_change_directory_port_from_name to do the work.
	* sysdeps/mach/hurd/chdir.c: Likewise.
	* sysdeps/mach/hurd/fchdir.c: Call
	_hurd_change_directory_port_from_fd to do the work.
	* hurd/fchroot.c: Likewise.
	* hurd/hurd.h: Declare them.

1999-02-27  Ulrich Drepper  <drepper@cygnus.com>

	* elf/dl-load.c (lose): Add more comments to explain the `why'.
	(_dl_map_object): Remove redundant test.

1999-02-27  Roland McGrath  <roland@baalperazim.frob.com>

	* hurd/hurdselect.c (_hurd_select): When bailing for bogus fd, don't
	try to _hurd_port_free a lower-numbered descriptor that was not in any
	fd_set.

1999-02-26  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* wcsmbs/wcstold_l.c [__NO_LONG_DOUBLE_MATH]: Add prototype
	declaration for ____wcstod_l_internal.

	* stdlib/strtold.c [__NO_LONG_DOUBLE_MATH]: Include <stdlib.h> for
	__strtod_internal prototype.
	* stdlib/strtold_l.c [__NO_LONG_DOUBLE_MATH]
	(____strtold_l_internal): Add prototype declaration.
	(__strtold_l): Call correct function.

1999-02-24  Ulrich Drepper  <drepper@cygnus.com>

	* elf/elf.h: Add 32bit HPPA definitions.

1999-02-23  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* malloc/malloc.c (mALLOC_SET_STATe): Handle the case where a
	non-checked heap is restored when malloc checking was requested by
	the user.
	(struct malloc_state): Add using_malloc_checking.
	(MALLOC_STATE_VERSION): Increment minor.
	(using_malloc_checking, disallow_malloc_check): New variables.
	(__malloc_check_init): Use them.
	(mALLOC_GET_STATe): Use mALLOc to allocate the malloc_state, so
	that it can the chunk is properly instrumented when malloc
	checking is enabled.  Set the new using_malloc_checking field.
	(malloc_hook_ini): Correct signature when _LIBC is not defined.

1999-02-23  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* sysdeps/unix/sysv/linux/i386/dl-librecon.h
	(DISTINGUISH_LIB_VERSIONS): Don't relocate DT_STRTAB a second
	time.

	* elf/rtld.c (dl_main): Rename paths_initialized to rtld_is_main.
	Don't call elf_get_dynamic_info and _dl_setup_hash a second time
	if ld.so is the main program.

1999-02-23  Ulrich Drepper  <drepper@cygnus.com>

	* stdio-common/vfprintf.c (vfprintf): If precision or width is too
	large for work_buffer, allocate new buffer.
	(printf_unknown): Likewise.  [PR libc/988]

1999-02-22  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/unix/sysv/linux/ttyname.c: Use __xstat and __fxstat
	instead of stat and fstat.
	* sysdeps/unix/sysv/linux/ttyname_r.c: Likewise.

1999-02-23  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* elf/dl-error.c (_dl_signal_cerror): New function.
	(_dl_signal_error): Don't call receiver function.
	* elf/dl-lookup.c (_dl_lookup_symbol): Call _dl_signal_cerror
	instead of _dl_signal_error when reporting references to undefined
	symbols or versions.
	(_dl_lookup_versioned_symbol): Likewise.
	(_dl_lookup_versioned_symbol_skip): Likewise.
	* elf/dl-version.c (match_symbol): Likewise.

	* elf/ldsodefs.h: Declare _dl_signal_cerror.

1999-02-22  Ulrich Drepper  <drepper@cygnus.com>

	* misc/getttyent.c (getttyent): Release lock on stream later to
	also protect global variable zapchar.

	* sysdeps/unix/sysv/linux/clock.c: Don't test return value of
	__times [PR libc/990].

1999-02-21  David S. Miller  <davem@redhat.com>

	* sysdeps/unix/sysv/linux/sparc/sparc32/sigcontextinfo.h: Fix
	parentheses in Feb 2 changes.
	* sysdeps/unix/sysv/linux/sparc/sparc64/sigcontextinfo.h: Likewise.

1999-02-21  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* sysdeps/generic/glob.c (glob): Save previous errno.

1999-02-21  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/generic/glob.c (glob): Enlarge buffers for reentrant
	lookup functions if it is too small.

1999-02-20  Ulrich Drepper  <drepper@cygnus.com>

	* elf/dl-deps.c (_dl_map_object_deps): Don't add dummy objects created
	for tracing to the scope lists.
	* elf/do-lookup.h: Remove test for l_opencount == 0 after above change.
	DT_SYMTAB is always available according to ELF spec.

	* elf/dl-lookup.c (_dl_lookup_symbol_skip): Before first do_lookup
	call test whether there is any scope left.
	(_dl_lookup_versioned_symbol_skip): Likewise.

	* elf/Makefile (distribute): Add do-lookup.h.
	* elf/do-lookup.h: New file.  Split out from dl-lookup.c.
	* elf/dl-lookup.c: Move do_lookup function in separate file and
	include the file twice, for handling versioning and without it.

	* sysdeps/i386/dl-machine.h (elf_machine_runtime_setup): DT_PLTGOT
	entry is already relocated.
	* sysdeps/alpha/dl-machine.h (elf_machine_runtime_setup): Likewise.
	* sysdeps/m68k/dl-machine.h (elf_machine_runtime_setup): Likewise.
	* sysdeps/mips/dl-machine.h (elf_machine_runtime_setup): Likewise.
	* sysdeps/sparc/sparc32/dl-machine.h (elf_machine_runtime_setup):
	Likewise.
	* sysdeps/sparc/sparc64/dl-machine.h (elf_machine_runtime_setup):
	Likewise.
	* sysdeps/mips/mips64/dl-machine.h (elf_machine_runtime_setup):
	Likewise.

	* elf/dynamic-link.h (elf_get_dynamic_info): Take new argument with
	load address.  Relocate d_ptr in DT_DTRTAB, DT_SYMTAB, DT_RELA, DT_REL,
	DT_JMPREL, DT_PLTGOT, and DT_VERSYM l_info entry.
	(_ELF_DYNAMIC_DO_RELOC): Take extra argument which specifies whether
	rel and rela relocations can both happen and skip one test if this
	is not possible.
	(ELF_DYNAMIC_DO_RELA, ELF_DYNAMIC_DO_REL): Call _ELF_DYNAMIC_DO_RELOC
	appropriately.
	* elf/dl-addr.c (_dl_addr): DT_SYMTAB and DT_STRTAB entries are
	already relocated.
	* elf/dl-deps.c (_dl_map_object_deps): DT_STRTAB entry is already
	relocated.
	* elf/dl-load.c (_dl_init_paths): DT_STRTAB entry is already relocated.
	(_dl_map_object_from_fd): Call elf_get_dynamic_info with new argument.
	(_dl_map_object): DT_STRTAB entry is already relocated.
	* elf/dl-lookup.c (do_lookup): DT_STRTAB and DT_SYMTAB entries are
	already relocated.
	* elf/dl-reloc.c (_dl_relocate_object): DT_STRTAB entry is already
	relocated.
	* elf/dl-runtime.c (fixup): DT_SYMTAB, DT_STRTAB, DT_JMPREL, and
	DT_VERSYM entries are already relocated.
	(profile_fixup): Likewise.
	* elf/dl-version.c: Rename VERSTAG macro into VERSYMIDX.  Replace
	all users.
	(match_symbol): DT_STRTAB entry is already relocated.
	(_dl_check_map_versions): Likewise.  Also fo DT_VERSYM.
	* elf/do-rel.h (elf_dynamic_do_rel): reladdr is now assumed to be
	relocated already.  DT_SYMTAB and DT_VERSYM entries are also relocated.
	* elf/rtld.c (_dl_start): Pass extra argument to elf_get_dynamic_info.
	(find_needed): DT_STRTAB entry is already relocated.
	(dl_main): Pass extra argument to elf_get_dynamic_info.
	DT_STRTAB entry is already relocated.
	* sysdeps/alpha/dl-machine.h (elf_machine_fixup_plt): DT_JMPREL and
	DT_PLTGOT entries are already relocated.
	(elf_machine_rela): Likewise for DT_SYMTAB.
	* sysdeps/arm/dl-machine.h (elf_machine_rel): DT_STRTAB is already
	relocated.
	* sysdeps/i386/dl-machine.h (elf_machine_rel): Likewise.
	* sysdeps/m68k/dl-machine.h (elf_machine_rela): Likewise.
	* sysdeps/sparc/sparc32/dl-machine.h (elf_machine_rela): Likewise.
	* sysdeps/sparc/sparc64/dl-machine.h (elf_machine_rela): Likewise.
	* sysdeps/powerpc/dl-machine.c (__process_machine_rela): Likewise.
	* sysdeps/mips/dl-machine.h (elf_machine_got_rel): Likewise.
	(elf_machine_got_rel): Likewise for DT_SYMTAB and DT_STRTAB.
	* sysdeps/mips/mips64/dl-machine.h: Likewise.

	* grp/initgroups.c (initgroups): If function in current module was
	successful don't stop but continue to process to get all the groups.

	* elf/dl-load.c (_dl_map_object_from_fd): Use global
	_dl_pf_to_proot array to convert p_flags value.
	* elf/dl-reloc.c (_dl_relocate_object): Likewise.

	* elf/dynamic-link.h (elf_get_dynamic_info): Use memset instead of
	loop to clear `info'.

	* sysdeps/i386/i486/bits/string.h: If fill byte is constant let gcc
	do the work and don't use inline assembler.

1999-02-19  Ulrich Drepper  <drepper@cygnus.com>

	* elf/ldsodefs.h (_dl_signal_error): Mark as __noreturn__.
	* elf/dl-load.c (lose): Make it a function at the toplevel, mark as
	noreturn, and prevent it from being inlined.
	Define LOSE appropriately.
	(_dl_map_object_from_fd): Compare all bytes in e_ident at once.
	Optimize decoding of p_flags for certain platforms.

1999-02-19  Philip Blundell  <pb@nexus.co.uk>

	* Makeconfig (link-libc): When doing a static link, make sure that
	libgcc.a is included both before and after libc.a.

1999-02-18  Thorsten Kukuk  <kukuk@suse.de>

	* nis/nss_compat/compat-spwd.c: Fix handling of default values for
	sp_warn, sp_inact, sp_expire and sp_flag.

1999-02-18  Ulrich Drepper  <drepper@cygnus.com>

	* elf/link.h (link_map): Add l_dev and l_ino.
	* elf/dl-load.c (_dl_map_object_from_fd): Test dev/ino of newly
	loaded shared object with all loaded objects.  Initialize l_ino
	and l_dev in case it's new.
	* elf/rtld.c (dl_main): Explain situation is l_dev/l_ino with main
	object.
	* elf/Makefile: Compile and run new test.
	* elf/multiload.c: New file.

	* nss/nsswitch.h (service_user): Change name field from const char *
	to char[0].
	(name_database_entry): Likewise.
	* nss/nsswitch.c (nss_parse_service_list): Adjust memory allocation
	for change of `service_user'.
	(nss_getline): Adjust memory allocation for change of
	`name_database_entry'.

	* catgets/catgets.c: Correctly handle NLSPATH from environment
	[PR libc/980].

	* io/Makefile (routines): Add lock64.
	* io/Versions: Add lockf64 for GLIBC_2.1.1.
	* sysdeps/generic/lockf64.c: New file.

1999-02-16  Ulrich Drepper  <drepper@cygnus.com>

	* string/bits/string2.h: Only use strncmp optimization if count
	argument is constant.

1999-02-16  Roland McGrath  <roland@baalperazim.frob.com>

	* sysdeps/mach/hurd/revoke.c: New file.

1999-02-16  Ulrich Drepper  <drepper@cygnus.com>

	* wctype/wctype.h (_ISwbit): Cast result of shift operations to
	int to avoid warning about `ISO C restricts enumerator values to
	range of `int''.

1999-02-16  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* elf/dlfcn.h: Fix typo.
	* sysdeps/generic/bits/dlfcn.h: Likewise.
	* sysdeps/mips/bits/dlfcn.h: Likewise.

1999-02-16  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/i386/i486/bits/string.h (memcmp): Correctly set flags
	for the case N == 0.

	* db2/Makefile (distribute): Add LICENSE.

1999-02-03  Jeff Bailey  <jbailey@nisa.net>

	* sysdeps/unix/make_errlist.c: Add i18n and copyright to
	generated files.

	* sysdeps/unix/sysv/sysv4/solaris2/sparc/errlist.c: Fix typo.

1999-02-16  Ulrich Drepper  <drepper@cygnus.com>

	* time/mktime.c: Use ISO C form for function definitions and
	remove unnecessary prototypes.

	* sysdeps/posix/getaddrinfo.c (getaddrinfo): Fix typo in last change.

	* time/time.h: Avoid unneccesary #ifdef.

1999-02-15  Geoff Keating  <geoffk@ozemail.com.au>

	* stdio-common/_itoa.c (_itoa): Correct parameters to
	udiv_qrnnd_preinv.

1999-02-14  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* misc/sys/cdefs.h: Undefine __PMT since it might be defined
	before (e.g. in glob.h).
	Closes PR libc/959.

1999-02-16  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* sysdeps/mips/fpu_control.h: Fix typo.
	Patch by Sylvain Pion <Sylvain.Pion@sophia.inria.fr>.
	Remove __setfpucw.

1999-02-10  Roland McGrath  <roland@baalperazim.frob.com>

	* sysdeps/mach/hurd/pipe.c (__pipe): Don't call __socket_shutdown on
	the "unused" ends of the sockets.  Let pipes be bidirectional.

1999-02-15  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/posix/getaddrinfo.c (getaddrinfo): Correct test for
	invalid ai_flags.

1999-02-15  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* manual/llio.texi (Waiting for I/O): Correct meaning.  Patch by
	Jochen Voss <voss@mathematik.uni-kl.de> [PR libc/969].

	* manual/setjmp.texi (Non-Local Exits and Signals): Fix
	typo.  Patch by Jochen Voss <voss@mathematik.uni-kl.de> [PR libc/970].

1999-02-15  Ulrich Drepper  <drepper@cygnus.com>

	* string/Versions: Add __strverscmp to GLIBC_2.1.1.

1999-02-13  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* misc/syslog.c (vsyslog): Remember errno for %m format.  Fix
	check for priority mask.

1999-02-14  Ulrich Drepper  <drepper@cygnus.com>

	* resolv/netdb.h (AI_NUMERICHOST): Change to 4.
	Reported by Craig Metz <cmetz@inner.net> .

1999-02-14  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* stdio-common/Makefile (tests): tllformat added.

	* stdio-common/tllformat.c: New program, based on tiformat.c with
	examples from Franz Sirl <Franz.Sirl-kernel@lauterbach.com>.

1999-02-14  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* posix/test-vfork.c: Fix exit status test.

1999-02-14  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* sysdeps/unix/sysv/linux/sa_len.c (__libc_sa_len): Add some
	missing cases.  Reported by Craig Metz <cmetz@inner.net> [PR libc/964].

1999-02-14  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* sysdeps/m68k/fpu/s_modf.c: Optimized by using __m81_test instead
	of separare explicit comparisons.

1999-02-11  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* sysdeps/wordsize-64/inttypes.h: Always define ldiv_t if not yet
	defined.

	* sysdeps/wordsize-32/inttypes.h: Always define lldiv_t if not yet
	defined.

1999-02-09  Ulrich Drepper  <drepper@cygnus.com>

	* po/el.po: Update from translation team.

1999-02-09  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* intl/locale.alias: Fix slovenian entry [PR libc/948].

1999-02-09  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* elf/sprof.c: assert.h isn't used anymore, remove inclusion.
	* inet/ruserpass.c: Likewise.
	* locale/programs/stringtrans.c: Likewise.
	* locale/programs/localedef.c: Likewise.
	* nscd/grpcache.c: Likewise.
	* nss/nss_files/files-XXX.c: Likewise.
	* stdlib/canonicalize.c: Likewise.
	* sysdeps/posix/sigwait.c: Likewise.

1999-02-09  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* sunrpc/pmap_rmt.c (clnt_broadcast): We need 32 bit comparison
	even on 64 bit platforms.

	* sunrpc/clnt_tcp.c (clnttcp_call): Likewise.
	Patch by Loic Prylli <Loic.Prylli@ens-lyon.fr>.

1999-02-09  Ulrich Drepper  <drepper@cygnus.com>

	* intl/dcgettext.c: Include locale.h is available.

1999-02-08  Ulrich Drepper  <drepper@cygnus.com>

	* po/nl.po: Update from translation team.

	* sysdeps/libm-i387/s_asinhf.S: Correct computing absolute value.

	* Makefile: Allow calling goals for po subdir.

	* sysdeps/unix/sysv/linux/alpha/bits/signum.h: Add missing RT
	signal definitions.

	* po/el.po: New file.

1999-02-07  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* elf/dl-load.c (_dl_map_object_from_fd): Replace magic constant
	when processing DT_SYMBOLIC objects.

1999-02-07  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

	* elf/dl-load.c (_dl_map_object_from_fd): When looking for the
	program headers without PT_PHDR only require that they are
	contained within one of the loaded segments.  Don't use assert,
	since that would be a bug in the object, not the dynamic linker.

1999-02-08  Richard Henderson  <rth@cygnus.com>

	* sysdeps/alpha/dl-machine.h (TRAMPOLINE_TEMPLATE): Save and
	restore all call-clobbered fp regs.

1999-02-08  Ulrich Drepper  <drepper@cygnus.com>

	* po/cs.po: New file.

	* resolv/res_hconf.c (_res_hconf_init): Don't use ENV_HOSTCONF for
	SUID binaries.

1999-02-07  Ulrich Drepper  <drepper@cygnus.com>

	* signal/signal.h: Don't declare __libc_allocate_rtsig.
	* include/signal.h: Declare __libc_allocate_rtsig here.

	* elf/dl-lookup.c: Increment _dl_num_relocations in the four entry
	point functions, not do_lookup since the later can be called more
	than once.

1999-02-03  Jakub Jelinek  <jj@ultra.linux.cz>

	* sysdeps/generic/segfault.c: Add ADVANCE_STACK_FRAME
	macro, so that architectures which need to add some special
	offset to stack pointer can share this file.

	* sysdeps/unix/sysv/linux/sparc/sparc32/sigcontextinfo.h: New file.
	* sysdeps/unix/sysv/linux/sparc/sparc32/register-dump.h: New file.
	* sysdeps/unix/sysv/linux/sparc/sparc64/sigcontextinfo.h: New file.
	* sysdeps/unix/sysv/linux/sparc/sparc64/register-dump.h: New file.

	* sysdeps/unix/sysv/linux/sparc/sparc32/bits/mman.h: Remove.
	* sysdeps/unix/sysv/linux/sparc/sparc64/bits/mman.h: Remove.
	* sysdeps/unix/sysv/linux/sparc/bits/mman.h: New file - common
	between sparc32 and sparc64.

	* sysdeps/unix/sysv/linux/sparc/sparc32/vfork.S: Remove.
	* sysdeps/unix/sysv/linux/sparc/sparc64/vfork.S: Remove.
	* sysdeps/unix/sysv/linux/sparc/vfork.S: New file - common
	between sparc32 and sparc64.

	* sysdeps/unix/sysv/linux/sparc/sparc32/fork.S: Remove.
	* sysdeps/unix/sysv/linux/sparc/sparc64/fork.S: Remove.
	* sysdeps/unix/sysv/linux/sparc/fork.S: New file - common
	between sparc32 and sparc64.

	* sysdeps/unix/sysv/linux/sparc/sparc32/sysdep.S: Remove.
	* sysdeps/unix/sysv/linux/sparc/sparc64/sysdep.S: Remove.
	* sysdeps/unix/sysv/linux/sparc/sysdep.S: New file - common
	between sparc32 and sparc64.

1999-02-07  Ulrich Drepper  <drepper@cygnus.com>

	* Versions.def: New version GLIBC_2.1.1 for libc.
	* stdlib/Versions: Add _Exit, imaxdiv, and imaxdiv to GLIBC_2.1.1.
	* stdlib/labs.c: Moved to...
	* sysdeps/generic/labs.c: ...here.
	* stdlib/llabs.c: Moved to...
	* sysdeps/generic/llabs.c: ...here.
	* stdlib/stdlib.h: Allow definition of ldiv_t and lldiv_t in other
	header.  Declare _Exit.
	* sysdeps/generic/_exit.c: Add alias _Exit.
	* sysdeps/mach/hurd/_exit.c: Likewise.
	* sysdeps/standalone/i386/force_cpu386/_exit.c: Likewise.
	* sysdeps/standalone/i960/nindy960/_exit.c: Likewise.
	* sysdeps/standalone/m68k/m68020/mvme136/_exit.c: Likewise.
	* sysdeps/unix/_exit.c: Likewise.
	* sysdeps/wordsize-32/inttypes.h: Define imaxdiv_t and declare
	imaxdiv and imaxabs.  Declare lldiv_t if necessary.
	* sysdeps/wordsize-64/inttypes.h: Likewise.
	* sysdeps/wordsize-32/llabs.c: New file.
	* sysdeps/wordsize-32/lldiv.c: New file.
	* sysdeps/wordsize-64/labs.c: New file.
	* sysdeps/wordsize-64/ldiv.c: New file.
	* manual/arith.texi: Document imaxabs, imaxdiv_t, and imaxdiv.
	* manual/startup.texi: Document _Exit.

1999-02-07  Andreas Jaeger  <aj@arthur.rhein-neckar.de>

	* nscd/cache.c: Include <arpa/inet.h> for inet_ntop.

1999-02-06  Ulrich Drepper  <drepper@cygnus.com>

	* Versions.def: Add versions for ld.so.
	* csu/Versions: Remove __libc_stack_end here.
	* elf/Versions: Split libc definitions in libc and ld.so definitions.
	* elf/Makefile (ld-map): Change to ld.so.map.
	* scripts/versions.awk: Recognize dot in library names.

	* ctype/ctype.h: Remove definitions of __tolower and __toupper.
	Don't use __tolower and __toupper in inline functions.
	Add optimizing macros for tolower and toupper.
	* ctype/ctype-extn.c (_tolower): Don't use __tolower.
	(_toupper): Don't use __toupper.
	* ctype/ctype.c (tolower): Don't use __tolower.
	(toupper): Don't use toupper.

	* nscd/cache.c (prune_cache): Correct printing of debugging messages.

	* resolv/Versions (libresolv): Export __ns_name_unpack and
	__ns_name_ntop.
	* resolv/res_comp.c: Rename ns_name_unpack to __ns_name_unpack and
	make it global.  Change all users.  Similar for ns_name_ntop.
	* resolv/nss_dns/dns-host.c: Don't use dn_expand when extracting in
	user-provided buffer.  Use __ns_name_unpack and __ns_name_ntop
	directly to detect too small buffer.
	* resolv/nss_dns/dns-network.c: Likewise.

	* stdio-common/Makefile (tests): Add scanf12.
	* stdio-common/scanf12.c: New file.
	* stdio-common/scanf12.input: New file.
	* stdio-common/vfscanf.c (__vfscanf): Handle +/- at beginning of
	floating-point correctly if the number is invalid.

	* stdio-common/vfscanf.c: Don't use non-reentrant multibyte conversion
	functions.
	* stdio-common/printf_fp.c: Likewise.
	* stdio-common/printf_fphex.c: Likewise.
	* stdio-common/vfprintf.c: Likewise.


See ChangeLog.9 for earlier changes.
