2000-11-25  Ulrich Drepper  <drepper@redhat.com>

	* elf/loadfail.c: Little cosmetic changes to avoid warnings.
	* elf/loadtest.c: Likewise.
	* elf/multiload.c: Likewise.
	* elf/next.c: Likewise.
	* elf/nodelete.c: Likewise.
	* elf/noload.c: Likewise.
	* elf/order.c: Likewise.
	* elf/origtest.c: Likewise.
	* elf/preloadtest.c: Likewise.
	* elf/restest1.c: Likewise.

	* sysdeps/i386/i486/bits/string.h (__strncat_g) [i686]: Fourth
	parameter of asm must be in %ecx.

	* string/tester.c: Mark test functions as static to avoid warnings.

	* iconv/gconv_conf.c (read_conf_file): Make mod_counter static to
	preserve value over different gconv-modules files.

2000-11-24  Ulrich Drepper  <drepper@redhat.com>

	* locale/findlocale.c: Add casts to avoid warnings.
	* locale/localeinfo.h (LIMAGIC): Add cast to avoid warnings.
	* misc/efgcvt_r.c (fcvt_r): Use ssize_t instead of int and add cast
	to avoid warnings.
	* misc/tsearch.c (const_node): New type.
	(trecurse): Correct casts to avoid warnings.
	(__twalk): Likewise.
	* stdlib/tst-limits.c: Add z modifier to formats for WORD_BIT and
	LONG_BIT.

	* debug/backtrace-tst.c (compare): Add casts to avoid warnings.

	* test-skeleton.c: Mark local functions as static to avoid warnings.

2000-11-23  H.J. Lu  <hjl@gnu.org>

	* rt/tst-aio6.c (do_test): Use pipe instead of STDIN_FILENO to
	support the background job.
	Fix a typo.

2000-11-24  Ulrich Drepper  <drepper@redhat.com>

	* iconv/gconv_conf.c (insert_module): Replace old entry if new one
	has same names but lower cost.

2000-11-23  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/sparc/sparc32/dl-machine.h: Ifdef out handling for relocs
	which never occur during bootstrap.
	* sysdeps/sparc/sparc64/dl-machine.h: Likewise.

2000-11-23  Andreas Jaeger  <aj@suse.de>

	* nss/nss_files/files-hosts.c: Remove getipnodebyname.

	* nss/Versions: Remove _nss_files_getipnodebyname_r.

	* sysdeps/unix/sysv/linux/Versions: Fix typo in last patch.

2000-11-18  Martin Buchholz  <martin@xemacs.org>

	* csu/gmon-start.c (__gmon_start__): Avoid over-clever trick `if
	(called++) return;'

2000-11-21  Alan Modra  <alan@linuxcare.com.au>

	* sysdeps/generic/bsd-_setjmp.c (setjmp): Rename to _setjmp.

	* csu/abi-note.S: Correct comment for operating system number.

2000-11-22  Ulrich Drepper  <drepper@redhat.com>

	* Versions.def: Add GLIBC_2.2.1 for glibc.

2000-11-22  Andreas Schwab  <schwab@suse.de>

	* sysdeps/unix/sysv/linux/syscalls.list: Add pivot_root.
	* sysdeps/unix/sysv/linux/Versions: Add pivot_root at GLIBC_2.2.1.

2000-11-22  Ulrich Drepper  <drepper@redhat.com>

	* rt/aio_suspend.c (aio_suspend): Convert timeout value to
	absolute time for pthread_cond_timedwait call.
	Reported by Lawrence Chen <lchen@opentext.com> [libc/1930].

	* rt/Makefile (tests): Add tst-aio6.
	* rt/tst-aio6.c: New file.

2000-11-23  Andreas Jaeger  <aj@suse.de>

	* sysdeps/s390/bits/string.h (strncat): Fix one more typo.

2000-11-22  Andreas Jaeger  <aj@suse.de>

	* sysdeps/s390/bits/string.h (strncat): Add missing quotation marks.

2000-11-21  Martin Schwidefsky  <schwidefsky@de.ibm.com>

	* sysdeps/s390/bits/string.h: Make strncat always add a \0.

2000-11-21  Andreas Schwab  <schwab@suse.de>

	* sysdeps/alpha/setjmp.S: Remove __setjmp entry point.
	* sysdeps/arm/setjmp.S: Likewise.
	* sysdeps/arm/fpu/setjmp.S: Likewise.
	* sysdeps/i386/setjmp.S: Likewise.
	* sysdeps/i386/elf/setjmp.S: Likewise.
	* sysdeps/s390/setjmp.S: Likewise.
	* sysdeps/s390/elf/setjmp.S: Likewise.
	* sysdeps/sh/sh3/setjmp.S: Likewise.
	* sysdeps/sh/sh4/setjmp.S: Likewise.
	* sysdeps/sparc/sparc32/setjmp.S: Likewise.
	* sysdeps/unix/sysv/linux/ia64/setjmp.S: Likewise.
	* sysdeps/unix/sysv/linux/sparc/sparc64/setjmp.S: Likewise.
	* sysdeps/unix/sysv/linux/m68k/setjmp.c: Removed.

2000-11-21  Andreas Jaeger  <aj@suse.de>

	* sysdeps/generic/__longjmp.c (__longjmp): Remove obsolete
	NORETURN, fix parameter list.

	* string/bug-strncat1.c (main): Fix typo.
	Patch by Bernhard Kaindl <bernhard.kaindl@suse.de>.

2000-11-20  Ulrich Drepper  <drepper@redhat.com>

	* configure.in: Add --enable-all-warnings.
	* config.make.in (all-warnings): New variable.
	* Makeconfig (+gccwarn): Define with many more warnings if
	all-warnings is yes.

2000-11-20  Jakub Jelinek  <jakub@redhat.com>

	* iconvdata/bug-iconv2.c (main): Use %zd in format string.
	* io/test-lfs.c (do_test): Cast statbuf.st_size to long long.
	* malloc/tst-valloc.c (main): Cast valloc return value to long.
	* malloc/tst-obstack.c (verbose_malloc): Use %zd in format string.
	* math/test-fpucw.c (main): Use %lx in format string, cast
	control words to long.
	* stdio-common/tst-fmemopen.c (main): Use %td in format strings.
	* stdlib/tst-strtol.c (tests): Avoid (bogus?) decimal constant is so
	large that it is unsigned warning.

	* sysdeps/unix/sysv/linux/sparc/bits/types.h (__ssize_t): Changing
	it to long on sparc64.

2000-11-20  Andreas Jaeger  <aj@suse.de>

	* nscd/nscd.h (termination_handler): Add noreturn attribute.
	(receiv_print_stats): Likewise.

	* elf/ldconfig.c (path_hwcap): Cast -1 for proper comparison.

2000-11-20  Ulrich Drepper  <drepper@redhat.com>

	* malloc/thread-m.h: gcc doesn't tolerate zero-sized types anymore.

	* csu/gmon-start.c: Always have prototype for __gmon_start.
	* csu/version.c: Add prototypes for __libc_print_version and
	__libc_main.
	* iconv/gconv.c: Include gconv_int.h and gconv.h.
	* iconv/gconv.h (struct __gconv_step): Remove const from __from_name
	and __to_name.
	* iconv/gconv_builtin.h: Add ASCII module definitions.
	* iconv/gconv_conf.c (__gconv_path_elem): Remove const.
	(add_module): Add cast to avoid warning.  Rework construction of
	strings for new module.
	* iconv/gconv_db.c (__gconv_alias_compare): Make s1 and s2 const.
	(derivation_compare): Likewise.
	* iconv/gconv_dl.c (do_release_shlib): Remove const from nodep.
	(__gconv_release_shlib): Cast do_release_shlib as parameter for twalk.
	* iconv/gconv_int.h (__gconv_path_elem): Remove const.
	(struct gconv_alias): Remove const from fromname and toname.
	* iconv/gconv_simple.c: Include gconv_builtin.h to get prototypes
	for loop functions.
	(internal_ucs4_loop): Use correct const-ness.
	(ucs4_internal_loop): Likewise.
	(internal_ucs4le_loop): Likewise.
	(ucs4le_internal_loop_single): Likewise.
	* iconv/gconv_trans.c (__gconv_transliterate): Make from_idx, from_tbl,
	to_idx, to_tbl, winbuf, winbufend const.  Change casts in
	assignments appropriately.
	(struct known_trans): Remove const from fname.
	(trans_compare): Make s1 and s2 const.
	* iconv/loop.c (LOOPFC): Make outend parameter const.  Add cast to
	avoid warning.
	* iconv/skeleton.c: Remove cast in calls of loop functions.
	* iconvdata/gconv-modules: Remove US-ASCII definitions.
	* iconvdata/iso646.c: Remove US_ASCII support.
	* include/set-hooks.h (DEFINE_HOOK): Also generate prototype.
	* include/unistd.h: Add __libc_check_standard_fds prototype.
	* string/bits/string2.h (__mempcpy_args): Add const to casts.
	* sysdeps/generic/initfini.c: Add prototypes for dummy, _init, and
	_fini.
	* sysdeps/generic/libc-start.c: Add prototype for __libc_start_main.
	* sysdeps/i386/i486/bits/string.h (strcmp): Add const to casts.
	* sysdeps/unix/sysv/linux/dl-osinfo.h (dl_fatal): Add cast to avoid
	warning.
	* sysdeps/unix/sysv/linux/init-first.c: Add prototypes for
	__libc_init_first and _dl_start.
	* intl/dcigettext.c (transcmp): Make s1 and s2 const.
	(DCIGETTEXT): Make domaindata variable const.
	* intl/loadmsgcat.c (_nl_load_domain): Rearrange domain initialization
	to avoid warning.

2000-11-20  Hiroyuki Machida  <machida@sm.sony.co.jp>

	* sysdeps/unix/sysv/linux/mips/clone.S: Fix comments.

	* sysdeps/unix/sysv/linux/mips/kernel_stat.h (kernel_stat): Expand
	time_t to 'long int' not, 'unsigned int'.  Use 'long int' for
	__unused? members.

	* sysdeps/unix/sysv/linux/mips/bits/fcntl.h (O_NOFOLLOW): Use same
	value defined in /usr/include/asm-mips/fcntl.h.

2000-11-18  Ulrich Drepper  <drepper@redhat.com>

	* stdio-common/Makefile (tests): Add test-vfprintf.
	(test-vfprintf-ENV): New variable.
	* stdio-common/test-vfprintf.c: New file.

	* wcsmbs/mbrtowc.c (__mbrtowc): Do not only flush if input is '\0'.

	* wcsmbs/Makefile (tests): Add tst-mbrtowc and tst-wcrtomb.
	(tst-mbrtowc-ENV): New variable.
	(tst-wcrtomb-ENV): New variable.
	* wcsmbs/tst-mbrtowc.c: New file.
	* wcsmbs/tst-wcrtomb.c: New file.

2000-11-16  Andreas Jaeger  <aj@suse.de>

	* manual/install.texi (Tools for Compilation): Update
	documentation for GCC 2.95.2.

2000-11-18  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/posix/getaddrinfo.c (gaih_inet): Only return -EAI_AGAIN
	if IPv4 and IPv6 requests timed out.

2000-11-18  Akim Demaille  <akim@epita.fr>

	* malloc/obstack.h: Formatting changes.
	(obstack_grow, obstack_grow0): Don't cast WHERE at all: it
	prevents type checking.
	(obstack_ptr_grow, obstack_ptr_grow_fast): When assigning, don't
	cast the value to (void *): assigning a `foo *' to a `void *'
	variable is valid.
	(obstack_int_grow, obstack_int_grow_fast): Don't cast AINT to int.

2000-11-17  Ulrich Drepper  <drepper@redhat.com>

	* scripts/config.guess: Update from upstream maintainer.
	* scripts/config.sub: Likewise.

2000-11-16  Ulrich Drepper  <drepper@redhat.com>

	* libio/freopen.c (freopen): Reset _mode after succesful reopening.
	* libio/freopen64.c (freopen64): Likewise.
	Patch by Shinya Hanataka <hanataka@abyss.rim.or.jp>.

	* libio/Makefile: Add rules to build and run test-freopen.
	* libio/test-freopen.c: New file.
	* libio/test-freopen.sh: New file.

2000-11-15  H.J. Lu  <hjl@gnu.org>

	* sysdeps/generic/ldsodefs.h (DL_DT_INIT_ADDRESS): Defined if
	ELF_FUNCTION_PTR_IS_SPECIAL is not defined.
	(DL_DT_FINI_ADDRESS): Likewise.

	* sysdeps/ia64/dl-lookupcfg.h (_dl_lookup_address): Set the
	return type to ElfW(Addr).
	(_dl_function_address): New prototype.
	(DL_FUNCTION_ADDRESS): Defined.
	(DL_DT_INIT_ADDRESS): Defined as DL_FUNCTION_ADDRESS.
	(DL_DT_FINI_ADDRESS): Likewise.

	* sysdeps/ia64/Versions (GLIBC_2.2): Add _dl_function_address.

	* sysdeps/ia64/dl-machine.h (_dl_start_address): Removed.
	(ELF_MACHINE_START_ADDRESS): Changed to DL_FUNCTION_ADDRESS.

	* sysdeps/ia64/dl-symaddr.c (_dl_start_address): Renamed to ...
	(_dl_function_address): This.

	* elf/dl-fini.c (_dl_fini): Use DL_DT_FINI_ADDRESS to get the
	function pointer for DT_FINI.
	* elf/dl-close.c (_dl_close): Likewise.

	* elf/dl-init.c (_dl_init): Use DL_DT_INIT_ADDRESS to get the
	function pointer for DT_INIT.

2000-11-16  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/generic/printf_fphex.c (__printf_fphex): Compute correctly
	end of wexpbuf buffer.

2000-11-16  Andreas Jaeger  <aj@suse.de>

	* sysdeps/unix/sysv/linux/powerpc/bits/fcntl.h: Remove duplicate
	definition of F_GETLK, F_SETLK, F_SETLKW.

2000-11-16  Andreas Jaeger  <aj@suse.de>

	* sysdeps/generic/dl-cache.c (_DL_PLATFORMS_COUNT): Define to 0 if
	it's not defined.

2000-11-15  Jakub Jelinek  <jakub@redhat.com>

	* dlfcn/default.c (main): Add test for dladdr of main returning
	argv[0] in dli_fname field.

2000-11-15  Jakub Jelinek  <jakub@redhat.com>

	* Makeconfig (run-program-prefix): Move test-static test into the
	variable.

	* sysdeps/alpha/dl-machine.h (RTLD_START): Update _dl_argv.
	* sysdeps/sparc/sparc32/dl-machine.h (RTLD_START): Likewise,
	schedule instructions.
	* sysdeps/sparc/sparc64/dl-machine.h (RTLD_START): Likewise,
	schedule instructions, fix a bug in copying auxiliary data.

2000-11-15  Ulrich Drepper  <drepper@redhat.com>

	* manual/startup.texi (Program Arguments): Fix type of main's envp
	parameter.
	Reported by Raúl Núñez de Arenas Coronado <dervishd@linuxfreak.com>.

	* iconvdata/gconv-modules: Add CP950 alias.

2000-11-13  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/unix/sysv/linux/Makefile: Allow ports to override
	syscall-list.h goal.
	* sysdeps/unix/sysv/linux/sparc/Makefile: New file.

2000-11-15  Ulrich Drepper  <drepper@redhat.com>

	* intl/Makefile: tst-gettext2.sh does not need a third parameter.

	* intl/tst-gettext2.sh: Copy locale data.  Adjust LOCPATH.  Verify
	output of program.

	* intl/tst-gettext2.c: Set C locale if setting other locale
	failed.  Use gettext() not _().

	* locale/setlocale.c: Increment _nl_msg_cat_cntr whenever we
	successfully loaded a new locale.

2000-11-13  Andreas Jaeger  <aj@suse.de>

	* configure.in: Require gcc 2.95 or newer.

2000-11-15  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/paths.h: Adjust for FHS.
	Patch by Arkadiusz Miskiewicz <misiek@pld.ORG.PL>.

2000-11-11  Jim Meyering  <meyering@lucent.com>

	* string/strndup.c (strndup): Cast return value to `char *'.

2000-11-15  Jim Meyering  <meyering@ascend.com>

	* sysdeps/generic/memchr.c: Remove some useless parentheses.
	[HAVE_STDLIB_H || defined _LIBC]: Include <stdlib.h>.
	[HAVE_BP_SYM_H || defined _LIBC]: Guard inclusion of bp-sym.h.
	[! (HAVE_BP_SYM_H || defined _LIBC)] (BP_SYM): Define as no-op.
	Also #undef __memchr.
	Use `weak_alias' only if it's defined.

2000-11-10  H.J. Lu  <hjl@gnu.org>

	* Makefile.in (install): Set LANGUAGE=C LC_ALL=C.

2000-11-15  Andreas Jaeger  <aj@suse.de>

	* elf/chroot_canon.c: Include <stdint.h>.

	* elf/cache.c (struct cache_entry): Use uint64_t for hwcap.
	(print_entry): Likewise.
	(add_to_cache): Likewise.

	* elf/ldconfig.h (add_to_cache): Change prototype for hwcap change.

	* elf/ldconfig.c (struct lib_entry): Use uint64_t for hwcap.
	(path_hwcap): Likewise.
	(search_dir): Likewise.

	* sysdeps/generic/dl-cache.c (HWCAP_CHECK): Handle platform.

	* elf/cache.c (add_to_cache): Handle 64 bit hwcap entry.

	* sysdeps/unix/sysv/linux/sparc/sparc32/dl-procinfo.h
	(_dl_platform_string): New.
	(_DL_HWCAP_PLATFORM): New.
	(_dl_string_platform): New.
	* sysdeps/unix/sysv/linux/sparc/sparc64/dl-procinfo.h: Likewise.

	* sysdeps/generic/dl-procinfo.h (_DL_HWCAP_COUNT): New.
	(_dl_string_platform): New.
	(_DL_HWCAP_PLATFORM): New.
	(_dl_platform_string): New.

	* sysdeps/unix/sysv/linux/i386/dl-procinfo.h: Added x86 platform
	recognition.
	(_DL_HWCAP_COUNT): New.
	(_dl_string_platform): New.
	(_DL_HWCAP_PLATFORM): New.
	(_dl_platform_string): New.

2000-11-14  Ulrich Drepper  <drepper@redhat.com>

	* iconvdata/gconv-modules: Add CP936 as alias for GBK.

2000-11-14  Andreas Jaeger  <aj@suse.de>

	* sysdeps/generic/dl-cache.c (HWCAP_CHECK): Fix access to
	_dl_hwcap.

2000-11-13  Roland McGrath  <roland@frob.com>

	* hurd/get-host.c (_hurd_get_host_config): Fix last change.

2000-11-13  Marcus Brinkmann <marcus@gnu.org>

	* hurd/get-host.c (_hurd_get_host_config): Fix possible buffer
	underrun and make sure the result is null terminated even if there
	is no trailing newline.

2000-11-13  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/alpha/fpu/libm-test-ulps: Update.

2000-11-10  H.J. Lu  <hjl@gnu.org>

	* sysdeps/ia64/fpu/libm-test-ulps: Updated.

2000-11-10  Andreas Jaeger  <aj@suse.de>

	* elf/ldconfig.c (create_links): Fix alloca calculation.
	Patch by Ben Collins <bcollins@debian.org>.

2000-11-09  Ulrich Drepper  <drepper@redhat.com>

	* inet/getnameinfo.c (getnameinfo): Use correct destination
	parameter for if_indextoname.
	Patch by Hideaki YOSHIFUJI <yoshfuji@linux-ipv6.org>.

2000-11-09  H.J. Lu  <hjl@gnu.org>

	* sunrpc/Versions (GLIBC_2.1): Remove xdr_cryptkeyarg,
	xdr_cryptkeyarg2, xdr_cryptkeyres, xdr_des_block,
	xdr_key_netstarg, xdr_key_netstres, xdr_keybuf and
	xdr_keystatus.

	* time/Versions (GLIBC_2.1): Move getitimer to...
	* sysdeps/unix/sysv/linux/alpha/Versions (GLIBC_2.1): ...here.

2000-11-03  Bruno Haible  <haible@clisp.cons.org>

	* manual/install.texi: Recommend to set LANGUAGE=C LC_ALL-C during
	"make install", to work around a binary incompatibility between
	glibc 2.1 and glibc 2.2 gconv modules.

2000-11-09  Ulrich Drepper  <drepper@redhat.com>

	* intl/locale.alias: Add thai.
	Patch by Chanop Silpa-Anan <chanop@syseng.anu.edu.au>.

2000-11-07  Akim Demaille  <akim@epita.fr>

	* malloc/obstack.c (obstack_grow, obstack_grow0): Rename the second
	argument `data' for consistency with the prototypes.
	Qualify it `const'.
	(obstack_copy, obstack_copy0): Rename the second argument as
	`address' for consistency.  Qualify it `const'.
	* malloc/obstack.h (obstack_copy, obstack_copy0, obstack_grow)
	(obstack_grow0, obstack_ptr_grow, obstack_ptr_grow_fast): Qualify
	`const' their input argument (`data' or `address').
	Adjust the corresponding macros to include `const' in casts.

2000-11-06  Hideaki YOSHIFUJI  <yoshfuji@linux-ipv6.org>

	* sysdeps/posix/getaddrinfo.c: Clean-up: define family to hold
	target family.

2000-11-06  Hideaki YOSHIFUJI  <yoshfuji@linux-ipv6.org>

	* sysdeps/posix/getaddrinfo.c: Loosen protocol check to ease raw
	socket creation.

2000-11-06  Hideaki YOSHIFUJI  <yoshfuji@linux-ipv6.org>

	* sysdeps/posix/getaddrinfo.c: Ensure to fill ai_socktype and
	ai_protocol by internal table if service was not given.

2000-11-06  Hideaki YOSHIFUJI  <yoshfuji@linux-ipv6.org>

	* sysdeps/posix/getaddrinfo.c: Don't raise an error even if
	numerical port was specified with protocol without socktype.

2000-11-06  Hideaki YOSHIFUJI  <yoshfuji@linux-ipv6.org>

	* sysdeps/posix/getaddrinfo.c: Ensure to check if protocol is ok.

2000-11-06  Hideaki YOSHIFUJI  <yoshfuji@linux-ipv6.org>

	* inet/getnameinfo.c: getnameinfo() NI_xxx flag validation.

2000-11-06  Hideaki YOSHIFUJI  <yoshfuji@linux-ipv6.org>

	* sysdeps/posix/getaddrinfo.c: Ensure not to fill garbage value in
	sin6_scope_id field.

2000-11-06  Hideaki YOSHIFUJI  <yoshfuji@linux-ipv6.org>

	* inet/getnameinfo.c: Repair getnameinfo() sin6_socpe_id support.

2000-11-06  Hideaki YOSHIFUJI  <yoshfuji@linux-ipv6.org>

	* inet/getnameinfo.c: Repair NI_NOFQDN flag support.

2000-11-06  Hideaki YOSHIFUJI  <yoshfuji@linux-ipv6.org>

	* inet/getnameinfo.c: Wake-up sin6_scope_id support in
	getnameinfo(): check for whether sin6_socpe_id exist was wrong.

2000-11-09  Martin Schwidefsky  <mschwide@nc.boeblingen.de.ibm.com>

	* sysdeps/unix/sysv/linux/s390/mmap.S: Use mmap2 if it is present.
	* sysdeps/unix/sysv/linux/s390/mmap64.S: New file.

2000-11-09  H.J. Lu  <hjl@gnu.org>

	* io/Versions (GLIBC_2.1.1): Remove lockf64.


See ChangeLog.11 for earlier changes.
