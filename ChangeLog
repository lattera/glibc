Fri Jan 12 13:40:01 1996  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* posix/gnu/types.h: Moved to sysdeps/generic/gnu/types.h.

	* posix/glob.c (glob): Add parens in glob call flags arg for
	GLOB_BRACE case.

	* string/string.h (strdupa): New macro.

	* stdio-common/vfscanf.c (%[): Grok ] as first char in set, not
	terminator on empty set.  From drepper.

Thu Jan 11 13:09:20 1996  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* elf/do-rel.h (elf_dynamic_do_rel): Use referring symbol as
	referent for STB_LOCAL.

Wed Jan 10 10:11:39 1996  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* time/africa, time/antarctica, time/asia, time/australasia,
 	time/europe, time/northamerica, time/pacificnew, time/solar87,
 	time/solar88, time/solar89, time/southamerica: Updated from ADO 96a.

Tue Jan  9 16:10:26 1996  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* elf/dl-load.c (_dl_map_object_from_fd): After mapping first
 	segment to find location, mprotect excess region to no access,
 	don't munmap it.

	* sysdeps/mach/hurd/dl-sysdep.c (mmap): If vm_map returns
	KERN_NO_SPACE for fixed location, deallocate it and try again.

Mon Jan  8 17:43:23 1996  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* locale/Makefile (lib-modules): Renamed hash to locfile-hash.
	* locale/hash.c: Renamed to locale/locfile-hash.c.

Sat Jan  6 16:39:14 1996  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* Makefile (subdirs): Added db.

	* resolv/Makefile (routines): Add res_data.
	* resolv/res_data.c, resolv/res_debug.c, resolv/resolv.h:
	Updated from BIND 4.9.3 final release.

	* elf/dynamic-link.h (elf_get_dynamic_info): Handle
	processor-specific tags.
	(ELF_DYNAMIC_DO_REL, ELF_DYNAMIC_DO_RELA): Handle absent DT_PLTREL tag.

	* elf/elf.h (DT_MIPS_NUM, DT_PROCNUM): New macros.
	* elf/link.h (struct link_map): Extend `l_info' by DT_PROCNUM.

	* sysdeps/i386/dl-machine.h (elf_machine_runtime_setup): Take new
	arg LAZY.  Only do our work if LAZY and there is a DT_JMPREL record.
	* elf/dl-reloc.c (_dl_relocate_object): Call
	elf_machine_runtime_setup unconditionally, and pass it LAZY flag.

	* elf/dl-load.c: Fixed ELFMAG check to work for either byte order.
	Align end of load segment only to page size, not to segment alignment.

Thu Jan  4 11:35:18 1996  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/setitimer.c: Code rearranged a bit to use new
	preemption interface.

	* sysdeps/mach/hurd/i386/trampoline.c (_hurd_setup_sighandler):
	Use _hurdsig_catch_memory_fault.

	* hurd/Makefile (headers): Add hurd/sigpreempt.h.
	(sig): Add catch-signal.

	* hurd/hurdfault.c (_hurdsig_fault_catch_exception_raise):
	Rewritten using a preempter in new interface.
	* hurd/hurdfault.h (_hurdsig_catch_fault): Likewise.
	(_hurdsig_catch_memory_fault): New macro.

Wed Jan  3 20:23:42 1996  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* hurd/catch-signal.c: New file.

	* hurd/intr-msg.c: When restarting RPC, fetch a new reply port.

	* hurd/hurdsig.c: Use new hurdfault.h interface.
	(abort_all_rpcs): Mutate return value to EINTR in threads whose
	replies we will wait for.

	* hurd/hurdkill.c (_hurd_sig_post): When doing pgrp, make sure we
	do ourselves last.

Wed Jan  3 19:17:10 1996  Miles Bader  <miles@gnu.ai.mit.edu>

	* sysdeps/mach/hurd/access.c (__access): Put the uid/gid arguments
	to auth_makeauth() in the right order.

Wed Jan  3 17:19:04 1996  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/generic/strsep.c: Rewritten.

	* sysdeps/mach/hurd/fork.c: Use a different workaround for the
 	suspended page fault deadlock kernel bug: thread_abort our signal
 	thread first thing after proc_dostop.

	* sysdeps/mach/hurd/setgid.c: Rewrote gid frobnication to
	recognize rootness properly.

Tue Jan  2 00:50:10 1996  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* hurd/hurd/signal.h (struct hurd_sigstate): New member `preempters'.
	(hurd_preempt_signals, hurd_unpreempt_signals): Decls removed.
	* hurd/hurd/sigpreempt.h: New file.
	* hurd/preempt-sig.c: Rewritten with new interface.
	* sysdeps/mach/hurd/jmp-unwind.c (_longjmp_unwind): Remove local signal
	preempters being unwound past.
	* hurd/hurdsig.c: Use new signal preemption interface.

	* db: New directory, 4.4 BSD db package incorporated from BSD db-1.85
	release.

	* sysdeps/unix/sysv/linux/sys/param.h: Several new macros for BSD
	compatibility.

	* misc/queue.h: New file, incorporated from 4.4BSD.
	* misc/Makefile (headers): Add queue.h.

	* posix/sys/types.h [__USE_BSD]: Include endian.h.

	* io/sys/stat.h (DEFFILEMODE, ALLPERMS, ACCESSPERMS, S_BLKSIZE):
	New macros.

Thu Dec 28 10:21:35 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/generic/confname.h: Define all names as self-referential
	macros so #ifdef works.

	* hurd/preempt-sig.c (hurd_unpreempt_signals): Remove bogus asgnmt
	of _hurd_signal_preempters[SIGNO].

Mon Dec 25 20:56:39 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/bind.c: Translate EEXIST from dir_link into
	EADDRINUSE.  If translated node doesn't grok ifsock protocol,
	return EADDRINUSE.

	* sysdeps/mach/hurd/connect.c: Make address arg
	`const struct sockaddr_un *'.
	The redecl is kosher and avoids another variable for AF_LOCAL case.
	* sysdeps/mach/hurd/sendto.c: Likewise.
	* sysdeps/mach/hurd/bind.c: Likewise.

	* socket/sys/socket.h (__SOCKADDR_ARG): Enable transparent_union
 	code for GCC >= 2.7; use __transparent_union__ for name safety;
 	add several sockaddr flavors.
	(__SOCKADDR_ALLTYPES, __SOCKADDR_ONETYPE): New macros used in
	constructing the transparent union declarations.
	(__CONST_SOCKADDR_ARG): New type (or macro if not GCC 2.7).
	(bind, connect, sendto): Make the sockaddr argument use that.

Fri Dec 22 00:57:38 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/setgid.c: In root case, store into NEWAUX, not
	old vector.
	* sysdeps/mach/hurd/setuid.c: Likewise.

	* sysdeps/mach/hurd/setuid.c: Rewrote ID frobnication to do the
	right thing.
	* sysdeps/mach/hurd/setgid.c: Likewise.
	* sysdeps/mach/hurd/setreuid.c: Likewise.
	* sysdeps/mach/hurd/setregid.c: Likewise.
	* sysdeps/mach/hurd/setegid.c: Likewise.
	* sysdeps/mach/hurd/seteuid.c: Likewise.

	* sysdeps/mach/hurd/fork.c: Peek __mach_task_self_ value before
	proc_dostop call to work around kernel paging bug.

Fri Dec 22 00:38:00 1995  H.J. Lu  <hjl@nynexst.com>

        * stdio-common/vfscanf.c: Correctly handle white space skipping.
	* stdio-common/Makefile (tests): Add bug11.
	* stdio-common/bug11.c: New file.

Thu Dec 21 12:19:32 1995  Miles Bader  <miles@gnu.ai.mit.edu>

	* sysdeps/mach/hurd/setuid.c (__setuid): Actually add the new uid
 	instead of putting it (and other uids) in the gids and leaving the
 	old uids as is.

Wed Dec 20 18:23:10 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* stdio/internals.c (flushbuf): If the target is -1, always
	discard the buffer of read data.
	Only set TWIDDLED flag in !ALIGNED case.
	Never increment target or offset when old value is -1.

Tue Dec 19 17:00:42 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* hurd/hurdpid.c (_S_msg_proc_newids): Only run the hook when the
	pgrp changes.

Mon Dec 18 13:40:37 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* stdio/fread.c: Don't increment __offset when it's -1.

	* elf/rtld.c (dl_main): Prepend tab to "statically linked".  Exit
	0 in that case.

	* misc/err.c (vwarnx, vwarn): Fix major brainos.

	* sysdeps/mach/hurd/dl-sysdep.c (mmap): Fix setting of
	inheritance.

Sun Dec 17 15:56:35 1995  Miles Bader  <miles@gnu.ai.mit.edu>

	* misc/getpass.c (getpass): Don't barf if getline returns a null BUF.

Sat Dec 16 10:33:11 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* Makerules: Use $(do-install-so) for installing shared objects.
	(do-install-so): New canned sequence.  Make a symlink LIB.so after
	installing LIB.so.VERSION.

	* inet/netinet/in.h: Fixed typo in IPPORT_WHOIS.

Fri Dec 15 04:41:22 1995  Ulrich Drepper  <drepper@gnu.ai.mit.edu>

	* stdio-common/Makefile (tests): Add bug10.
	* stdio-common/bug10.c: New file.  From HJ Lu.

	* stdio-common/tstdiomisc.c: Make more test-suite like: exit
	status tells about successful run.

	* stdio-common/vfscanf.c [!USE_IN_LIBIO]: Use `flags' to check
	format correctness.
	Correct handling of trailing white spaces in format + EOF.

Fri Dec 15 01:31:56 1995  Ulrich Drepper  <drepper@gnu.ai.mit.edu>

	* stdio-common/Makefile (tests): Add bug8 and bug9.
	* stdio-common/bug8.c, stdio-common/bug9.c: New tests.

	* stdio-common/vfscanf.c: Fix bug in dynamic buffer handling.

	* stdlib/strtod.c: Correct spelling: nominator -> numerator.
	Thanks to Jim Meyering.

Sat Nov 25 06:05:12 1995  H.J. Lu  <hjl@nynexst.com>

	* stdio-common/vfscanf.c: Always check width !=0.
	Correctly handle %%.

Thu Dec 14 02:28:22 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* posix/glob.c (glob_in_dir): Cast result of opendir to __ptr_t,
	and cast STREAM to DIR * before passing to readdir and closedir.

Wed Dec 13 22:06:07 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* hurd/hurdsig.c (_hurd_internal_post_signal: suspend): Reply
	after aborting RPCs but before calling proc_mark_stop.

Mon Dec 11 20:07:54 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* posix/glob.c [! STDC_HEADERS]: Declare getenv.
	(glob): Avoid using function as value.

	* elf/rtld.c (dl_main): When mapping argument executable, set
	l_name to "", not l_libname.
	After loading DT_NEEDED library, set its l_type to lt_library.

	* sysdeps/mach/hurd/mmap.c: Don't interpret MAP_INHERIT to mean
	VM_INHERIT.  We can't handle MAP_INHERIT easily.
	Handle non-page-aligned addresses if congruent to offset.

	* elf/dl-init.c: Skip the initializer for l_type lt_executable
	with l_name "". Start at _dl_loaded; don't skip the first element.

	* elf/dl-load.c (MAP_FILE): Define to zero if undefined.
	(MAP_COPY): Define to MAP_PRIVATE if undefined.
	(_dl_map_object_from_fd): Don't use MAP_INHERIT in mmap calls.
	If file it ET_EXEC, set its l_type to lt_executable.

Sun Dec 10 09:56:06 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* elf/dl-minimal.c (malloc): Use MAP_PRIVATE in mmap call.

Fri Dec  8 13:04:51 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* locale/error.c, locale/error.h: Files removed.
	* locale/Makefile (distribute): Remove error.h.
	(lib-modules): Remove error.

	* hurd/hurdlookup.c (__hurd_file_name_lookup_retry): For "tty"
	magic, return ENXIO if no ctty.

	* sysdeps/mach/hurd/mmap.c: For MAP_FIXED, deallocate a previous
	mapping if vm_map fails for that reason.

	* posix/glob.c: Implement new options GLOB_ALTDIRFUNC, GLOB_BRACE,
	GLOB_TILDE, GLOB_NOMAGIC.
	(glob): Use stat instead of lstat to determine directoriness.
	* posix/glob.h (GLOB_ALTDIRFUNC, GLOB_BRACE, GLOB_NOMAGIC, GLOB_TILDE):
	New flag bits.
	(__GLOB_FLAGS): Include them.
	(glob_t): New members gl_closedir, gl_readdir, gl_opendir, gl_lstat,
	gl_stat.

	* elf/elf.h (ET_NUM, SHT_NUM, STB_NUM, STT_NUM, PT_NUM): New macros.

	* sysdeps/unix/sysv/linux/sys/mman.h: Include <linux/mman.h> to
	define all the bit values.
	(MAP_*, MCL_*): Macros removed.

Thu Dec  7 02:27:56 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* resolv/res_comp.c, resolv/res_debug.c, resolv/res_send.c:
	Updated from BIND 4.9.3-BETA27.

Wed Dec  6 18:44:01 1995  Miles Bader  <miles@gnu.ai.mit.edu>

	* sysdeps/mach/hurd/select.c (__select): Swap size args to mach_msg.

	* sysdeps/mach/hurd/select.c (__select): Frob TYPES correctly when
	we get a delayed reply.
	Only grab values out of entries in TYPES that have SELECT_RETURNED
 	turned on, and turn it on whenever an rpc returns.
	Only clear bits in the user's fdsets -- those needing to be set
	should be already.
	Use SELECT_ALL in appropiate places.
	(SELECT_RETURNED, SELECT_ALL): New macros.

Wed Dec  6 09:10:39 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/sys/param.h (NBBY): New macro.

	* gnu-versions.h (_GNU_GLOB_INTERFACE_VERSION): New macro.

Tue Dec  5 14:00:17 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* misc/Makefile (headers): Add error.h, err.h.
	(routines): Add error, err.
	(gpl2lgpl): New variable.
	* misc/err.c: New file.
	* misc/err.h: New file.
	* misc/error.c, misc/error.h: New files.

	* sysdeps/mach/hurd/ioctl.c: Fix typo in last change.

	* Makeconfig (+link): Translate libc% from $^, not just libc.a.
	(link-libc): Append $(libc.so-version) to libc.so.
	(built-program-cmd): Fix comma usage.
	* Makerules [libc.so-version] (libc.so$(libc.so-version)): Make a
	symlink to libc.so in the build directory.
	* Rules ($(others) $(tests)): Depend on the library that appears
	in $(link-libc).
	(%.out): Use $(built-program-cmd) in commands.

	* posix/unistd.h [__USE_MISC]: Declare brk, sbrk.

	* sysdeps/generic/setenv.c: Added canonical portability cruft.
	(setenv): Use realloc on LAST_ENVIRON instead of always copying.
	(unsetenv): New function.
	* stdlib/stdlib.h [__USE_BSD]: Declare unsetenv.
	* sysdeps/generic/putenv.c: Rewritten using setenv and unsetenv.

Tue Dec  5 02:27:32 1995  Ulrich Drepper  <drepper@gnu.ai.mit.edu>

	* libio/Makefile (routines): Remove iofscanf, add iopopen, pclose.

	* libio/iofscanf.c: Remove file.

	* libio/iogetdelim.c (_IO_getdelim): Correct stupid bug at string
        termination.

	* libio/iopopen.c: New file from GNU libio.

	* libio/memstream.c: Fixed bug in fclose handling.  Instead of
	providing a close callback we need a finish callback.

	* libio/pclose.c: New file.  Derived from popen.c in GNU libio.

	* posix/gnu/types.h: Fixed typo.

	* stdio-common/errnobug.c: fputs returns EOF in error case.  Do
	not test for != 0.

	* stdio-common/printf-parse.h (parse_one_spec): Do not force
	padding with ' ' if precision is given.  Fix by HJ Lu.

	* stdio-common/printf_fp.c: Fix comment.

	* stdio-common/tfformat.c, stdio-common/tiformat.c,
	stdio-common/tstdiomisc.c: New files from GNU libio test suite.

	* stdio-common/tstgetln.c: Provide ssize_t type when testing
	libio.

	* stdio-common/vfprintf.c (outchar): Use PUTC instead of putc.
	(vfprintf): Cleasr args_type array before using it.
	When printing 0 as an integer with precision 0 nothing must be
	written for the number.
	Based on patch by HJ Lu.

	* stdio-common/vfscanf.c: Remove fixed input buffer.  Now we
        have a dynamically extended buffer.

	* stdlib/strtod.c: Merge with version in Linux libc.  This fixes
        some bugs with handling of very small numbers and has different
        solution for formaer patches.

	* sysdeps/i386/i586/add_n.S, sysdeps/i386/i586/sub_n.S: Rename
        macros r1 and r2 to t1, and t2 resp.  This is necessary because
        glibc headers also define r1.

Mon Dec  4 12:10:28 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* stdlib/gen-mpn-copy (translations): Updated for new layout in
	GMP 1.910.

	* malloc/malloc.c (__malloc_initialize): Renamed from initialize;
	made global.
	(malloc): Caller changed.
	* malloc/realloc.c (realloc): Call __malloc_initialize if
	necessary, before checking hook.
	* malloc/malloc.h: Declare __malloc_initialize.

	* sysdeps/mach/hurd/ioctl.c: For IOC_VOID request, send ARG itself
	as integer_t arg in RPC.

Sat Dec  2 03:47:27 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/brk.c (DATA_SIZE): Bump to 128MB.
	(_hurd_set_brk): Try to allocate more space when we run out.

	* sysdeps/generic/sbrk.c: If __curbrk is zero, call __brk with
	zero and examine it again.
	* sysdeps/unix/sysv/linux/i386/brk.c: New file.
	* sysdeps/unix/sysv/linux/i386/brk.S: File removed.
	* sysdeps/unix/sysv/linux/i386/sbrk.S: File removed.
	* sysdeps/unix/sysv/linux/dl-sysdep.c: New file.
	* sysdeps/generic/dl-sysdep.c (_dl_sysdep_start) [DL_SYSDEP_INIT]:
	Invoke this macro before calling DL_MAIN.

	* malloc/malloc.c (malloc): Do initialization here, before
	checking the hook.
	(_malloc_internal): Don't do it here.

Wed Nov 29 12:30:50 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* libio/vsnprintf.c (__vsnprintf): Define as alias.
	* libio/iovsscanf.c (__vsscanf): Define as alias.
	* asprintf.c: Remove libio adaptation code added by drepper.
	* dprintf.c: Likewise.
	* printf.c: Likewise.
	* scanf.c: Likewise.
	* snprintf.c: Likewise.
	* sprintf.c: Likewise.
	* sscanf.c: Likewise.
	* vprintf.c: Likewise.
	* stdio-common/vfscanf.c [USE_IN_LIBIO] (__vfscanf): New wrapper
	function.
	(vfscanf): Define unconditionally.

	* sysdeps/i386/dl-machine.h (elf_machine_rel): If SYM is null, use
	zero for value.

	* misc/getpass.c: Write a newline after reading the unechoed
	password.

Mon Nov 27 19:24:18 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* posix/Makefile (routines): Add getsid.
	* sysdeps/unix/sysv/linux/getsid.S: New file.
	* sysdeps/mach/hurd/getsid.c: New file.
	* sysdeps/stub/getsid.c: New file.
	* posix/unistd.h [__USE_GNU]: Declare getsid.

Sun Nov 26 12:44:38 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* libc-symbols.h (N_): New macro.

Sat Nov 25 02:48:47 1995  Ulrich Drepper  <drepper@gnu.ai.mit.edu>

	* assert/assert-perr.c, assert/assert.c, inet/rcmd.c,
	malloc/mcheck.c, malloc/vm-limit.c, posix/getconf.c, posix/id.c,
	resolv/herror.c, sunrpc/auth_unix.c, sunrpc/clnt_perr.c,
	sunrpc/clnt_raw.c, sunrpc/get_myaddr.c, sunrpc/pmap_clnt.c,
	sunrpc/pmap_rmt.c, sunrpc/portmap.c, sunrpc/rpc_main.c,
	sunrpc/rpc_parse.c, sunrpc/rpc_scan.c, sunrpc/rpc_util.c,
	sunrpc/rpcinfo.c, sunrpc/svc_simple.c, sunrpc/svc_tcp.c,
	sunrpc/svc_udp.c, time/zdump.c, time/zic.c: Mark translatable
	strings.

Sun Nov 26 02:00:02 1995  Ulrich Drepper  <drepper@gnu.ai.mit.edu>

	* misc/syslog.c (vsyslog) [USE_IN_LIBIO]: Adapted for libio.

Thu Nov 23 02:21:55 1995  Ulrich Drepper  <drepper@gnu.ai.mit.edu>

	* sysdeps/unix/sysv/linux/{mlock,munlock,mlockall,munlockall}.S:
	New files.
	* sysdeps/unix/sysv/linux/sys/mman.h: Add prototypes for new functions
	mlock, munlock, mlockall, and munlockall.

Thu Nov 23 18:26:52 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* configure.in (--enable-libio): Set $stdio based on $enableval,
	not always to libio.

Thu Nov 23 18:06:48 1995  Richard Stallman  <rms@gnu.ai.mit.edu>

	* malloc/malloc.c (_malloc_internal): Can't use
	get_contiguous_space when the heap info table
	will be growing.  Account for new contiguous space in _heaplimit.

Wed Nov 22 12:37:39 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/unix/sysv/linux/i386/sysdep.S (_errno): Define as alias
	for errno.

	* stdio-common/vfprintf.c [USE_IN_LIBIO] (vfprintf): Define as
	alias for _IO_vfprintf.

	* sysdeps/unix/sysv/linux/sockaddrcom.h: File removed.

	* sysdeps/unix/sysv/linux/i386/init-first.c (init): Use
	__fpu_control instead of ___fpu_control.
	* sysdeps/unix/sysv/linux/i386/ieee_fpu.c
	(___fpu_control): Renamed to __fpu_control.
	* sysdeps/unix/sysv/linux/i386/fpu_control.h: Likewise.
	* sysdeps/unix/sysv/linux/i386/fpu_control.c: Likewise.

	* elf/dl-minimal.c: New file.
	* elf/Makefile (rtld-routines): Add dl-minimal.
	* elf/rtld.c (__dgettext, __assert_fail, __assert_perror_fail):
	Functions moved to dl-minimal.c.
	* sysdeps/mach/hurd/dl-sysdep.c (malloc, free, realloc,
	sigjmp_save, longjmp): Likewise.

	* sysdeps/unix/sysv/linux/i386/brk.S (__curbrk): Always initialize
	to &_end, regardless of PIC.

	* stdio-common/vfscanf.c (__vfscanf): Fix arg name in defn.

Tue Nov 21 14:12:13 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* malloc/malloc.c (align): Don't check contiguity and call abort.

	* hurd/hurdsig.c (post_reply): Function removed.
	(abort_thread, abort_all_rpcs, _hurdsig_abort_rpcs): Don't call it.
	Take single callback fn arg instead of reply port and type.
	(_hurd_internal_post_signal): Callers changed.
	Cache reply stub fn ptr in local var before UNTRACED might be changed.

	* sysdeps/mach/hurd/mmap.c: Cope with a null write memobj for
	PROT_READ|PROT_WRITE copy mapping.  Pass a proper vm_inherit_t to
	vm_map.

	* elf/rtld.c (_dl_start): For --list, do output and exit before
	relocating.

Mon Nov 20 16:19:15 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* intl/Makefile [gettext-srcdir]: Rewrote copying rules to only
	get .c and .h files.

	* malloc/malloc.c (align): Use abort instead of assert.

Sun Nov 19 18:23:07 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* Makeconfig (+includes): Add $($(stdio)-include).
	(libio-include): New variable.

	* stdlib/strtod.c: Put weak_symbol after function defn.
	* stdlib/strtol.c: Likewise.

	* configure.in (--enable-libio): If not present, set $stdio to
	"default".  Move stdio/libio check to end, so sysdeps fragments
	can affect it.  Reset $stdio to "stdio" if it's "default".
	* sysdeps/unix/sysv/linux/configure: New file.

Sat Nov 18 16:46:01 1995  Ulrich Drepper  <drepper@gnu.ai.mit.edu>

	* libio/Makefile, libio/cleanup.c, libio/clearerr.c, libio/feof.c,
	libio/ferror.c, libio/fgetc.c, libio/filedoalloc.c, libio/fileno.c,
	libio/fileops.c, libio/fputc.c, libio/freopen.c, libio/fseek.c,
	libio/genops.c, libio/getc.c, libio/getchar.c, libio/iofclose.c,
	libio/iofdopen.c, libio/iofflush.c, libio/iofgetpos.c, libio/iofgets.c,
	libio/iofopen.c, libio/iofprintf.c, libio/iofputs.c, libio/iofread.c,
	libio/iofscanf.c, libio/iofsetpos.c, libio/ioftell.c, libio/iofwrite.c,
	libio/iogetdelim.c, libio/iogetline.c, libio/iogets.c, libio/iolibio.h,
	libio/iopadn.c, libio/ioprims.c, libio/ioputs.c, libio/ioseekoff.c,
	libio/ioseekpos.c, libio/iosetbuffer.c, libio/iosetvbuf.c,
	libio/iosprintf.c, libio/ioungetc.c, libio/iovsprintf.c,
	libio/iovsscanf.c, libio/libio.h, libio/libioP.h, libio/putc.c,
	libio/putchar.c, libio/rewind.c, libio/setbuf.c, libio/setlinebuf.c,
	libio/stdfiles.c, libio/stdio.c, libio/stdio.h, libio/strfile.h,
	libio/strops.c, libio/vasprintf.c, libio/vscanf.c, libio/vsnprintf.c:
	New files.  Slightly modified version from Linux libc.

	* libio/memstream.c, libio/vdprintf.c: New files for functions not
	(yet) part of GNU libio.

	* libio/iofopncook.c: Implementation of `fopencookie', mainly written
	by Per Bothner.

	* stdio-common/getline.c: Adapted to libio.
	* stdio-common/snprintf.c: Adapted to libio.
	* stdio-common/vfprintf.c: Adapted to libio.
	* stdio-common/vfscanf.c: Adapted to libio.
	* sysdeps/posix/tempname.c: Adapted to libio.

Fri Nov 17 17:57:00 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/generic/Makefile (make_siglist): Add missing backslash.

	* sysdeps/generic/dl-sysdep.c (_dl_sysdep_start_cleanup): New
	function.

	* hurd/hurdfault.c: Replace __libc_fatal calls with assert_perror.
	(_hurdsig_fault_init): Remove #if 0 from setting exception port.
	Insert send right for SIGEXC before thread_set_special_port.
	* hurd/hurdsig.c: Replace __libc_fatal calls with assert_perror.
	(_hurdsig_init): Remove #if 0 from setting exception port.

	* sysdeps/mach/hurd/ptrace.c (ptrace: PTRACE_CONT): Use
	HURD_MSGPORT_RPC macro.

Thu Nov 16 06:07:49 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/dl-sysdep.c (_dl_sysdep_start_cleanup): New
	function.
	(_dl_sysdep_start): Move cleanup code there.

	* Makeconfig (default-rpath): New variable.
	(link-libc): Use it.
	* elf/Makefile (ld.so): Pass -rpath=$(default-rpath).
	* elf/rtld.c (_dl_rpath): New variable.
	(_dl_start): Set it from rtld_map's DT_RPATH.
	Call _dl_setup_hash on rtld_map.
	(dl_main): Cache address of _exit in variable before relocating,
	and use that in later calls.  Call _dl_sysdep_start_cleanup before
	relocating.  Keep track of dependency order while loading; remove
	rtld_map from chain, and reinsert in proper order if there is a
	dependency on it.

	* sysdeps/generic/Makefile (make_siglist): Pass
	-DSIGNUM_H=... with config's signum.h location.
	* sysdeps/generic/make_siglist.c: Include SIGNUM_H to define
	signal numbers.
	(HAVE_STRSIGNAL, HAVE_PSIGNAL): Define these before including signame.c
	(main): Deansideclize output.

	* elf/dl-load.c (_dl_map_object): Use _dl_rpath variable in place
	of DEFAULT_RPATH macro.
	* elf/Makefile: Undo last change.

	* sysdeps/mach/hurd/dl-sysdep.c (free): Don't abort, just nop.

Wed Nov 15 19:22:07 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* elf/dl-lookup.c (_dl_lookup_symbol): Undefined symbol is no
	error if weak.

	* elf/Makefile (default-rpath): New variable.
	(CPPFLAGS): Append -DDEFAULT_RPATH=....
	* elf/dl-load.c (_dl_map_object): Use DEFAULT_RPATH instead of
	hard-coded "/lib:/usr/lib".

	* sysdeps/mach/hurd/dl-sysdep.c: Include _itoa.h from stdio-common
	instead of stdio.
	(_dl_sysdep_start): If passed user entry is zero and
	EXEC_STACK_ARGS flag set, reset user entry to &_start.

	* elf/rtld.c (dl_main): Only call _dl_setup_hash if there is a
	DT_HASH element.

	* libc-symbols.h [HAVE_ELF] (symbol_set_declare): Gratuitously
	repeat weak decl using weak_symbol macro, in case using broken GCC
	(<2.8).

Wed Nov 15 18:49:55 1995  Ulrich Drepper  <drepper@ipd.info.uni-karlsruhe.de>

	* sysdeps/i386/isnanl.c: New file.
	* sysdeps/i386/isinfl.c: New file.

Tue Nov 14 18:44:21 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* malloc/free.c (free): Moved null and aligned_blocks checks
	inside _free_internal.

Mon Nov 13 15:23:01 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* malloc/malloc.c (morecore): Fix inverted test in allocating new
	info table.

	* malloc/malloc.c (align): Fix assertion.

	* malloc/malloc.c: Include assert.h.

	* libc-symbols.h: Use __attribute__ for GCC 2.8, not 2.7.

	* malloc/malloc.h [emacs] (emacs_loser_valloc): Macro removed.
	(valloc): Protect decl with [! (_MALLOC_INTERNAL && emacs)].

Fri Nov 10 14:15:21 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* malloc/malloc.c (align): Assert that space for alignment
	adjustment is same original space.

	* hurd/hurdprio.c (_hurd_priority_which_map): Cast vm_deallocate
	arg to vm_address_t.

	* hurd/hurdsig.c (_hurd_internal_post_signal): For SIGNO == 0,
	skip straight to pending check.  When UNTRACED, resume process
	from suspension first.

	* intl/Makefile (headers): New variable, libintl.h.
	[gettext-srcdir]: New rules to copy source from $(gettext-srcdir)/intl.
	* configure.in: Check for --with-gettext arg.

Fri Nov 10 13:51:30 1995  Richard Stallman  <rms@gnu.ai.mit.edu>

	* malloc/malloc.c (get_contiguous_space): New function.
	(morecore): Rewrite allocating new malloc info table.
	(_malloc_internal): Use get_contiguous_space.

Fri Nov 10 13:03:40 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* hurd/hurdexec.c (_hurd_exec): If exec'ing self, pass
	_hurd_msgport to be destroyed.

	* Makerules (installed-libcs): Filter out %_pic.a.

	* hurd/hurdinit.c (_hurd_proc_init): When traced, use msg_sig_post
	to our msgport to take SIGTRAP, instead of _hurd_raise_signal.

	* hurd/Makefile (user-interfaces): Add hurd/process_request.

Wed Nov  8 16:31:25 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* termios/Makefile (headers): Add sys/ttychars.h.
	* termios/sys/ttychars.h: New file, incorporated from 4.4BSD-Lite
	for compatibility.

	* signal/signal.h [__USE_BSD] (sig_t): New typedef.

Wed Nov  8 15:12:47 1995  Michael I. Bushnell, p/BSG  <mib@gnu.ai.mit.edu>

	* sysdeps/mach/hurd/ptrace.c (ptrace) [PTRACE_TRACEME]: Notify the
	proc server that we are now traced.

Tue Nov  7 12:29:46 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* elf/Makefile (ldd): Make it executable.

	* Makeconfig (config-LDFLAGS): Find dynamic linker in $(slibdir).

	* Makeconfig (slibdir): New variable.
	* Makerules (install): Install libc.so in $(slibdir).
	* elf/Makefile (install-others): Install ld.so and ld-linux.so.1
	in $(slibdir).

	* elf/linux-compat.c: New file.
	* elf/Makefile (distribute): Add linux-compat.c.
	(generated): Add librtld.so.
	[$(config-os)=linux*] (extra-objs): Add linux-compat.so.
	[$(config-os)=linux*] (extra-objs): Add ld-linux.so.1.
	(librtld.so): New target.
	(ld.so, ld-linux.so.1): Make from librtld.so.

	* elf/rtld.c (dl_main): Instead of weak call to _dl_compat_init,
	call our own DT_INIT if we have one (and then clear it).
	(__dgettext): New weak function.

	* intl/localealias.c (read_alias_file): Avoid sprintf; use memcpy
	by hand instead.

	* sysdeps/generic/_strerror.c (_strerror_internal): Use _itoa
	instead of snprintf.

	* sysdeps/mach/_strerror.c (_strerror_internal): Don't write
	BUF[BUFLEN].

	* elf/rtld.c (rtld_map): New static variable.
	(_dl_start): Use a differently named local BOOTSTRAP_MAP for the
	bootstrapping.  Then copy data into `rtld_map'.
	(dl_main): Finish filling in rtld_map and link it into the chain,
	instead of allocating a new structure.
	(dl_main): Call _dl_compat_init if it is defined (use weak ref).

	* elf/dlsym.c: Fix last change: move REF out of `doit'.

Mon Nov  6 16:20:14 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* elf/dlsym.c: Return the proper value, not just the defining
	object's loadbase.

Sun Nov  5 16:09:13 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* stdio-common/vfprintf.c (%c): Count the character itself towards
	the field width in all cases.

	* sysdeps/mach/hurd/getpriority.c (getpriority): Cast
	__vm_deallocate arg to vm_address_t.

Fri Nov  3 17:27:49 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/sendto.c: Don't pass BINDING arg to
	socket_create_address.
	* sysdeps/mach/hurd/connect.c: Likewise.
	* sysdeps/mach/hurd/bind.c: Likewise.

	* hurd/hurdprio.c (_hurd_priority_which_map): Pass threadwaits
	args to proc_getprocinfo.
	* sysdeps/mach/hurd/getpriority.c: Likewise.

	* hurd/hurdmsg.c (_S_msg_report_wait): New stub function.

Thu Nov  2 19:24:37 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/unix/sysv/linux/i386/sysdep.S (errno): Define as common.

Tue Oct 31 00:07:29 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/getpriority.c (getpriority): Pass
	PI_FETCH_TASKINFO to proc_getprocinfo and through
	_hurd_priority_which_map.

	* sysdeps/mach/hurd/setpriority.c (setpriority): Pass new arg to
	_hurd_priority_which_map.
	* hurd/hurdprio.c (_hurd_priority_which_map): New arg PI_FLAGS,
	passed through to proc_getprocinfo RPC.
	* hurd/hurd/resource.h: Add PI_FLAGS arg in decl.

	* sysdeps/mach/hurd/group_member.c: New file.
	* sysdeps/generic/group_member.c: New file.

	* Makerules (lib-noranlib): Don't depend on $(install-lib).
	(others): Do.
	* extra-lib.mk: Fix test of $(lib)-no-lib-dep.

Mon Oct 30 12:33:10 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* Rules (others): Depend on $(extra-objs).

	* posix/unistd.h [__USE_GNU]: Declare group_member, __group_member.
	* posix/Makefile (routines): Add group_member.

	* sysdeps/posix/euidaccess.c: New file, adapted from fileutils.

	* sysdeps/unix/sysv/linux/i386/sigaction.c: Tighten constraint for
	SIG operand in asm so it must be a register.
	Add dead return to quiet gcc warning.

	* Makerules (sysd-rules): Write a defn for sysd-rules-done.
	[! sysd-rules-done]: Inhibit deps.

Thu Oct 26 23:11:11 1995  Ulrich Drepper  <drepper@ipd.info.uni-karlsruhe.de>

	* sysdeps/unix/sysv/linux/poll.c: Don't define as stub.  Use
	simulation of system call using select.

	* sysdeps/unix/sysv/linux/signal.c: Use POSIX implementation.

	* sysdeps/unix/sysv/linux/statbuf.h: Define _STAT_VER.

	* sysdeps/unix/sysv/linux/i386/sigaction.c: Correct parameter
	name usage (new->act, old->oact).
	Correct asm statement because of gcc strangeness.

	* sysdeps/i386/i586/strchr.S: Correct typos: cmp -> cmpb.

	* sunrpc/clnt_perr.c: Remove declaration of sys_errlist.  They
	conflict with the ones in stdio.h.

	* string/tester.c: %Z is no complete format.  Change to %Zd.

Thu Oct 26 18:13:33 1995  Miles Bader  <miles@gnu.ai.mit.edu>

	* sysdeps/mach/hurd/bind.c (bind): Swap args to dir_link.
	* sysdeps/mach/hurd/link.c (__link): Ditto.
	* sysdeps/mach/hurd/symlink.c (__symlink): Ditto.
	* sysdeps/mach/hurd/mknod.c (__mknod): Ditto.
	Include "stdio-common/_itoa.h" instead of "stdio/_itoa.h".

Thu Oct 26 00:11:13 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/unix/sysv/linux/i386/sigaction.c: New file.

	* sysdeps/unix/sysv/linux/i386/xstat.S: Don't use JUMPTARGET macro
	on syscall_error.  For PIC, it is a local label;
	for non-PIC, JUMPTARGET expands to the unadorned name anyway.
	* sysdeps/unix/sysv/linux/i386/xmknod.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/syscall.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/socket.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/sbrk.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/mmap.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/brk.S: Likewise.

Thu Oct 26 03:01:22 1995  Ulrich Drepper  <drepper@ipd.info.uni-karlsruhe.de>

	* sysdeps/unix/sysv/linux/syscall.h: Strip list of syscalls in
	comment to the necessary ones.  Add _readv and _writev.

	* sysdeps/unix/configure.in: Change syntax for system call test
	candidates and adapt sed script for this.  Now use : to separate
	syscall name and file name.

	* sysdeps/unix/sysv/linux/i386/sysdep.h (ENTRY): System call
	number is now set is DO_CALL.  So call with additional argument.
	(DO_CALL): Takes an additional argument.  Load system call
	number according to new argument.
	(SYSCALL_ERROR_HANDLER): Add ; after last ret statement.
	* sysdeps/unix/sysv/linux/i386/brk.S [PIC]: Define __syscall_error
	locally using SYSCALL_ERROR_HANDLER macro.
	* sysdeps/unix/sysv/linux/i386/mmap.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/sbrk.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/socket.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/xmknod.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/xstat.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/syscall.S: Likewise.
	Don't use DO_CALL macro; instead use lower level macros for better
	control.

	* sysdeps/unix/sysv/linux/sigaction.h: New file.
	* sysdeps/unix/sysv/linux/sigaction.S: File removed.
	* sysdeps/unix/sysv/linux/signal.S: File removed.

Wed Oct 25 14:23:35 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* hurd/hurdstartup.c (_hurd_startup): Use new
	exec_startup_get_info RPC from exec_startup.defs
	in place of old exec_startup from exec.defs.  Remove kludge to
	guess user entry and phdr locations, since the new RPC gives us
	that info.

	* stdio/stdio.h (sys_errlist, _sys_errlist): Declare const.
	* sysdeps/generic/_strerror.c: Undo last change.

	* sysdeps/unix/sysv/linux/stat.c: New file.
	* sysdeps/unix/sysv/linux/fstat.c: New file.
	* sysdeps/unix/sysv/linux/lstat.c: New file.
	* sysdeps/unix/sysv/linux/i386/stat.S: File removed.
	* sysdeps/unix/sysv/linux/i386/fstat.S: File removed.
	* sysdeps/unix/sysv/linux/i386/lstat.S: File removed.

Tue Oct 24 15:22:58 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/unix/sysv/linux/i386/sysdep.h (SYSCALL_ERROR_HANDLER):
	New macro.
	(PSEUDO): Use it instead of SYSCALL_PIC_SETUP and jmp syscall_error.

	* sysdeps/unix/sysv/linux/i386/sysdep.S (__syscall_error): Define
	only #ifndef PIC.

	* Makeconfig (built-program-cmd): New variable.
	* sunrpc/Makefile (rpcgen-cmd): Use $(built-program-cmd).
	* time/Makefile (zic-cmd): Likewise.

	* hurd/Makefile (user-interfaces): Add hurd/exec_startup.

	* sunrpc/Makefile (librpcsvc-no-lib-dep): New variable.
	* extra-lib.mk: If $(lib)-no-lib-dep is defined and MAKELEVEL>0,
	make `others' rather than `lib-noranlib' depend on the libraries.

	* sysdeps/unix/configure.in: Check for fchdir syscall.
	Improve sed script to allow / on rhs without / on lhs.

Thu Oct 19 03:47:32 1995  Ulrich Drepper  <drepper@ipd.info.uni-karlsruhe.de>

	* sysdeps/unix/sysv/linux/termbits.h: Don't define speed constants.

	* elf/rtld.c: Include _itoa.h from stdio-common instead of stdio.

	* sysdeps/unix/sysv/linux/select.S: New file.

Wed Oct 18 03:33:22 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/unix/sysv/linux/i386/sysdep.h (PSEUDO): Use
	SYSCALL_PIC_SETUP before jumping to syscall_error.
	* sysdeps/unix/i386/sysdep.h (SYSCALL_PIC_SETUP): New macro.
	(PSEUDO): Use it before jumping to syscall_error.
	* sysdeps/unix/i386/sysdep.S [! PIC]: Don't find GOT address;
	expect it in %ebx on entry.  Pop old %ebx value off stack after
	using it.

	* signal/signal.h [__USE_BSD] (_sys_siglist, sys_siglist): Declare
	them.

	* sysdeps/generic/_strerror.c: Declare _sys_errlist and _sys_nerr.

	* hurd/hurdlookup.c (__hurd_file_name_lookup_retry): For magic
	`fd/', pass the right pointer to strtol to parse the number.

Tue Oct 17 23:00:10 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/_strerror.c: Include stdio-common/_itoa.h instead
	of stdio/_itoa.h.

Tue Oct 17 19:51:17 1995  Ulrich Drepper  <drepper@ipd.info.uni-karlsruhe.de>

	* sysdeps/unix/sysv/linux/i386/stat.S [PIC] (__stat): Set GOT
	register %ebx before calling __xstat through PLT.

	* sysdeps/unix/sysv/linux/i386/sysdep.S: Fix typo in comment.

	* sysdeps/unix/sysv/linux/sigset.h: Remove file.

Tue Oct 17 01:21:21 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* hurd/hurdsock.c: Include stdio-common/_itoa.h instead of
	stdio/_itoa.h.
	* hurd/hurdlookup.c: Likewise.

	* hurd/hurd/signal.h: Declare hurd_preempt_signals and
	hurd_unpreempt_signals.

	* stdio/stdio.h: Declare __snprintf and __vsnprintf.

	* stdio-common/psignal.c: Translate signal description strings.
	* string/strsignal.c: Likewise.
	* sysdeps/generic/_strerror.c (_strerror_internal): Translate
	error strings.
	* sysdeps/mach/_strerror.c: Likewise.

	* stdio-common/snprintf.c (__snprintf): Renamed from snprintf;
	call __vsnprintf.
	(snprintf): Define as weak alias.
	* stdio/vsnprintf.c (__vsnprintf): Renamed from vsnprintf.
	(vsnprintf): Define as weak alias.

Mon Oct 16 03:22:37 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* Makerules (install-lib): Filter out %_pic.a; install only the
	linked shared objects.

	* locale/Makefile (aux): Add SYS_libc.
	* locale/SYS_libc.c: New file.
	* libc-symbols.h [! ASSEMBLER] (_): New macro.

	* configure.in (libc_cv_asm_set_directive): Link program into
	conftest instead of letting it default to a.out.

	* elf/Makefile (install-others): Add missing slash.

	* elf/ldd.sh.in: Prepend `./' to relative file names so ld.so
	won't search LD_LIBRARY_PATH.

	* Makefile (subdirs): Replace stdio with stdio-common and $(stdio).
	* configure.in: Grok arg --enable-libio.
	($stdio = libio): Define USE_IN_LIBIO.
	* config.h.in (USE_IN_LIBIO): Add #undef.
	* config.make.in (stdio): New variable, set by configure.
	* Makeconfig (stdio): New variable.
	* stdio.h [USE_IN_LIBIO]: Include libio/stdio.h instead of
	stdio/stdio.h.
	* stdio-common/Makefile: New file.
	* stdio/Makefile: Half the contents moved to stdio-common/Makefile.
	* stdio/_itoa.c: Moved to stdio-common.
	* stdio/_itoa.h: Moved to stdio-common.
	* stdio/asprintf.c: Moved to stdio-common.
	* stdio/bug1.c: Moved to stdio-common.
	* stdio/bug1.input: Moved to stdio-common.
	* stdio/bug2.c: Moved to stdio-common.
	* stdio/bug3.c: Moved to stdio-common.
	* stdio/bug4.c: Moved to stdio-common.
	* stdio/bug5.c: Moved to stdio-common.
	* stdio/bug6.c: Moved to stdio-common.
	* stdio/bug6.input: Moved to stdio-common.
	* stdio/bug7.c: Moved to stdio-common.
	* stdio/dprintf.c: Moved to stdio-common.
	* stdio/errnobug.c: Moved to stdio-common.
	* stdio/getline.c: Moved to stdio-common.
	* stdio/getw.c: Moved to stdio-common.
	* stdio/perror.c: Moved to stdio-common.
	* stdio/printf-parse.h: Moved to stdio-common.
	* stdio/printf-prs.c: Moved to stdio-common.
	* stdio/printf.c: Moved to stdio-common.
	* stdio/printf.h: Moved to stdio-common.
	* stdio/printf_fp.c: Moved to stdio-common.
	* stdio/psignal.c: Moved to stdio-common.
	* stdio/putw.c: Moved to stdio-common.
	* stdio/reg-printf.c: Moved to stdio-common.
	* stdio/scanf.c: Moved to stdio-common.
	* stdio/snprintf.c: Moved to stdio-common.
	* stdio/sprintf.c: Moved to stdio-common.
	* stdio/sscanf.c: Moved to stdio-common.
	* stdio/tempnam.c: Moved to stdio-common.
	* stdio/temptest.c: Moved to stdio-common.
	* stdio/test-fseek.c: Moved to stdio-common.
	* stdio/test-fwrite.c: Moved to stdio-common.
	* stdio/test-popen.c: Moved to stdio-common.
	* stdio/test_rdwr.c: Moved to stdio-common.
	* stdio/tmpfile.c: Moved to stdio-common.
	* stdio/tmpnam.c: Moved to stdio-common.
	* stdio/tst-fileno.c: Moved to stdio-common.
	* stdio/tst-printf.c: Moved to stdio-common.
	* stdio/tstgetln.c: Moved to stdio-common.
	* stdio/tstgetln.input: Moved to stdio-common.
	* stdio/tstscanf.c: Moved to stdio-common.
	* stdio/tstscanf.input: Moved to stdio-common.
	* stdio/vfprintf.c: Moved to stdio-common.
	* stdio/vfscanf.c: Moved to stdio-common.
	* stdio/vprintf.c: Moved to stdio-common.
	* stdio/xbug.c: Moved to stdio-common.
	* sysdeps/generic/Makefile (siglist.c rules): Do this in subdir
	stdio-common instead of stdio.
	* sysdeps/unix/Makefile (errlist.c rules): Likewise.
	* stdio-common/asprintf.c [USE_IN_LIBIO]: Call libio primitive
	function.
	* stdio-common/dprintf.c: Likewise.
	* stdio-common/printf.c: Likewise.
	* stdio-common/scanf.c: Likewise.
	* stdio-common/snprintf.c: Likewise.
	* stdio-common/sprintf.c: Likewise.
	* stdio-common/sscanf.c: Likewise.
	* stdio-common/vprintf.c: Likewise.

	* Makerules: Include $(+depfiles) directly instead of generating
	depend-$(subdir).
	(depend-$(subdir)): Target removed.
	(common-clean): Don't remove depend-$(subdir).

	* sysdeps/unix/sysv/linux/Makefile (rtld-installed-name): New variable.
	(config-LDFLAGS): Variable removed.

	* sysdeps/mach/hurd/getcwd.c: Use __file_name_lookup_under.
	* sysdeps/mach/hurd/bind.c: Likewise.
	* sysdeps/mach/hurd/access.c: Use new __hurd_file_name_lookup
	calling convention.

	* hurd/hurdexec.c: Undo last change (10 Oct 95).

Sun Oct 15 21:04:13 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* hurd/hurd/lookup.h: New file.
	* hurd/hurdlookup.c (__file_name_lookup_under): New function.
	(__hurd_file_name_lookup, __hurd_file_name_lookup_retry,
	__hurd_file_name_split): Rewritten to take callback functions for
	using any needed init or dtable port, instead of passing in crdir
	and cwdir ports.
	(__file_name_lookup, __file_name_split): Use new calling
	convention; pass _hurd_ports_use and __getdport as the callback
	functions.

	* sysdeps/mach/hurd/chroot.c: Use __file_name_lookup_under instead
	of __hurd_file_name_lookup.
	* sysdeps/mach/hurd/chdir.c: Likewise.
	* sysdeps/mach/hurd/fchdir.c: Likewise.
	* hurd/fchroot.c: Likewise.

	* stdlib/Makefile (mpn-found): Don't omit %.s.
	(mpn-copy-sysdep): Omit files in nonexistent directories.
	(copy-mpn): Commit files to CVS.
	* stdlib/gen-mpn-copy (translations): Update translations for GMP
	1.906.7.

	* configure.in (machine): Translate alpha* to alpha/&, hppa* to hppa/&.

Sat Oct 14 02:52:36 1995  Ulrich Drepper  <drepper@ipd.info.uni-karlsruhe.de>

	* malloc/malloc.c (_malloc_internal): Performance fix.  Move
	if statement out of loop.

	* stdio/_itoa.c, stdio/_itoa.h: Complete rewrite.  Much faster
	implementation using GMP functions.  Contributed by
	Torbjorn Granlund and Ulrich Drepper.

	* stdio/test_rdwr.c: Include <errno.h>.

	* sysdeps/i386/i586/Implies: New file.

	New highly optimized string functions for i[345]86.
	* sysdeps/i386/memchr.S, sysdeps/i386/memcmp.S: New files.
        * sysdeps/i386/stpcpy.S, sysdeps/i386/stpncpy.S: New files.
        * sysdeps/i386/strchr.S, sysdeps/i386/strcspn.S: New files.
        * sysdeps/i386/strpbrk.S, sysdeps/i386/strrchr.S: New files.
        * sysdeps/i386/strspn.S, sysdeps/i386/i486/strcat.S: New files.
        * sysdeps/i386/i486/strlen.S, sysdeps/i386/i586/strchr.S: New files.
        * sysdeps/i386/i586/strlen.S: New file.
	* sysdeps/i386/memchr.c: Removed.  There is now an assembler version.

	* sysdeps/i386/i586/memcopy.h (WORD_COPY_BWD): Parameters did
	not correspond to used values.

	* sysdeps/unix/sysv/linux/nfs/nfs.h: New file.  Simply a wrapper
        around a kernel header file.
	* sysdeps/unix/sysv/linux/Dist: Add it.
	* sysdeps/unix/sysv/linux/Makefile [$(subdir)=sunrpc] (headers):
	Likewise.

	* sysdeps/unix/sysv/linux/local_lim.h: Rewrite.  Instead of
        defining ourself we use a kernel header file.

	* sysdeps/unix/sysv/linux/i386/sysdep.h (DO_CALL): Optimize system
        call handler for i586.

	* sysdeps/unix/sysv/linux/sys/param.h: Add copyright and clean up.

Thu Oct 12 15:45:32 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* hurd/hurd.h (file_name_lookup_under): Declare it.
	* hurd/Makefile (headers): Add hurd/lookup.h.

	* hurd/hurdinit.c (_hurd_ports_use): New function.
	* hurd/hurd.h (_hurd_ports_use): Declare it.
	(hurd_invoke_translator, hurd_file_name_lookup, hurd_file_name_split,
	hurd_file_name_lookup_retry): Remove these decls.
	* hurd/Makefile (routines): Remove invoke-trans.

Wed Oct 11 00:00:00 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/i386/dl-machine.h (elf_machine_rel): Use +=, not =, to
	apply R_386_PC32 reloc.

	* Makeconfig (config-LDFLAGS): Add missing slash.

	* sysdeps/mach/hurd/profil.c (fork_profil): Only call
	update_waiter if profiling was enabled in the parent.

	* csu/initfini.c: Don't pass -f flag to cp.

Tue Oct 10 23:08:53 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* Makerules (build-shlib): Pass -rpath and -rpath-link options.
	(LDFLAGS-c.so): Don't pass -dynamic-linker here.
	* Makeconfig (+link): Pass $(sysdep-LDFLAGS).
	(link-libc): Pass -rpath and -rpath-link options.

	* MakeTAGS (all-dirs): Omit CVS directories.
	Specify vpath directives to find source files in $(all-dirs).
	(sources, headers): Append sources and headers from $(all-dist) to
	these.
	(all-dist): Filter them out of this.
	(all-headers, all-sources): Use $(shell find ...) instead of
	$(wildcard ...).

	* sysdeps/mach/hurd/Makefile (sysdep-LDFLAGS): New variable; pass
	-rpath-link.

	* hurd/hurdexec.c: Pass poly and dealloc args to __file_exec.

	* elf/Makefile (install-others): Add missing $.

Mon Oct  9 02:54:14 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* mach/Makefile ($(objpfx)errsystems.c): Rule reenabled.

	* Makeconfig (config-LDFLAGS): Define to
	-Wl-dynamic-linker=$(libdir)$(rtld-installed-name).
	(rtld-installed-name): New variable.
	* elf/Makefile (install-lib): Variable removed.
	(install-others): Define this instead, to
	$(libdir)(rtld-installed-name).
	($(libdir)(rtld-installed-name)): New target; install from ld.so.

	* elf/ldd.sh.in: New file.
	* elf/Makefile (distribute): Add ldd.sh.in.
	(install-bin): Add ldd.
	($(objpfx)ldd: ldd.sh.in): New rule.

	* sysdeps/mach/hurd/dl-sysdep.c: Use __hurd_fail throughout.
	* hurd/hurd.h (__hurd_fail): Replace macro with inline function.
	Translate some Mach errors to Hurd errors.

	* elf/rtld.c (dl_main): Under --list, print msg if executable is
	statically linked.

	* elf/dl-load.c (_dl_map_object_from_fd): Rewrote program header
	table processing.

Sat Oct  7 01:25:48 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/stub/machine-gmon.h: Add #error.

Fri Oct  6 01:49:48 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* elf/dynamic-link.h (elf_get_dynamic_info): If DYN is null, don't
	examine it.

Fri Sep 29 03:43:51 1995  Paul Eggert  <eggert@twinsun.com>

	Rewrite mktime from scratch for performance, and for correctness
	in the presence of leap seconds.

	* time/mktime.c	(ydhms_tm_diff, not_equal_tm, print_tm, check_result):
	New functions.
	(LEAP_SECONDS_POSSIBLE, CHAR_BIT, INT_MIN, INT_MAX,
	TIME_T_MIN, TIME_T_MAX, TM_YEAR_BASE, EPOCH_YEAR): New macros.
	<limits.h>, <stdlib.h>: New #includes.
	(main): Support tests with given broken-down value; support benchmarks.
	(__mon_lengths, debugging_enabled, printtm, dist_tm, doit,
	do_normalization, normalize, BAD_STRUCT_TM, SKIP_VALUE,
	<ctype.h>): Remove.

	* time/time.h, time/mktime.c (__mktime_internal): New offset arg.
	* time/mktime.c (mktime), time/timegm.c (timegm): Use it.

	* time/mktime.c (__mon_yday): New variable; replaces `__mon_lengths'.
	time/offtime.c (__offtime), time/tzset.c (compute_change): Use it.

	* time/offtime.c (__offtime): Remove useless assignment
	`tp->tm_isdst = -1'.

	* manual/maint.texi: Update credits.

Fri Oct  6 00:28:53 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/unix/common/readv.S: Moved to sysdeps/unix/bsd.
	* sysdeps/unix/common/writev.S: Moved to sysdeps/unix/bsd.
	* sysdeps/unix/sysv/linux/readv.c: File removed.
	* sysdeps/unix/sysv/linux/writev.c: File removed.
	* sysdeps/unix/configure.in: Check for readv and writev syscalls.

	* sysdeps/unix/configure.in: If eval doesn't set $unix_srcname,
	set it to $unix_syscall instead of $unix_function.

Thu Oct  5 00:59:58 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* elf/rtld.c (dl_main): Grok --list flag.
	* sysdeps/mach/hurd/dl-sysdep.c (_dl_sysdep_start): Ignore -- args.

Wed Oct  4 00:21:03 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/dl-sysdep.c (_dl_sysdep_message): New function.
	* sysdeps/generic/dl-sysdep.c (_dl_sysdep_message): New function.
	* elf/link.h (_dl_sysdep_message): Declare it.

	* sysdeps/unix/Makefile ($(common-objpfx)ioctls): Remove NULL from
	the list.

	* time/northamerica: Corrections to Canada data from ADO 95i.

	* sysdeps/unix/sysv/linux/Makefile (headers): Don't append to this
	unconditionally.  In socket subdir, append sys/socketcall.h; in
	time subdir, append sys/timex.h.
	(config-LDFLAGS): New variable.
	* sysdeps/unix/sysv/linux/Dist: New file.
	* Makeconfig (+link): Pass $(config-LDFLAGS) before $(LDFLAGS).

	* sysdeps/generic/stpncpy.c: Don't increment DEST when zero-filling.

	* elf/dlopen.c (dlopen): Don't pass USER_ENTRY arg to _dl_map_object.

Sat Sep 30 11:47:05 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/dl-sysdep.c (_dl_sysdep_start): If started by
	kernel with args on stack, point _dl_hurd_data at zero data
	instead of garbage.  When ld.so run as program, grok args
	-LIB=MEMOBJ and pre-load shared object files found in memory
	objects loaded by the boot loader.

	* elf/link.h (struct link_map): New member `l_entry'.
	(_dl_map_object, _dl_map_object_from_fd): Remove last arg ENTRY_POINT.
	* elf/dl-load.c (_dl_map_object, _dl_map_object_from_fd): Remove
	last arg ENTRY_POINT.  Store the entry point location in the
	`l_entry' member of the new map.
	* elf/rtld.c (dl_main): Don't pass USER_ENTRY arg to
	_dl_map_object.  When run as program, set *USER_ENTRY to L->l_entry.
	* elf/dl-init.c (_dl_init_next): Don't pass ENTRY_POINT arg to
	_dl_map_object.

	* posix/tstgetopt.c, posix/tstgetopt.args: Test long options too.

	* sysdeps/unix/sysv/linux/i386/init-first.c (init): Save, set, and
	restore %ebx by hand for personality syscall.
	GCC cannot deal with spilling the dedicated GOT register.

	* misc/Makefile (routines): Add mntent, which was somehow omitted.

Fri Sep 29 15:07:10 1995  Ulrich Drepper  <drepper@ipd.info.uni-karlsruhe.de>

 	* sysdeps/unix/sysv/linux/adjtime.c (__adjtime):
 	Change name of field `mode' in `struct timex' to `modes'.
	Linux-1.3.28 updates this name according to RFC 1489.

Thu Sep 28 13:05:54 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	Merge new message handling code from GNU gettext, by Drepper.
	* intl: New directory.
	* Makefile (subdirs): Add intl.

	* sysdeps/generic/dl-sysdep.c (_dl_sysdep_start): Return
	USER_ENTRY instead of storing it on our stack.

	* elf/rtld.c (rtld_command): Variable removed.
	(_dl_skip_args): New variable.
	(dl_main): Increment _dl_skip_args instead of setting rtld_command.
	If the link_map for the executable itself is not first in the chain,
	make it so.
	* sysdeps/i386/dl-machine.h (RTLD_START): Use _dl_skip_args as
	count of args to skip.

Thu Sep 28 09:20:04 1995  Ulrich Drepper  <drepper@gnu.ai.mit.edu>

	* stdlib/strtod.c (STRTOF): Fix handling of numbers with lots of
	leading zeroes.

Wed Sep 27 00:27:25 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/getcwd.c (__getcwd): Renamed from getcwd.
	(getcwd): Define as weak alias.
	* sysdeps/posix/getcwd.c: Likewise.
	* sysdeps/stub/getcwd.c: Likewise.
	* posix/unistd.h: Declare __getcwd.

	* string/string.h: Declare __strcasecmp.
	* sysdeps/generic/strcasecmp.c (__strcasecmp): Renamed from
	strcasecmp.
	(strcasecmp): Define as weak alias.

	* string/string.h: Declare __stpcpy.
	* sysdeps/generic/stpcpy.c (__stpcpy): Renamed from stpcpy.
	(stpcpy): Define as weak alias.

	* sysdeps/unix/sysv/linux/Implies: Add unix/common.

	* sysdeps/unix/i386/sysdep.h [HAVE_ELF] (ASM_TYPE_DIRECTIVE):
	Don't use `type' for arg name, since we are using it as a keyword
	in the rhs.

	* sysdeps/unix/configure.in: Check for syscalls getpriority,
	setpriority, getrlimit, setrlimit.

	* sysdeps/posix/truncate.c: Include fcntl.h.

	* sysdeps/generic/getdomain.c: Include string.h for strncpy decl.

	* sysdeps/stub/getpriority.c: Don't include obsolete gnu-stabs.h;
	use new stub_warning syntax.
	* sysdeps/stub/setpriority.c: Likewise.
	* sysdeps/stub/__longjmp.c: Likewise.
	* sysdeps/stub/_exit.c: Likewise.
	* sysdeps/stub/accept.c: Likewise.
	* sysdeps/stub/acos.c: Likewise.
	* sysdeps/stub/alarm.c: Likewise.
	* sysdeps/stub/asin.c: Likewise.
	* sysdeps/stub/atan2.c: Likewise.
	* sysdeps/stub/bind.c: Likewise.
	* sysdeps/stub/cbrt.c: Likewise.
	* sysdeps/stub/chroot.c: Likewise.
	* sysdeps/stub/closedir.c: Likewise.
	* sysdeps/stub/connect.c: Likewise.
	* sysdeps/stub/cos.c: Likewise.
	* sysdeps/stub/cosh.c: Likewise.
	* sysdeps/stub/ctermid.c: Likewise.
	* sysdeps/stub/cuserid.c: Likewise.
	* sysdeps/stub/defs.c: Likewise.
	* sysdeps/stub/exp.c: Likewise.
	* sysdeps/stub/fmod.c: Likewise.
	* sysdeps/stub/frexp.c: Likewise.
	* sysdeps/stub/fsync.c: Likewise.
	* sysdeps/stub/getcwd.c: Likewise.
	* sysdeps/stub/getenv.c: Likewise.
	* sysdeps/stub/gethostid.c: Likewise.
	* sysdeps/stub/getlogin.c: Likewise.
	* sysdeps/stub/getpeername.c: Likewise.
	* sysdeps/stub/getrlimit.c: Likewise.
	* sysdeps/stub/getsockname.c: Likewise.
	* sysdeps/stub/getsockopt.c: Likewise.
	* sysdeps/stub/listen.c: Likewise.
	* sysdeps/stub/log.c: Likewise.
	* sysdeps/stub/log10.c: Likewise.
	* sysdeps/stub/mkfifo.c: Likewise.
	* sysdeps/stub/morecore.c: Likewise.
	* sysdeps/stub/nice.c: Likewise.
	* sysdeps/stub/nlist.c: Likewise.
	* sysdeps/stub/opendir.c: Likewise.
	* sysdeps/stub/pipestream.c: Likewise.
	* sysdeps/stub/ptrace.c: Likewise.
	* sysdeps/stub/putenv.c: Likewise.
	* sysdeps/stub/readdir.c: Likewise.
	* sysdeps/stub/reboot.c: Likewise.
	* sysdeps/stub/recv.c: Likewise.
	* sysdeps/stub/recvfrom.c: Likewise.
	* sysdeps/stub/rename.c: Likewise.
	* sysdeps/stub/rewinddir.c: Likewise.
	* sysdeps/stub/seekdir.c: Likewise.
	* sysdeps/stub/send.c: Likewise.
	* sysdeps/stub/sendto.c: Likewise.
	* sysdeps/stub/setegid.c: Likewise.
	* sysdeps/stub/seteuid.c: Likewise.
	* sysdeps/stub/setgroups.c: Likewise.
	* sysdeps/stub/sethostid.c: Likewise.
	* sysdeps/stub/sethostname.c: Likewise.
	* sysdeps/stub/setjmp.c: Likewise.
	* sysdeps/stub/setrlimit.c: Likewise.
	* sysdeps/stub/setsockopt.c: Likewise.
	* sysdeps/stub/shutdown.c: Likewise.
	* sysdeps/stub/signal.c: Likewise.
	* sysdeps/stub/sigsuspend.c: Likewise.
	* sysdeps/stub/sin.c: Likewise.
	* sysdeps/stub/sinh.c: Likewise.
	* sysdeps/stub/socket.c: Likewise.
	* sysdeps/stub/socketpair.c: Likewise.
	* sysdeps/stub/sqrt.c: Likewise.
	* sysdeps/stub/sync.c: Likewise.
M sysd-stdio.c
	* sysdeps/stub/system.c: Likewise.
	* sysdeps/stub/tan.c: Likewise.
	* sysdeps/stub/tanh.c: Likewise.
	* sysdeps/stub/tcdrain.c: Likewise.
	* sysdeps/stub/tcflow.c: Likewise.
	* sysdeps/stub/tcgetpgrp.c: Likewise.
	* sysdeps/stub/tcsendbrk.c: Likewise.
	* sysdeps/stub/tcsetattr.c: Likewise.
	* sysdeps/stub/tcsetpgrp.c: Likewise.
	* sysdeps/stub/telldir.c: Likewise.
	* sysdeps/stub/tempname.c: Likewise.
	* sysdeps/stub/ttyname.c: Likewise.
	* sysdeps/stub/ttyname_r.c: Likewise.
	* sysdeps/stub/utime.c: Likewise.

	* gmon/gmon.c (moncontrol): Don't cast buffer arg to profil.

	* time/mktime.c (localtime_r): Use 0 instead of NULL.

	* config.make.in (AS): New variable; set to `$(CC) -c'.

	* posix/unistd.h [__USE_BSD]: Declare profil.

	* elf/dl-load.c (_dl_map_object_from_fd): New function, broken out
	of _dl_map_object.
	(_dl_map_object): Call it.
	* elf/link.h (_dl_map_object_from_fd): Declare it.

Tue Sep 26 16:50:17 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* locale/libintl.h: Rewritten by Ulrich Drepper for use with GNU
	gettext code.

	* sysdeps/unix/sysv/linux/sys/param.h: New file.
	* sysdeps/unix/sysv/linux/Subdirs: File removed.

	* libc-symbols.h (_LIBC): Define to 1, not just empty.

	* gmon: New directory of profiling code, incorporated from
	4.4BSD-Lite and modified.
	* sysdeps/i386/machine-gmon.h: New file.
	* sysdeps/stub/machine-gmon.h: New file.
	* sysdeps/mach/hurd/profil.c: New file.
	* sysdeps/stub/profil.c: New file.
	* sysdeps/unix/bsd/profil.S: New file.
	* Makefile (subdirs): Add gmon.
	* csu/gmon-start.c: New file.
	* csu/Makefile (extra-objs): Add gmon-start.o,
	g$(start-installed-name).
	(install-lib, omit-deps): Add g$(start-installed-name).
	($(objpfx)g$(start-installed-name)): New target.

Fri Sep 22 14:24:25 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/Makefile: Elide sunrpc from $(subdirs) for the
	time being.

Thu Sep 21 00:03:53 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/unix/configure.in: Check for `profil' syscall.

	* manual/Makefile (infodir, prefix, INSTALL, INSTALL_DATA): Variables
 	removed.

	* time/africa, time/asia, time/europe, time/northamerica,
	time/yearistype: New data from ADO 95h.

	* Makerules (build-shlib): Use $(@F:lib%.so=%) in place of
	$(notdir $*), so it wins for the explicit libc.so rule as well as the
	pattern rule.

	* sysdeps/stub/sys/sem_buf.h (union semun): New type.

	* sysdeps/mach/hurd/i386/init-first.c (init1) [PIC]: Call
	__libc_global_ctors.
	* sysdeps/i386/init-first.c: Rewritten.
	* sysdeps/unix/sysv/linux/i386/init-first.S: File removed.
	* sysdeps/unix/sysv/linux/i386/init-first.c: New file.

	* sysdeps/unix/sysv/linux/i386/fpu_control.h: Fix name in decl of
	___fpu_control.

	* Makerules (build-shlib): New canned sequence, broken out of
	lib%.so rule.  Link in $^ instead of just $<.
	(lib%.so: lib%_pic.a): Use it.
	(libc.so): New target; use $(build-shlib) for cmds, but also depend
	on soinit.so first and sofini.so last.

	* elf/soinit.c: New file.
	* elf/sofini.c: New file.
	* elf/Makefile (distribute): Add soinit.c and sofini.c.
	(extra-objs): Add soinit.so and sofini.so.

	* sysvipc/sys/shm.h (shmat): Fix return type to char *.
	* sysdeps/stub/sys/ipc_buf.h (key_t): Type removed.

	* misc/syslog.c (vsyslog): Rewritten using open_memstream to
	dynamically allocate buffers.

	* Makerules (install-lib-nosubdir): Make this, rather than
	install-no-libc.a, depend on the installed shared libraries.

Wed Sep 20 18:02:03 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* locale/locale.c: Include errno.h.
	* locale/localedef.c: Likewise.

Tue Sep 19 00:02:06 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* Makefile (distclean-1): Remove config.cache, config.log, config.h.
	(parent-mostlyclean): Remove all flavors of the parent library.

	* misc/mntent.c (getmntent): Skip multiple whitespace chars
	between fields.

	* hurd/hurdstartup.c (_hurd_startup): If RPC returns
	EXEC_STACK_ARGS flag, get args from stack.
	If args on stack but have info from RPC, relocate args on stack to make
	space for struct hurd_startup_data.

Mon Sep 18 15:06:00 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* elf/dl-object.c: Include errno.h.
	* posix/execvp.c: Likewise.
	* dirent/scandir.c: Likewise.
	* sysdeps/posix/system.c: Likewise.
	* sysdeps/generic/setenv.c: Likewise.
	* stdlib/msort.c: Likewise.
	* stdio/memstream.c: Likewise.
	* stdio/fclose.c: Likewise.
	* stdio/getdelim.c: Likewise.
	* stdio/setvbuf.c: Likewise.
	* sysdeps/ieee754/ldexp.c: Likewise.
	* locale/locfile-parse.c: Likewise.

	* stdlib/lcong48_r.c: Don't check for null argument; let it fault.
	* stdlib/seed48_r.c: Likewise.
	* stdlib/srand48_r.c: Likewise.
	* stdlib/jrand48_r.c: Likewise.
	* stdlib/nrand48_r.c: Likewise.

	* Makeconfig (+gccwarn): Remove -Wbad-function-cast, which seems
	to be useless.

Mon Sep 18 12:39:22 1995  Paul Eggert  <eggert@twinsun.com>

	* mktime.c (localtime_r): Add substitute if the system doesn't
	provide one.

Mon Sep 18 14:39:20 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* time/gmtime.c (gmtime_r): Define as weak alias.
	* time/localtime.c (localtime_r): Define as weak alias.
	* time/time.h [__USE_REENTRANT] (gmtime_r, localtime_r): Declare them.

	* errno.h: Only define _ERRNO_H #ifndef __need_Emath.
	#undef __need_Emath after including errnos.h.
	[_ERRNO_H]: Protect decls with this.

Sun Sep 17 08:22:12 1995  Paul Eggert  <eggert@twinsun.com>

	Fix mktime so that it does not write over localtime's returned value.
	* localtime.c (__localtime_r): New function, with extra arg
	specifying where to store result.
	(localtime): Use it.
	(_tmbuf): New var.
	* gmtime.c (__gmtime_r, gmtime, _tmbuf): Likewise.
	* mktime.c (__mktime_internal):	Conversion function is now
	__localtime_r style, not localtime style.
	(mktime): Pass __localtime_r, not localtime.
	* timegm.c (timegm): Pass __gmtime_r, not gmtime.
	* offtime.c (__offtime): New arg specifying where to store result.
	* time.h (__mktime_internal, __offtime): Adjust decls accordingly.
	(__gmtime_r, __localtime_r): New decls.

	* time/localtime.c: <stddef.h>, <ctype.h>, <stdio.h>,
	<stdlib.h>, <string.h>: Remove includes.
	<errno.h>: Add include.

	* time/mktime.c, time/time.h, time/timegm.c (__mktime_internal):
	Renamed from _mktime_internal to avoid namespace pollution.

	* time/gmtime.c: Clear tm_isdst.

Mon Sep 18 01:58:40 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* misc/efgcvt_r.c (ecvt_r, fcvt_r): Last arg is size_t, not int.
	* stdlib/stdlib.h (ecvt_r, fcvt_r): Fix type of last arg: make it
	size_t.

	* sysdeps/mach/hurd/fpathconf.c: Call __io_pathconf instead of
	__file_pathconf.
	* sysdeps/mach/hurd/pathconf.c: Likewise.

	* Makefile (subdirs): Add sysvipc.

	* stdlib/srand48_r.c (srand48_r): Use UL suffix for huge constant.
	* stdlib/drand48-iter.c (__drand48_iterate): Likewise.

Sun Sep 17 18:29:13 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* hurd/hurdlookup.c (__hurd_file_name_lookup_retry): Call
	 __file_set_size instead of __file_truncate.

	* features.h (__USE_REENTRANT): New macro.

	* sysdeps/mach/hurd/truncate.c: Call __file_set_size instead of
	__file_truncate.
	* sysdeps/mach/hurd/ftruncate.c: Likewise.

	* sysdeps/unix/sysv/linux/dl-machine.h: File removed.

Sat Sep 16 17:47:19 1995  Ulrich Drepper  <drepper@ipd.info.uni-karlsruhe.de>

	* elf/elf.h (AT_GID): Fix typo: Read -> Real.

	* misc/efgvt_r.c: New file.  Reentrant version of [efg]cvt functions.
	* misc/efgcvt.c: Rewrite to use reentrant functions.
	* misc/search.h: Many decls for hsearch functions.
	* misc/hsearch_r.c: New file.  Reentrant version of functions from
	hsearch family.
	* misc/hsearch.c, misc/tsearch.c: New files.
	* misc/Makefile (routines): Add efgcvt_r, hsearch_r, hsearch, tsearch.

	* posix/unistd.h (ttyname_r): Add prototype for new function.

	* stdlib/drand48_r.c, stdlib/erand48_r.c, stdlib/jrand48_r.c,
	stdlib/lrand48_r.c, stdlib/mrand48_r.c, stdlib/nrand48_r.c,
	stdlib/seed48_r.c, stdlib/srand48_r.c, stdlib/lcong48_r.c,
	stdlib/drand48-iter.c: New files implementing reentrant versions
	of functions from drand48 family.
	* stdlib/seed48.c, stdlib/drand48.c, stdlib/erand48.c,
	stdlib/jrand48.c, stdlib/lrand48.c, stdlib/mrand48.c,
	stdlib/nrand48.c, stdlib/srand48.c, stdlib/lcong48.c:
	Rewrite to use reentrant versions.
	* stdlib/a64l.c, stdlib/l64a.c: New files.  Implement a64l()
	and l64a() functions from SysV library.
	* stdlib/Makefile (routines): Add drand48_r, erand48_r, lrand48_r,
	nrand48_r, mrand48_r, jrand48_r, srand48_r, seed48_r, lcong48_r,
	drand48-iter, a64l, l64a.
	* stdlib/stdlib.h: Declare them.

	* stdlib/random_r.c: New file.  Reentrant version of functions
	from random family.
	* stdlib/stdlib.h: Declare them.
	* stdlib/random.c: Rewrite to use reentrant functions.

	* string/strerror_r.c: New file.  Reentrant version.
	* string/strerror.c: Change for new _strerror_internal form.
	* string/Makefile (routines): Add strerror_r.

	* sysdeps/generic/dl-sysdep.c (_dl_sysdep_start): Set default
	value of user_entry to `_start'.
	Close AT_ENTRY case with `break'.

	* sysdeps/generic/strstr.c: New and much faster implementation
	by Stephen R. van den Berg.

	* sysdeps/generic/_strerror.c: _strerror_internal now takes
	three argument and has and explicit buffer length.
	* sysdeps/mach/_strerror.c: Change for new interface with three
	arguments.
	* stdio/perror.c, stdio/vfprintf.c: Callers changed.

	* sysdeps/mach/hurd/ttyname_r.c: New file.  Reentrant version.
	* sysdeps/posix/ttyname_r.c: New file.  Reentrant version.
	* sysdeps/stub/ttyname_r: New file.  Define as dummy function.

	* sysdeps/posix/utimes.c: Include <utime.h> for prototype.
	(utimes): First parameter to utime must be file, not path.

	* sysdeps/posix/sysconf.c (__sysconf): Test for CLK_TCK in case
	_SC_CLK_TCK and return it when available.
	Test for STREAM_MAX in case _SC_STREAM_MAX and return it when
	available.
	Add case for _SC_2_LOCALEDEF which is now available.

	* posix/sys/types.h [__USE_SVID] (key_t): New type.
	* sysvipc/Makefile, sysvipc/ftok.c, sysvipc/sys/ipc.h,
	sysvipc/sys/msg.h, sysvipc/sys/sem.h, sysvipc/sys/shm.h,
	sysdeps/stub/sys/msq_buf.h, sysdeps/stub/sys/sem_buf.h,
	sysdeps/stub/sys/shm_buf.h, sysdeps/stub/sys/ipc_buf.h,
	sysdeps/stub/semctl.c, sysdeps/stub/semget.c, sysdeps/stub/semop.c,
	sysdeps/stub/shmat.c, sysdeps/stub/shmctl.c, sysdeps/stub/shmdt.c,
	sysdeps/stub/shmget.c, sysdeps/stub/msgctl.c, sysdeps/stub/msgget.c,
	sysdeps/stub/msgrcv.c, sysdeps/stub/msgsnd.c: New files.
	Add implementation of System V IPC.

Fri Sep 15 21:34:28 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* hurd/hurdsig.c: Include <hurd/crash.h> in place of <hurd/core.h>.
	(write_corefile): Call __crash_dump_task instead of __core_dump_task.
	Use envariable CRASHSERVER instead of CORESERVER.
	* hurd/Makefile (user-interfaces): Replace hurd/core with hurd/crash.

Tue Sep 12 14:30:07 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* misc/mntent.c: New file.
	* misc/mntent.h: New file.
	* misc/Makefile (headers): Added mntent.h.
	(routines): Added mntent.
	* misc/fstab.c: Rewritten using mntent functions.

Mon Sep 11 14:00:14 1995  Roland McGrath  <roland@whiz-bang.gnu.ai.mit.edu>

	* posix/glob.c (glob): Comment fix.

Fri Sep  8 16:25:22 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* libc-symbols.h [HAVE_ELF] (symbol_set_declare): Declare the
	symbols weak.

	* conf/portability.h (NEED_INETADDR, NEED_INETATON): Define to 1,
	not empty.

Fri Sep  8 16:32:12 1995  Ulrich Drepper  <drepper@gnu.ai.mit.edu>

        * sysdeps/unix/sysv/linux/Implies,
        sysdeps/unix/sysv/linux/Makefile, sysdeps/unix/sysv/linux/Subdirs,
        sysdeps/unix/sysv/linux/accept.S, sysdeps/unix/sysv/linux/adjtime.c,
        sysdeps/unix/sysv/linux/adjtimex.S, sysdeps/unix/sysv/linux/bind.S,
        sysdeps/unix/sysv/linux/connect.S, sysdeps/unix/sysv/linux/direct.h,
        sysdeps/unix/sysv/linux/dl-machine.h, sysdeps/unix/sysv/linux/errnos.h,
        sysdeps/unix/sysv/linux/fork.S, sysdeps/unix/sysv/linux/gethostid.c,
        sysdeps/unix/sysv/linux/gethostname.C,
        sysdeps/unix/sysv/linux/getpeername.S,
        sysdeps/unix/sysv/linux/getpgid.S, sysdeps/unix/sysv/linux/getpgrp.S,
	sysdeps/unix/sysv/linux/getsockname.S,
	sysdeps/unix/sysv/linux/getsockopt.S, sysdeps/unix/sysv/linux/gtty.S,
	sysdeps/unix/sysv/linux/listen.S, sysdeps/unix/sysv/linux/local_lim.h,
	sysdeps/unix/sysv/linux/madvise.c, sysdeps/unix/sysv/linux/msgctl.c,
	sysdeps/unix/sysv/linux/msgget.c, sysdeps/unix/sysv/linux/msgrcv.c,
	sysdeps/unix/sysv/linux/msgsnd.c, sysdeps/unix/sysv/linux/pipe.S,
	sysdeps/unix/sysv/linux/poll.c, sysdeps/unix/sysv/linux/readv.c,
	sysdeps/unix/sysv/linux/recv.S, sysdeps/unix/sysv/linux/recvfrom.S,
	sysdeps/unix/sysv/linux/recvmsg.S, sysdeps/unix/sysv/linux/semctl.c,
	sysdeps/unix/sysv/linux/semget.c, sysdeps/unix/sysv/linux/semop.c,
	sysdeps/unix/sysv/linux/send.S, sysdeps/unix/sysv/linux/sendmsg.S,
	sysdeps/unix/sysv/linux/sendto.S, sysdeps/unix/sysv/linux/setegid.c,
	sysdeps/unix/sysv/linux/seteuid.c, sysdeps/unix/sysv/linux/sethostid.c,
	sysdeps/unix/sysv/linux/setpgid.c, sysdeps/unix/sysv/linux/setpgrp.c,
	sysdeps/unix/sysv/linux/setsid.S, sysdeps/unix/sysv/linux/setsockopt.S,
	sysdeps/unix/sysv/linux/settimeofday.S,
	sysdeps/unix/sysv/linux/shmat.c, sysdeps/unix/sysv/linux/shmctl.c,
	sysdeps/unix/sysv/linux/shmdt.c, sysdeps/unix/sysv/linux/shmget.c,
	sysdeps/unix/sysv/linux/shutdown.S,
	sysdeps/unix/sysv/linux/sigaction.S, sysdeps/unix/sysv/linux/signal.S,
	sysdeps/unix/sysv/linux/sigpending.S, sysdeps/unix/sysv/linux/sigset.h,
	sysdeps/unix/sysv/linux/sockaddrcom.h,
	sysdeps/unix/sysv/linux/socketpair.S, sysdeps/unix/sysv/linux/speed.c,
	sysdeps/unix/sysv/linux/statbuf.h, sysdeps/unix/sysv/linux/stty.S,
	sysdeps/unix/sysv/linux/syscall.h, sysdeps/unix/sysv/linux/sysconf.c,
	sysdeps/unix/sysv/linux/tcdrain.c, sysdeps/unix/sysv/linux/tcflow.c,
	sysdeps/unix/sysv/linux/tcflush.c, sysdeps/unix/sysv/linux/tcgetattr.c,
	sysdeps/unix/sysv/linux/tcsetattr.c,
	sysdeps/unix/sysv/linux/termbits.h, sysdeps/unix/sysv/linux/ualarm.c,
	sysdeps/unix/sysv/linux/ulimit.c, sysdeps/unix/sysv/linux/usleep.c,
	sysdeps/unix/sysv/linux/utsnamelen.h, sysdeps/unix/sysv/linux/vfork.c,
	sysdeps/unix/sysv/linux/wait.c, sysdeps/unix/sysv/linux/wait4.S,
	sysdeps/unix/sysv/linux/waitpid.c, sysdeps/unix/sysv/linux/writev.c:
	New Linux/ELF specific, architecture independent files.
	* sysdeps/unix/sysv/linux/i386/Dist,
	sysdeps/unix/sysv/linux/i386/Makefile,
	sysdeps/unix/sysv/linux/i386/brk.S,
	sysdeps/unix/sysv/linux/i386/fcntlbits.h,
	sysdeps/unix/sysv/linux/i386/fpu_control.c,
	sysdeps/unix/sysv/linux/i386/fpu_control.h,
	sysdeps/unix/sysv/linux/i386/fstat.S,
	sysdeps/unix/sysv/linux/i386/fxstat.S,
	sysdeps/unix/sysv/linux/i386/ieee_fpu.c,
	sysdeps/unix/sysv/linux/i386/init-first.S,
	sysdeps/unix/sysv/linux/i386/ipc.S,
	sysdeps/unix/sysv/linux/i386/lstat.S,
	sysdeps/unix/sysv/linux/i386/lxstat.S,
	sysdeps/unix/sysv/linux/i386/mknod.S,
	sysdeps/unix/sysv/linux/i386/mmap.S,
	sysdeps/unix/sysv/linux/i386/sbrk.S,
	sysdeps/unix/sysv/linux/i386/setfpucw.c,
	sysdeps/unix/sysv/linux/i386/signum.h,
	sysdeps/unix/sysv/linux/i386/socket.S,
	sysdeps/unix/sysv/linux/i386/stat.S,
	sysdeps/unix/sysv/linux/i386/syscall.S,
	sysdeps/unix/sysv/linux/i386/sysdep.S,
	sysdeps/unix/sysv/linux/i386/sysdep.h,
	sysdeps/unix/sysv/linux/i386/xmknod.S,
	sysdeps/unix/sysv/linux/i386/xstat.S:
	New Linux i386/ELF specific files.
	* sysdeps/unix/sysv/linux/sys/ipc_buf.h,
	sysdeps/unix/sysv/linux/sys/mman.h,
	sysdeps/unix/sysv/linux/sys/msq_buf.h,
	sysdeps/unix/sysv/linux/sys/sem_buf.h,
	sysdeps/unix/sysv/linux/sys/shm_buf.h,
	sysdeps/unix/sysv/linux/sys/socketcall.h,
	sysdeps/unix/sysv/linux/sys/timex.h:
	New Linux/ELF specific, architecture independent header files.
	* sysdeps/unix/sysv/sysv4/linux: Tree removed.

Thu Sep  7 17:05:13 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* stdlib/msort.c (msort_with_tmp): Fixed alignment test.  B1 and
	B2 are always congruent; just test that B1 is aligned.

Wed Sep  6 19:41:10 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* elf/dl-lookup.c (_dl_lookup_symbol): Test WEAK_VALUE.s rather
	than WEAK_VALUE.a to see if a weak value has been set.  A valid
	weak value may set WEAK_VALUE.a to 0.

Fri Sep  1 16:16:12 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/i386/longjmp-ts.c: Use new array format for
	jmp_buf.

	* libc-symbols.h (link_warning): Take new first arg SYMBOL; ask
	for a warning on references to that specific symbol, not the
	entire containing object file.
	(stub_warning): Pass symbol name to link_warning.
	* stdio/gets.c: Pass function name in link_warning invocation.

	* hurd/intr-msg.c: Treat apparent EINTR return from msg trap like
	MACH_SEND_INTERRUPTED.  That indicates interrupt_operation was
	sent, but failed.

	* stdlib/msort.c: Include memcopy.h.
	(msort_with_tmp): If operating on aligned op_t words, use direct word
	fetches and stores.

	* sysdeps/i386/dl-machine.h (ELF_MACHINE_BEFORE_RTLD_RELOC): Add
	missing backslash.

Thu Aug 31 13:23:35 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/unix/i386/brk.S [PIC]: Set __curbrk through the GOT.

	Rewrote i386 setjmp code in assembly, so as to avoid fighting
	with the compiler for the register values.
	* sysdeps/i386/setjmp.S, sysdeps/i386/__longjmp.S: New files.
	* sysdeps/i386/setjmp.c, sysdeps/i386/__longjmp.c: Files removed.
	* sysdeps/i386/jmp_buf.h [! _ASM] (__jmp_buf): Define as array of ints.
	[__USE_MISC || _ASM] (JB_*): New macros, for indices therein.
	(_JMPBUF_UNWINDS): Use JB_SP.

Wed Aug 30 16:44:55 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/select.c: Deal with out of order replies
	during io_select request loop.
	Handle MACH_RCV_TIMED_OUT error from requests.
	* hurd/intr-msg.c: If the user passed the MACH_RCV_TIMEOUT option,
	distinguish MACH_RCV_TIMED_OUT from EINTR.

	* posix/glob.c (glob): Use realloc to extend strings for GLOB_MARK
	slash.
	(glob_in_dir): Don't allocate extra byte here.

	* sysdeps/i386/dl-machine.h (ELF_MACHINE_BEFORE_RTLD_RELOC):
	Decrement the DT_RELSZ value for the skipped reloc.

Tue Aug 29 12:35:56 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* time/australasia: Updated data from ADO.

Mon Aug 28 17:47:11 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* dirent/dirent.h: Don't include <dirstream.h>.
	Instead, define DIR as typedef for (undefined) `struct __dirstream'.

Fri Aug 25 12:12:42 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/dirstream.h: Define `struct __dirstream'
	instead of `DIR'.
	* sysdeps/unix/bsd/dirstream.h: Likewise.
	* sysdeps/stub/dirstream.h: Likewise.
	* sysdeps/unix/dirstream.h: Likewise.
	* sysdeps/mach/hurd/telldir.c: Include "dirstream.h".
	* sysdeps/mach/hurd/seekdir.c: Likewise.
	* sysdeps/mach/hurd/opendir.c: Likewise.
	* sysdeps/mach/hurd/closedir.c: Likewise.
	* sysdeps/mach/hurd/readdir.c: Likewise.
	* sysdeps/unix/telldir.c: Likewise.
	* sysdeps/unix/seekdir.c: Likewise.
	* sysdeps/unix/rewinddir.c: Likewise.
	* sysdeps/unix/readdir.c: Likewise.
	* sysdeps/unix/opendir.c: Likewise.
	* sysdeps/unix/closedir.c: Likewise.
	* sysdeps/unix/bsd/telldir.c: Likewise.
	* sysdeps/unix/bsd/readdir.c: Likewise.
	* dirent/Makefile (headers): Remove dirstream.h.
	(distribute): Put it here instead.

	* sysdeps/mach/hurd/mmap.c: Fix inverted test of MAP_FIXED.

	* stdio/vfscanf.c (number): Allow field width to inhibit first
	digit after base detection.

	* stdio/vfprintf.c (vfprintf: %s): Never search past the limit
	specified by the precision.

	* grp/grpread.c (__grpscan): New function.
	* grp/grp.h (__grpscan): Declare it.
	* grp/getgrgid.c: Use __grpscan.
	* grp/getgrnam.c: Likewise.
	* pwd/pwdread.c (__pwdscan): New function.
	* pwd/pwd.h (__pwdscan): Declare it.
	* pwd/getpwnam.c: Use __pwdscan.
	* pwd/getpwuid.c: Likewise.

Thu Aug 24 16:29:40 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/mmap.c: Treat (FLAGS & MAP_TYPE) == 0 like
	MAP_FILE.

	* hurd/thread-cancel.c: Return EINTR when called on self.
	* sysdeps/i386/elf/start.S (data_start): Define as weak alias for
	__data_start.

Tue Aug 22 16:49:12 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* inet/netdb.h: Moved to resolv.
	* inet/Makefile (headers): Remove netdb.h.
	* resolv/Makefile (headers): Add netdb.h.
	* resolv/gethnamaddr.c, resolv/inet_addr.c, resolv/netdb.h,
	resolv/res_send.c: Updated from BIND-4.9.3-BETA26.

	* hurd/thread-cancel.c: If SS->cancel_hook is not null, call it before
	resuming the thread.
	* hurd/hurd/signal.h (struct hurd_sigstate): New member `cancel_hook'.

	* hurd/Makefile: Removed dep on hurd/signal.h for RPC stub objects.

Mon Aug 21 16:37:09 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/i386/dl-machine.h (elf_machine_rel): Grok R_386_NONE
	relocs, and do nothing.  Why the linker generates them we may
	never know.

Thu Aug 17 16:18:38 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/Makefile: Don't elide sunrpc and manual from
 	`subdirs' variable.

	* sysdeps/mach/hurd/i386/intr-msg.h: New file.
	* hurd/intr-msg.c: Use INTR_MSG_TRAP macro from machine-dependent
 	"intr-msg.h" for special syscall code, instead of i386-specific asm.
	* hurd/hurdsig.c: Use INTR_MSG_BACK_OUT macro from
 	machine-dependent "intr-msg.h" before mutating thread state to
 	skip RPC.

	* sysdeps/mach/hurd/i386/trampoline.c: If PC is inside
 	_hurd_intr_rpc_mach_msg special syscall code, use real SP saved in
	%ecx.

	* Makeconfig (link-libc): New variable; use shared library if
 	available.
	(+link): Use it.

	* sysdeps/mach/hurd/fork.c (_hurd_fork_locks): Variable removed.
  	Instead, declare with `symbol_set_declare'.
	(fork): Use symbol_set_* macros for _hurd_fork_locks.
	Use SS->thread instead of __mach_thread_self ().  Suspend all
 	other threads during task_create and port copying.

Wed Aug 16 17:04:26 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* hurd/intr-msg.c: Fixed calculation of syscall %esp.

Tue Aug 15 12:26:18 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* hurd/hurdsig.c (_hurdsig_abort_rpcs): Remove `static'.

	* hurd/Makefile (sig): Add intr-msg.

Mon Aug 14 16:51:13 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* hurd/thread-cancel.c: New file.
	* sysdeps/mach/hurd/i386/trampoline.c (_hurd_setup_sighandler): In
 	rpc_wait case, frob mach_msg args to set timeout on receive.
	(_hurdsig_rcv_interrupted_p): Function removed.
	* sysdeps/mach/hurd/alpha/trampoline.c: Likewise.
	* sysdeps/mach/hurd/hppa/trampoline.c: Likewise.
	* sysdeps/mach/hurd/mips/trampoline.c: Likewise.
	* hurd/intr-msg.c: New file.
	* hurd/hurd/signal.h (struct hurd_sigstate): New member `cancel'.
	(_hurdsig_rcv_interrupted_p): Declaration removed.
	(HURD_EINTR_RPC): Macro removed.
	(_hurd_longjmp_thread_state, _hurd_interrupted_rpc_timeout): Declare
	these.
	* hurd/intr-rpc.h: New file.
	* hurd/intr-rpc.defs: Just import intr-rpc.h.
	* hurd/hurdsig.c (_hurd_interrupted_rpc_timeout): New variable.
	(interrupted_reply_port_location): Take new flag arg; only catch
	faults if it's set.
	(abort_rpcs): Rename to _hurdsig_abort_rpcs; take same new flag arg.
	No longer use _hurdsig_rcv_interrupted_p; instead compare PC to
 	&_hurd_intr_rpc_msg_in_trap.  If before it, mutate state to simulate
 	MACH_SEND_INTERRUPTED return; on it, interrupt the operation.  All
 	callers changed.
	* hurd/hurd.h (hurd_thread_cancel, hurd_check_cancel): Declare these.
	* hurd/Makefile (distribute): Remove intr-rpc.awk.
	(sig): Add thread-cancel.
	(transform-user-stub, transform-user-stub-output): Variables removed.
	* sysdeps/mach/hurd/dl-sysdep.c: Change all RPCs from
 	`__hurd_intr_rpc_*' to `__*'.
	(_hurd_intr_rpc_mach_msg): New function.
	(_hurd_thread_sigstate): Function removed.
	* sysdeps/mach/hurd/ioctl.c: Use _hurd_intr_rpc_mach_msg function,
 	instead of __mach_msg inside HURD_EINTR_RPC macro.

	* sysdeps/generic/morecore.c [__GNU_LIBRARY__]: Declare `__sbrk'
 	to take ptrdiff_t arg.

	* sysdeps/mach/hurd/fork.c: Remove _hurd_longjmp_thread_state decl.

	* sysdeps/mach/hurd/kill.c (kill_pid): Don't make `inline'.

	* libc-symbols.h [GCC >= 2.7] (strong_alias, weak_symbol,
 	weak_alias): Use `extern' storage class.

Wed Aug  9 14:25:35 1995  Miles Bader  <miles@geech.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/setuid.c (__setuid): Switch the port-type and
	port-count parameters to __auth_makeauth.
	* sysdeps/mach/hurd/setgid.c (__setgid): Ditto.

Tue Aug  8 12:22:59 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* hurd/sigunwind.c: Remove _hurd_longjmp_thread_state decl.

	* inet/netinet/tcp.h: New file, incorporated from 4.4BSD-Lite.

Tue Aug  8 12:06:04 1995  Michael I. Bushnell, p/BSG  <mib@duality.gnu.ai.mit.edu>

	* inet/netinet/in.h (IP_MULTICAST_TTL, IP_MULTICAST_LOOP,
 	IP_MULTICAST_IP, IP_ADD_MEMBERSHIP, IP_DROP_MEMBERSHIP): New IP
 	layer socket options.
	(IPPROTO_GGP): Delete obsolote protocol.
	(IPPROTO_IGMP): Add new protocol (with same value [2] as old GGP).
	(struct ip_mreq): New type.

Mon Aug  7 14:04:36 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* stdlib/strtol.c: Use #ifdef, not #if, for HAVE_LIMITS_H.

	* posix/glob.c (glob_in_dir): Allocate GLOB_MARK byte in case when
 	(NFOUND == 0 && (FLAGS & GLOB_NOCHECK)).

	* sysdeps/generic/sysd-stdio.c (__stdio_reopen): Return failure
 	when __stdio_open fails with a code other than ENFILE or EMFILE.

Fri Aug  4 16:01:59 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* Makefile (headers): Added gnu-versions.h.

Thu Aug  3 14:41:11 1995  Michael I. Bushnell  <mib@duality.gnu.ai.mit.edu>

	* inet/netinet/in.h (IN_CLASSD, IN_EXPERIMENTAL, IN_BADCLASS): Use
	equality, not assignment, to test bitfields.

Sat Jul 29 10:41:06 1995  Miles Bader  <miles@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/sendto.c (sendto): Use the ifsock protocol to
	resolve AF_LOCAL addresses.

	* sysdeps/mach/hurd/accept.c (accept): If the protocol family
	can't tell us what an address means, just return a zero-length
	buffer instead.
	* sysdeps/mach/hurd/recvfrom.c (recvfrom): Ditto.

Fri Jul 28 15:29:11 1995  Miles Bader  <miles@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/bind.c (bind): Don't use
	file_invoke_translator, as it doesn't work.  Instead just lookup
	the translated node again, and hope we're not hit by any race
	conditions.

Wed Jul 26 02:00:29 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* csu/Makefile [$(elf)=yes] (have-initfini): Set to yes.
	[$(have-initfini)=yes]: Test this rather than $(elf) for crtstuff.
	[start-installed-name-rule]: If this is defined, elide rule for
	$(objpfx)$(start-installed-name).
	* csu/initfini.c (SECTION): New macro, different definitions for
 	#ifdef HAVE_ELF and not.
	(_init, _fini): Use that macro.
	* sysdeps/unix/sysv/sco3.2.4/Makefile [$(subdir)=csu]
 	(start-installed-rule, start-installed-name-rule): New variables;
 	specify crt1.o, created by our own rule.
	($(objpfx)crt1.o): New rule.
	* configure.in: Require autoconf 2.4.2 or later.  Change all
 	AC_CACHE_VAL uses to use new AC_CACHE_CHECK macro instead;
 	prettify some messages.
	[$elf!=yes] (libc_cv_have_initfini): New test for `.init' and `.fini'
	sections.
	* munch-tmpl.c [HAVE_INITFINI]: Call _init and atexit (_fini) in
 	this case rather than #ifdef HAVE_ELF.
	* config.h.in (HAVE_INITFINI): New macro.
	* config.make.in (have-initfini): New variable, set by configure.

	* stdio/vfscanf.c (conv_error): Simplify expression to avoid
 	"value computed is not used" warning.

	* Makeconfig (+gccwarn): Removed -Wconversion.

	* csu/initfini.c (GLOBAL): Macro removed.
	(_init, _fini): Always define globally.
	* csu/Makefile (crtstuff, initfini): Don't make crt[in]_s.o.

	* asia, backward, europe, leapseconds, southamerica: New data from
	ADO's 95e.

	* inet/Makefile (routines): Removed inet_addr.
	* inet/inet_addr.c: Moved to resolv/ subdirectory.
	* resolv/Makefile (routines): Added inet_addr.
	* resolv/inet_addr.c: Incorporated from BIND 4.9.3-BETA24 release.
	* resolv/gethnamaddr.c: Likewise.
	* resolv/getnetbyaddr.c: Likewise.
	* resolv/getnetbyname.c: Likewise.
	* resolv/getnetent.c: Likewise.
	* resolv/getnetnamadr.c: Likewise.
	* resolv/herror.c: Likewise.
	* resolv/nsap_addr.c: Likewise.
	* resolv/res_comp.c: Likewise.
	* resolv/res_debug.c: Likewise.
	* resolv/res_init.c: Likewise.
	* resolv/res_mkquery.c: Likewise.
	* resolv/res_query.c: Likewise.
	* resolv/res_send.c: Likewise.
	* resolv/resolv.h: Likewise.
	* resolv/sethostent.c: Likewise.
	* resolv/arpa/nameser.h: Likewise.
	* inet/netdb.h: Incorporated from BIND 4.9.3-BETA24 release.
	[__GNU_LIBRARY__]: Include <rpc/netdb.h> instead of repeating
	its declarations (and doing so only #ifdef sun!).
	* conf/portability.h (NEED_INETADDR, NEED_INETATON): New macros.

	* posix/sys/types.h [__USE_BSD] (__BIT_TYPES_DEFINED__): New macro.
	[__USE_BSD] [__GNUC__] (int64_t, u_int64_t, register_t): New typedefs.

	* malloc/memalign.c: Allocate (SIZE + ALIGNMENT - 1) and then trim
 	if possible.

	* mach/shortcut.awk: Emit decls for RPC.

	* libc-symbols.h [GCC >= 2.7 && !ASSEMBLER] (weak_symbol,
 	weak_alias, strong_alias): Define using GCC __attribute__ syntax.

	* Makerules ($(installed-libcs)): Depend on `lib' (only).

Tue Jul 25 09:14:53 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/pathconf.c: Declare VALUE as int, not long int.

	* stdlib/strtol.c [_LIBC]: Define STDC_HEADERS.

	* sysdeps/unix/sysv/ftime.S: New file.

	* locale/locfile-parse.c (categories_write): Cast "" to char *.

	* io/fcntl.h [__OPTIMIZE__] (creat): Macro removed.

	* time/strftime.c: Use year modulo 100 for %y.

	* time/sys/timeb.h: Add __BEGIN_DECLS and __END_DECLS.

	* sysdeps/unix/snarf-ioctls (snarfexclude): Use two sed's instead
 	of one, to work around bug in sunos4.1.2 sed.

	* stdio/vfprintf.c (vfprintf): For %s with precision spec, use
 	memchr instead of strlen to limit search for NUL by precision.

Mon Jul 24 03:13:16 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/posix/pathconf.c: New file.

Sat Jul 22 20:53:18 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/unix/i386/sysdep.h (JUMPTARGET): Use ## to avoid space
 	before @PLT.
	* sysdeps/mach/i386/sysdep.h (JUMPTARGET): New macro.
	* sysdeps/i386/bsd-_setjmp.S: Use JUMPTARGET macro in jmp insn.
	* sysdeps/i386/bsd-setjmp.S: Likewise.

Sat Jul 22 19:58:54 1995  Michael I Bushnell  <mib@geech.gnu.ai.mit.edu>

	* inet/Makefile (routines): Added `ruserpass'.
	* inet/ruserpass.c: New file, from BSD Net-2 sources for the FTP
	client.  Modified to remove the fourth arg AACCT.  Do nothing for
	the `account' and `macdef' keywords.  Other incidental changes
	because we are not in the FTP source tree.

Sat Jul 22 01:56:03 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/stub/init-posix.c: Removed stub warning.

	* Makefile (autoconf-it): Make it executable and unwritable.

	* configure.in (sysnames): Under --enable-debug-configure, spew
 	potential sysnames.

	* sysdeps/unix/i386/sysdep.h (JUMPTARGET): New macro; use name@PLT
 	#ifdef PIC.
	(PSEUDO): Use JUMPTARGET(syscall_error) in jump insn.
	* sysdeps/unix/i386/syscall.S: Use JUMPTARGET(syscall_error) in
 	jump insn.

	* sysdeps/unix/sysv/sysv4/linux/i386/sysdep.h: Rewritten.
	* sysdeps/unix/sysv/sysv4/linux/i386/syscall.S: New file.
	* sysdeps/unix/sysv/sysv4/linux/i386/socket.S: Include
 	<sys/socketcall.h>.  Save %ebx in call-clobbered %edx instead of
 	stack.  Use JUMPTARGET(syscall_error) in jump insn.

	* Makeconfig (+gccwarn): Add -Wbad-function-cast -Wconversion.

	* sysdeps/unix/i386/sysdep.h (ENTRY): Use ASM_GLOBAL_DIRECTIVE and
 	ASM_TYPE_DIRECTIVE.
	(ASM_TYPE_DIRECTIVE): New macro; defined using `.type' #ifdef ELF.

	* sysdeps/unix/sysv/sysv4/linux/i386/sysdep.S (__syscall_error):
	Rewritten, #include'ing unix/i386/sysdep.S for most of the code.
	* sysdeps/unix/i386/sysdep.S [PIC]: Store into `errno' through the GOT.

	* configure.in (os=linux*): Use unix/sysv/sysv4 for $base_os,
 	instead of unix/sysv.
	* sysdeps/unix/sysv/linux/{accept,connect,getsockname,rename,
	socketpair,waitpid,bind,getpeername,listen,setsid,wait4}.S: Moved
	to new directory sysdeps/unix/sysv/sysv4/linux.
	* sysdeps/unix/sysv/linux: Directory removed.
	* sysdeps/unix/sysv/i386/linux/{socket.S,sysdep.h,sysdep.S}: Moved
	to new directory sysdeps/unix/sysv/sysv4/linux/i386.
	* sysdeps/unix/sysv/linux/i386: Directory removed.

	Fixes to help Linux, inspired by drepper's work:
	* sysdeps/posix/utimes.c: New file.
	* sysdeps/generic/getdomain.c: New file.
	* sysdeps/i386/init-first.c: Removed gratuitous #include <hurd.h>.
	* sysdeps/generic/dl-sysdep.c: Include <unistd.h> and declare
 	externals _dl_argc, _dl_argc, and _environ.

Fri Jul 21 12:57:29 1995  Michael I Bushnell  <mib@geech.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/socket.c (socket): Consider MIG_BAD_ID and
 	EOPNOTSUPP as indications that the server has died.
	* sysdeps/mach/hurd/pipe.c (__pipe): Likewise.
	* sysdeps/mach/hurd/socketpair.c (socketpair): Likewise.

Mon Jul 17 08:45:40 1995  Jim Meyering  (meyering@comco.com)

	* strtol.c: Portability changes from Uli Drepper.
	[!STDC_HEADERS && !defined(NULL)]: Define NULL.

Mon Jul 10 05:39:21 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/i386/init-first.c (init): Take just one arg,
 	DATA for the entry SP; DATA[-1] is always the return address
 	location.  In both cthreads and non-cthreads cases, use asm to
 	force parameters into %eax and %ecx before return, and mutate
 	DATA[-1] to return to specific asm code to set up the user from
 	%eax and %ecx.
	[PIC] (_init): Caller changed.
	(__libc_init_first) [! PIC] (doinit): Use asm to effect call to init
	with SP unwound to argument data ptr.

Thu Jul  6 14:28:56 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/dl-sysdep.c (fmh): Fixed this kludge to work
 	when 0x08000000 and up are not mapped.

	* Makerules (stamp$o-$(subdir) rule): Remove the timestamp file
 	before touching it.
	(lib%.so): Use -Wl to get -soname to ld.

	* elf/dlsym.c: Pass final arg to _dl_lookup_symbol.

	* elf/Makefile (libdl.so): Pass $(LDFLAGS.so).

Tue Jun 20 02:18:19 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* Makerules (lib%.so: lib%_pic.a): Pass -soname switch giving the
 	library's name including $(libprefix) and major version number.

	* locale/locale-ctype.c (allocate_arrays): Use xmalloc and bzero
 	in place of xcalloc.

	* Makeconfig (prefix, exec_prefix, libprefix): Instead of
 	`ifndef', use the $(origin) function to only set these if they are
 	undefined, and not if they are defined to empty.

	* gnu-versions.h: New file.
	* features.h (__GNU_LIBRARY__): Increase value to 5.

Wed Jun 14 03:45:24 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* stdio/stdio.h (__validfp): Use ({...}) rather than a comma
 	expression, to avoid gcc's "value computed is not used" warning.

	* libc-symbols.h (_elf_set_element): Give the set-element variable
 	an `unused' attribute.

	* hurd/hurd/threadvar.h (__hurd_threadvar_location): Declare with
 	__attribute__ ((__const__)).
	* hurd/hurd/signal.h (_hurd_self_sigstate): Likewise.

	* hurd/hurd/userlink.h (_hurd_userlink_link): Properly set
 	LINK->resource.next->resource.prevp when appropriate, not
 	LINK->resource.next->thread.prevp!!!

Tue Jun 13 15:45:10 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* configure.in (libc_cv_asm_set_directive): Make sure that the
 	`.set' directive really worked by linking against a reference to
 	the alias.

	* sysdeps/stub/init-first.c: Don't include <hurd.h>.
	[PIC] (soinit): Renamed to (global) _init.

Mon Jun 12 13:15:45 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* malloc/Makefile (gmalloc-routines): Remove valloc.
	(dist-routines): Add it here.

	* malloc/malloc.h [_MALLOC_INTERNAL] [emacs] (valloc): #define to
 	emacs_loser_valloc to inhibit valloc declaration below.

	* Makerules (lib%.so: lib%_pic.a): Moved this rule to after
 	installation rules.

	* sysdeps/mach/sysdep.h [HAVE_ELF] (ENTRY): Redefine this macro so
 	it uses the `.type' directive, which is necessary for shared
 	libraries to work properly.

Thu Jun  8 02:50:26 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* elf/dl-load.c (_dl_map_object): Add MAP_INHERIT flag in mmap
 	from zero fill.

	* elf/dl-lookup.c (_dl_lookup_symbol): Take new flag arg NOSELF;
 	if nonzero, don't let *REF satisfy the reference itself.
	* elf/link.h (_dl_lookup_symbol): Add new arg NOSELF in decl.
	* sysdeps/i386/dl-runtime.c (_dl_runtime_resolve): Pass new arg to
 	_dl_lookup_symbol.
	* elf/do-rel.h (elf_dynamic_do_rel): Pass new second arg of
 	R->r_offset to RESOLVE callback.
	* elf/dl-reloc.c (_dl_relocate_object: resolve): Don't let *REF
 	satisfy the reference itself if its value equals the reloc's
 	offset.

	* elf/rtld.c (dl_main): Write a newline in fatal msg.

	* Makerules (lib%.so: lib%_pic.a): Pass $(LDFLAGS.so).

	* elf/rtld.c [! NDEBUG] (__assert_perror_fail): New function.

	* hurd/hurdstartup.c (_hurd_startup): Fancier kludge to guess phdr
 	and user entry point addresses.

	* elf/dl-load.c (open_path): Don't do strlen on DIRPATH if it's null.
	(_dl_map_object): DT_RPATH value is relative to DT_STRTAB value.

	* Makerules (install-lib.so): Don't include libc.so.
	[$(build-shared)=yes] (install): Depend on the installed libc.so file.
	[$(build-shared)=yes] (install-no-libc.a): Make this, rather than
	install, depend on the installed $(install-lib.so) files.
	[$(build-shared)=yes] (install-lib.so): Append libc.so after that rule.

	* sysdeps/mach/hurd/dl-sysdep.c (_dl_sysdep_start): Add kludge to
 	allocate high addresses to avoid random mappings appearing there.
	(mmap): Comment out mask; always pass zero.

Tue Jun  6 13:34:53 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/i386/dl-machine.h (ELF_MACHINE_USER_ADDRESS_MASK): New macro.
	* sysdeps/mach/hurd/dl-sysdep.c (mmap): Use it as mask in vm_map call.

	* elf/dl-error.c (_dl_catch_error): Clear *ERRSTRING and *OBJNAME
 	when successful.

	* sysdeps/mach/hurd/dl-sysdep.c (threadvars): New static variable.
	(__hurd_threadvar_max, __hurd_threadvar_stack_offset): Define these
	variables, using the `threadvars' buffer.

	* elf/dl-reloc.c: Don't dereference L->l_prev when it's null.
	* sysdeps/i386/dl-runtime.c: Likewise.

	* elf/rtld.c (dl_main): Add missing NULL terminating argument in
 	_dl_sysdep_fatal call.
	(__assert_fail): Likewise.

	* locale/Makefile (localedef-modules): Renamed ctype to
 	locale-ctype so as not to conflict with the object file for
 	ctype/ctype.c in the build directory.

Mon Jun  5 04:02:26 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* elf/elf.h (ELFMAG): Use \177 instead of \x7f.  It seems GCC
 	insists on seeing the following E as part of hex 7FE, and
 	complaining that is wider than a byte.

Sun Jun  4 22:14:11 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* hurd/Makefile (sig): Added thread-self.
	* hurd/hurd.h: Declare hurd_thread_self.
	* hurd/thread-self.c: New file.

Thu Jun  1 12:17:52 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* elf/rtld.c: Initialize RTLD_MAP.l_type.
	* elf/dl-reloc.c (_dl_relocate_object): Clear LAZY if relocating
 	the dynamic linker itself.
	* sysdeps/i386/dl-machine.h (elf_machine_rel): If MAP->l_type is
 	lt_interpreter, first undo relocation done during bootstrapping.

Tue May 30 15:52:32 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* mach/Makefile (server-interfaces): Removed notify and
 	device_reply.  For shlibs with eager binding, libmachuser.so must
 	not refer to any functions not defined in libc.

Sat May 27 16:23:22 1995  Jim Meyering  (meyering@comco.com)

	* sysdeps/generic/memchr.c: Cast RHS to const unsigned char *
	to avoid error from Irix-4.0.5's C compiler.  From Kaveh Ghazi.

Fri May 26 13:00:08 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* hurd/hurdsig.c (_hurd_internal_post_signal): Don't loop to check
 	pending signals if the thread is in a critical section.  It will
 	send us a msg when it finishes.

	* sysdeps/mach/hurd/pathconf.c: New file.
	* sysdeps/mach/hurd/fpathconf.c: New file.

	* sysdeps/mach/hurd/sigaction.c: Only notify the proc server for
 	SIGCHLD when the SA_NOCLDSTOP bit actually changes.

Sun May 21 05:05:37 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* elf/Makefile (ld.so): Use -nostartfiles in addition to
 	-nostdlib.

Sun May 21 02:01:29 1995  Jim Meyering  (meyering@comco.com)

	* sysdeps/generic/memchr.c: Don't include <string.h> at all.
	HPUX-9.01 and IRIX-4.0.5 vendor C compilers get conflicting dcls for
	memchr unless one manually arranges for them to define __STDC__.

Fri May 19 17:16:46 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/i386/init-first.c: In cthreads case, handle
 	args on stack from kernel.

	* posix/Makefile, sysdeps/alpha/Makefile,
	* sysdeps/mach/hurd/Makefile, sysdeps/sparc/Makefile, Makefile,
	* Makerules, Make-dist: Fix "cvs commit" cmds in rules to not fail
	in the absence of CVS dirs.

	* hurd/hurdstartup.c: Don't call __mach_init.  Grok args from the
 	kernel on the stack properly.

	* set-init.c: Never call _init/_fini; just run __libc_subinit.

	* Makerules (LDFLAGS-c.so): Add -nostartfiles.
	* mach/Machrules (LDFLAGS-$(interface.so)): Likewise.

	* configure.in: Move defaulting of --with-elf and --with-gnu-*
 	based on host os outside the AC_CACHE_VAL for the sysdirs
 	calculation.

	* Makeconfig (localedir, nlsdir): New variables.

	* values.h: New file.
	* Makefile (headers): Add values.h.

	* locale/Makefile (distribute): Add error.h.
	* locale/localedef.c: Include "error.h".
	(main): Use error_message_count instead of warning_cntr.

Wed May 17 16:50:21 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	Merged 1003.2 locale and localedef programs by Ulrich Drepper.
	* locale/charmap.c: New file.
	* locale/collate.c: New file.
	* locale/config.h: New file.
	* locale/ctype.c: New file.
	* locale/ctypedump.c: New file.
	* locale/hash.c: New file.
	* locale/hash.h: New file.
	* locale/iso-4217.def: New file.
	* locale/keyword.gperf: New file.
	* locale/keyword.h: New file.
	* locale/libintl.h: New file.
	* locale/locale.c: New file.
	* locale/localedef.c: New file.
	* locale/localedef.h: New file.
	* locale/locfile-lex.c: New file.
	* locale/locfile-parse.c: New file.
	* locale/messages.c: New file.
	* locale/monetary.c: New file.
	* locale/numeric.c: New file.
	* locale/token.h: New file.

	* posix/regex.c, posix/regex.h: New files, incorporated from GNU regex.
	* posix/Makefile (headers): Add regex.h.
	(routines): Add regex.
	(gpl2lgpl): Add regex.c and regex.h.

Tue May 16 17:35:07 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* locale/loadlocale.c: Expect macro LOCALE_PATH to be defined,
 	instead of hard-coding "/share/locale".

Sat May 13 02:16:42 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* configure.in (os=gnu*): Always set elf=yes, not just for os=gnu*elf*.

Fri May 12 15:31:22 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* elf/elf.h (ELFMAG, SELFMAG): New macros.

Fri May 12 11:24:53 1995  Michael I Bushnell  <mib@duality.gnu.ai.mit.edu>

	* hurd/alloc-fd.c (_hurd_alloc_fd): Don't reduce FIRST_FD in
	the case where it starts out less than _hurd_dtablesize.

Thu May 11 20:51:05 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* hurd/alloc-fd.c (_hurd_alloc_fd): When expanding the dtable,
 	make sure the new size exceeds FIRST_FD.

Wed May 10 21:00:47 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/i386/sysdep.h (RETURN_TO): New macro.

Tue May  9 01:26:52 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* Makerules (install-lib.so): Add %.so for each %_pic.a.

	* sysdeps/i386/elf/start.S (__data_start): Define this symbol as
 	the first thing in .data.

	* sysdeps/mach/_strerror.c (_strerror_internal): Eschew sprintf.

	* hurd/hurdstartup.h: New file.

	* sysdeps/i386/elf/start.S: Give two operands to `testl' when they
 	are the same.  Use `jz' instead of `jeq'.

	* Makeconfig (config.make): Depend on config.status, and run it to
 	update.
	(config.status): New target; depend on configure.
	If target (config.status) exists, run it with --recheck to update;
 	if not, give error msg saying to run confiugre by hand.
	* Makerules [$(sysd-Makefile-sysdirs) != $(sysdirs)]
 	(sysd-Makefile-force): Set this variable to FORCE in this case, to
 	force a rebuild of sysd-Makefile.
	(sysd-Makefile): Depend on $(sysd-Makefile-force).
	Write into the file sysd-Makefile-sysdirs:=$(sysdirs).
	[$(sysd-rules-sysdirs) != $(sysdirs)] (sysd-rules-force): Set this
	variable to FORCE in this case, to force a rebuild of sysd-rules.
	(sysd-rules): Depend on $(sysd-rules-force).
	Write into the file sysd-rules-sysdirs:=$(sysdirs).

	* Makerules (LDFLAGS-c.so): Change ld option -interp to
	-dynamic-linker.

	* Makerules (do-install-program): New canned sequence.
	(install-bin, install-sbin): Use it.
	(install for lib*.so): Use it instead of $(do-install).
	Fix .so installation rules to handle lib*.so and *.so, deal with
 	$(libprefix) right, and install *.so as *.so$($(*.so)-version);
 	i.e. "libc.so-version = .1".

Mon May  8 05:10:25 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* elf/do-rel.h: New file, split out of dynamic-link.h.
	* elf/Makefile (distribute): Add do-rel.h.

Sat May  6 11:06:47 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* Makeconfig (+gccwarn): Add -Winline.

	* hurd/hurdsig.c (_hurd_internal_post_signal): If SS->context is
 	set, avoid abort_rpcs, and use reply and intr ports saved in
 	SS->context.
	* sysdeps/mach/hurd/i386/trampoline.c: Don't set SS->intr_port
 	from SS->context.  Don't clear SS->context.
	* sysdeps/mach/hurd/i386/sigreturn.c: Don't set SS->intr_port when
 	setting SS->context.  If msg_sig_post returns, re-lock and clear
 	SS->context.

Fri May  5 10:37:09 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* mach/Makefile (errsystems.c): Comment out generation rule.

	* sysdeps/mach/_strerror.c: Consider a system unknown if its
 	bad_sub member is null.

	* mach/mig-alloc.c: Add weak alias to non-__ name.

Wed May  3 11:56:35 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/dup2.c: Fixed broken test in last change.

Tue May  2 01:52:58 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* elf/dl-error.c (_dl_catch_error): Actually call the OPERATE
 	function.  Duh.

	* hurd/Makefile (distribute): Added hurdstartup.h.
	* hurd/hurd.h: Remove _hurd_startup decl.

	* hurd/hurd/ioctl.h (_HURD_HANDLE_IOCTLS): Use __attribute__
 	((__unused__)) instead of gratuitous self reference.

	* sysdeps/mach/hurd/dup2.c: Call _hurd_alloc_fd to expand the
 	table if FD2 doesn't fit.

	* sysdeps/mach/hurd/getdtsz.c: Return the RLIM_NOFILE soft limit,
 	not the current table size.

	* sysdeps/mach/i386/sysdep.h (SNARF_ARGS, CALL_WITH_SP): Rewritten.

	Implemented runtime dynamic linker to support ELF shared libraries.
	* elf/Makefile: Added rules to make ld.so and libdl.
	* elf/dl-error.c: New file.
	* elf/dl-fini.c: New file.
	* elf/dl-init.c: New file.
	* elf/dl-load.c: New file.
	* elf/dl-lookup.c: New file.
	* elf/dl-object.c: New file.
	* elf/dl-reloc.c: New file.
	* elf/dlclose.c: New file.
	* elf/dlerror.c: New file.
	* elf/dlopen.c: New file.
	* elf/dlsym.c: New file.
	* elf/dynamic-link.h: New file.
	* elf/link.h: New file.
	* elf/rtld.c: New file.
	* sysdeps/i386/dl-machine.h: New file.
	* sysdeps/stub/dl-machine.h: New file.
	* sysdeps/i386/dl-runtime.c: New file.
	* sysdeps/stub/dl-runtime.c: New file.
	* sysdeps/i386/elf/start.S: New file.
	* sysdeps/generic/dl-sysdep.c: New file.
	* sysdeps/mach/hurd/dl-sysdep.c: New file.
	* sysdeps/mach/hurd/i386/init-first.c: New file.
	* sysdeps/i386/init-first.c: New file.
	* sysdeps/stub/init-first.c: New file.

Mon May  1 18:48:30 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* Makerules (LDFLAGS-c.so): Add -interp and -e switches to make
 	libc.so runnable.
	* version.c (__libc_print_version): Add "et al" and missing NL to
 	author credit.

Sat Apr 29 15:46:57 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* posix/glob.c (S_ISDIR): Define if undefined.

Thu Apr 27 01:24:09 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* configure.in: Unless --without-fp, prepend */fpu before each
 	machine dir in $mach; don't prepend FPU dirs at end.  If
 	--with-elf, prepend MACHINE/elf directories at end; don't insert
 	them into $mach.

	* Makerules (dist): Filter out *.[cSs] from $(distribute) in deps.

	* sysdeps/stub/clock.c: Added stub warning.
	* sysdeps/stub/dirfd.c: Likewise.
	* sysdeps/stub/exc2signal.c: Likewise.
	* sysdeps/stub/fdopen.c: Likewise.
	* sysdeps/stub/flock.c: Likewise.
	* sysdeps/stub/fpathconf.c: Likewise.
	* sysdeps/stub/ftruncate.c: Likewise.
	* sysdeps/stub/gtty.c: Likewise.
	* sysdeps/stub/isatty.c: Likewise.
	* sysdeps/stub/killpg.c: Likewise.
	* sysdeps/stub/madvise.c: Likewise.
	* sysdeps/stub/mkstemp.c: Likewise.
	* sysdeps/stub/mktemp.c: Likewise.
	* sysdeps/stub/mprotect.c: Likewise.
	* sysdeps/stub/msync.c: Likewise.
	* sysdeps/stub/pathconf.c: Likewise.
	* sysdeps/stub/poll.c: Likewise.
	* sysdeps/stub/raise.c: Likewise.
	* sysdeps/stub/readv.c: Likewise.
	* sysdeps/stub/setenv.c: Likewise.
	* sysdeps/stub/setlogin.c: Likewise.
	* sysdeps/stub/sigaltstack.c: Likewise.
	* sysdeps/stub/sigintr.c: Likewise.
	* sysdeps/stub/sigstack.c: Likewise.
	* sysdeps/stub/sleep.c: Likewise.
	* sysdeps/stub/sstk.c: Likewise.
	* sysdeps/stub/stime.c: Likewise.
	* sysdeps/stub/stty.c: Likewise.
	* sysdeps/stub/syscall.c: Likewise.
	* sysdeps/stub/sysconf.c: Likewise.
	* sysdeps/stub/truncate.c: Likewise.
	* sysdeps/stub/ualarm.c: Likewise.
	* sysdeps/stub/usleep.c: Likewise.
	* sysdeps/stub/utimes.c: Likewise.
	* sysdeps/stub/writev.c: Likewise.

	* sysdeps/stub/libc_fatal.c: Remove __NORETURN keyword.

Wed Apr 26 16:06:42 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* locale/loadlocale.c (_nl_free_locale): Do nothing if DATA is null.

Tue Apr 25 17:17:19 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* posix/glob.c (glob): If GLOB_MARK set, stat names to find
 	directories and append slashes to them in final pass before
 	sorting.
	(glob_in_dir): If GLOB_MARK set, just allocate the extra char for the
	slash; never append it here.

Sat Apr 22 14:48:03 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* mach/Machrules [interface-library]
 	(LDFLAGS-$(interface-library:lib%=%.so)): New variable, set to
 	-nostdlib.

	* sysdeps/mach/hurd/fork.c: Subfunction `unlockss' removed.  Lock
 	_hurd_siglock only around initial task creation in parent.  Use
 	_hurd_critical_section_unlock at end.  Handle dead name rights
 	properly, and deal with a send right dying while we try to copy
 	it.  For the time being, use assert_perror for kernel and proc RPC
 	failures.

Fri Apr 21 01:10:15 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* extra-lib.mk: Don't include $(o-iterator); construct it by hand
 	using $(object-suffixes-$(lib)) instead.

	* sysdeps/mach/hurd/Makefile (LDLIBS-c.so): New variable.

	* Makerules (lib%.so: lib%_pic.a): Pass $(LDFLAGS-$(notdir $*).so).
	(LDFLAGS-c.so): New variable.

	* resolv/res_init.c (res_init): Don't clobber _res.options with
 	RES_DEFAULT.  If RES_INIT is clear, OR in RES_DEFAULT.

	* hurd/hurd.h: Declare _hurd_startup.
	* hurd/hurdstartup.c: New file.
	* hurd/Makefile (routines): Add hurdstartup.

Thu Apr 20 22:23:58 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* hurd/hurdsig.c: Use assert_perror for many calls which should
 	never fail and previously were not checked.

	* sysdeps/mach/hurd/i386/trampoline.c (_hurd_setup_sighandler):
 	Point the return address for sigreturn's frame at a "hlt" insn so
 	it will definitely crash if sigreturn returns.

Wed Apr 19 18:40:11 1995  Brendan Kehoe  (brendan@zen.org)

	* time/tzset.c (__tzname, __daylight, __timezone): Don't check
	HAVE_WEAK_SYMBOLS for doing weak_alias.

Wed Apr 19 18:12:56 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* configure.in: Move $os tests to set $elf et al earlier, before
 	construction of $sysnames.  Instead of prepending MACHINE/elf to
 	$sysnames, append &/elf after each elt appended to $mach.

Tue Apr 18 14:00:19 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* configure.in (libc_cv_asm_global_directive): New check to define
 	ASM_GLOBAL_DIRECTIVE.
	* config.h.in: Add #undef ASM_GLOBAL_DIRECTIVE.
	* libc-symbols.h (strong_alias_asm, strong_alias): Use
 	ASM_GLOBAL_DIRECTIVE on the alias.

	* sysdeps/unix/make_errlist.c (main): Don't generate "#ifdef
 	HAVE_WEAK_SYMBOLS" #defns.

Mon Apr 17 12:02:49 1995  Brendan Kehoe  (brendan@zen.org)

	* sysdeps/alpha/strlen.c (strlen): Fix cmpbge insn, and returning
	of the byte that was zero, so we return a valid number.

Sun Apr 16 03:23:09 1995  Brendan Kehoe  (brendan@zen.org)

	* sysdeps/unix/bsd/ultrix4/mips/sysdep.h: New file defining
	NO_UNDERSCORES then using sysdeps/unix/mips/sysdep.h.

Fri Apr 14 18:49:03 1995  Brendan Kehoe  (brendan@zen.org)

	* sysdeps/ieee754/mpn2dbl.c (__mpn_construct_double)
	[BITS_PER_MP_LIMB == 64]: Refer to `u', not to non-existent `i'.
	* sysdeps/ieee754/mpn2ldbl.c (__mpn_construct_long_double)
	[BITS_PER_MP_LIMB == 64]: Likewise.

	* sysdeps/unix/bsd/osf/alpha/killpg.S (killpg): Add .end directive.
	* sysdeps/unix/bsd/osf/alpha/sigblock.S (__sigblock): Likewise.
	* sysdeps/unix/bsd/osf/alpha/sigsetmask.S (__sigsetmask): Likewise.
	* sysdeps/unix/bsd/osf/alpha/sigpause.S (__sigpause): Likewise.
	* sysdeps/unix/bsd/osf/alpha/sigvec.S (__sigvec): Likewise.
	* sysdeps/unix/bsd/osf/alpha/getdents.S (__getdirentries): Likewise.
	* sysdeps/unix/bsd/osf/alpha/fork.S (__fork): Likewise.
	* sysdeps/unix/bsd/osf/alpha/pipe.S (__pipe): Likewise.
	* sysdeps/unix/bsd/osf/alpha/recv.S (recv): Likewise.
	* sysdeps/unix/bsd/osf/alpha/send.S (send): Likewise.
	* sysdeps/unix/bsd/osf/alpha/vhangup.S (vhangup): Likewise.

	* sysdeps/unix/mips/brk.S (__brk, __curbrk): Add .end directive.
	* sysdeps/unix/mips/fork.S (fork): Likewise.
	* sysdeps/unix/mips/pipe.S (fork): Likewise.
	* sysdeps/unix/mips/sigreturn.S (__sigreturn): Likewise.
	* sysdeps/unix/mips/sysdep.S (sysdep_error): Likewise.
	* sysdeps/unix/mips/wait.S (__handler): Likewise.
	* sysdeps/mips/setjmp.S (__sigsetjmp): Likewise.
	* sysdeps/mips/bsd-setjmp.S (setjmp): Likewise.
	* sysdeps/unix/bsd/ultrix4/getsysinfo.S (getsysinfo): Likewise.
	* sysdeps/unix/bsd/ultrix4/wait3.S (waitpid): Likewise.
	* sysdeps/unix/bsd/ultrix4/waitpid.S (waitpid): Likewise.
	* sysdeps/unix/bsd/ultrix4/mips/__handler.S (__handler): Likewise.
	* sysdeps/unix/bsd/ultrix4/mips/sigvec.S (__raw_sigvec): Likewise.
	* sysdeps/unix/bsd/ultrix4/mips/start.S (__start): Likewise.
	* sysdeps/unix/bsd/ultrix4/mips/vfork.S (vfork): Likewise.
	* sysdeps/mips/bsd-_setjmp.S (setjmp): Likewise.  Use `$0'
	instead of `zero' for the li instruction.

	* sysdeps/unix/bsd/osf/alpha/start.S: Change comments to be
	preprocessor comments, not assembler comments.
	* sysdeps/unix/bsd/osf/alpha/brk.S: Likewise.
	* sysdeps/unix/bsd/osf/alpha/sysdep.h (NO_UNDERSCORES): Define.

Fri Apr 14 15:53:46 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* malloc/malloc.c (register_heapinfo) [__GNUC__]: Use __inline__
 	in place of inline.

Thu Apr 13 09:45:01 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* Makefile (distribute): Add ChangeLog.[0-9].

	* configure.in: Add check for .set directive.
	* config.h.in: Add #undef HAVE_ASM_SET_DIRECTIVE.
	* libc-symbols.h [! HAVE_ASM_SET_DIRECTIVE] (strong_alias,
 	strong_alias_asm): Use `foo = bar' syntax instead.

	* Makerules [! subdir] (O%-lib): Don't prepend ../.

	* sysdeps/generic/expm1.c: #undef expm1 before weak_alias.

	* configure.in: Fix AC_ARG_WITH uses; check for --with-fp.  Move
 	$host_os checks to set gnu_ld/as and elf before sysdirs
 	generation.  Fix $with_fp test.
	[$elf=yes]: Prepend MACHINE/elf directory.

	* elf/libelf.h (elf_hash): Use XOR instead of ANDN when the bits
 	being cleared are already known to be set.  Thanks Ulrich.

Wed Apr 12 23:27:22 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* posix/environ.c: Add weak alias `_environ'.

Tue Apr 11 20:38:55 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/i386/add_n.S [PIC]: Use self-call to avoid generating reloc.
	* sysdeps/i386/sub_n.S [PIC]: Likewise.

Mon Apr 10 14:53:15 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* libc-symbols.h (_elf_set_element) [PIC]: Don't make the element
 	word `const'.

	* Makeconfig (CPPFLAGS, CFLAGS): Fix swapped references to
 	$(foo-$(suffix $@)).

	* manual/Makefile (chapters-incl): Filter out summary.texi.

	* stdlib/strtod.c (STRTOF): Use extra macro to make STRTOF's #defn
 	a weak symbol instead of literal "STRTOF".

	* locale/setlocale.c: Work around ld bug: don't weakify refs to
 	_nl_{current,C}_*.

Sun Apr  9 01:24:33 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* Makerules (+depfiles): Translate %.so to %.o in $(extra-objs).

	* malloc/free.c [emacs] (__malloc_safe_bcopy): Define to safe_bcopy.
	* malloc/realloc.c (__malloc_safe_bcopy): Undefine before defining.

	* malloc/free.c (memmove, __malloc_safe_bcopy): Do include these
 	#ifdef emacs, but only #ifndef memmove.
	* malloc/realloc.c [emacs] (__malloc_safe_bcopy): Just #define to
 	safe_bcopy.
	(memmove): Define only if undefined.

Sat Apr  8 00:40:59 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* extra-lib.mk (install-lib, extra-objs, alltypes-$(lib)): Make
 	sure these are simply-expanded variables.

	* locale/loadlocale.c (_nl_load_locale): Use MAP_INHERIT flag in
 	mmap call.

	* configure.in (os=freebsd*|bsdi*): Set base_os=unix/bsd/bsd4.4
 	for these too.

	* sysdeps/unix/sysv/tcsetattr.c: Use |= instead of = to properly
 	set c_oflag value.

	* Makeconfig [! objpfx] (csu-objpfx): Add trailing slash.

	* locale/Makefile (categories): Uncomment collate.
	* locale/lc-collate.c: New file.

	* malloc/free.c (__malloc_safe_bcopy, memmove): Don't define
 	#ifdef emacs.
	* malloc/realloc.c: Likewise.

	* stdio/_itoa.h (_EXTERN_INLINE): Define if undefined.
	(_itoa): Use it in defn.
	* stdio/_itoa.c (_EXTERN_INLINE): Define to empty before #include
 	"_itoa.h".
	(_itoa): Function removed.

	* malloc/free.c: Remove use of `assert'.

	* malloc/realloc.c [! emacs] (safe_bcopy): Renamed to
 	__malloc_safe_bcopy; #define safe_bcopy.
	* malloc/free.c: Cope with systems lacking `memmove'.
	(_free_internal): Cast result of _malloc_internal.

Wed Apr  5 00:13:45 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* hurd/hurdinline.c: Include signal.h first, so we don't define
 	its inlines too.

	* sysdeps/unix/sysv/sysv4/sigset.h (__sigfillset): Use ~0L instead
 	of -1 to avoid compiler warning.

	* configure.in (host_os=linux*): Set elf=yes for this, not just
 	linux*elf*.

	* misc/login_tty.c [! TIOCSCTTY]: Try an emulation using ttyname
 	and open.

	* sysdeps/i386/bsd-_setjmp.S: Fix typo in name: setjmp -> _setjmp.

Tue Apr  4 00:48:53 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/unix/start.c: Remove spurious decl and #endif.

	* misc/progname.c (program_invocation_name,
 	program_invocation_short_name): Make these initialized data
 	definitions.

	* sysdeps/mach/hurd/setitimer.c (fork_itimer): Add self reference
 	so gcc doesn't optimize out the function entirely.

Sun Apr  2 13:13:52 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* posix/execvp.c: Don't use stat to search path; just try execv
 	until it works.

	* sysdeps/mach/hurd/i386/trampoline.c: Add a link to
 	SS->active_resources, so that _hurdsig_longjmp_from_handler will
 	be called when a longjmp unwinds the signal frame.
	* sysdeps/mach/hurd/i386/sigreturn.c: Remove the link on the
 	SS->active_resources chain added by _hurd_setup_sighandler.
	* hurd/sigunwind.c: New file.
	* hurd/Makefile (sig): Add sigunwind.

	* Makerules (lib%.so: lib%_pic.a): Remove dir name from $*.

	* MakeTAGS (tags-sources): Include $(all-dist).
	[subdir] (all-dist): Define to $(distribute).

Sat Apr  1 00:08:06 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* Makerules (lib%.so: lib%_pic.a): Pass -L options for subdir and
 	parent objdirs.

	* extra-lib.mk (object-suffixes-$(lib)): New variable, produced by
 	filtering out $($(lib)-inhibit-o); use that instead of
 	$(object-suffixes) in all the other variables.

	* locale/loadlocale.c (_nl_load_locale) [MAP_FILE]: Define it zero
 	if undefined.

	* string/strxfrm.c: Just copy the string (for now).
	* string/strcoll.c: Just call strcmp (for now).

	* mach/Makefile (lock): Add mutex-init.
	* mach/mutex-solid.c (_cthread_mutex_lock_routine,
 	_cthread_mutex_unlock_routine): Variables removed.
	(__mutex_lock_solid, __mutex_unlock_solid): Don't use them; just stub.
	(__mutex_init): Function moved to new file mutex-init.c.
	* mach/mutex-init.c: New file, broken out of mutex-solid.c.

Thu Mar 30 20:43:02 1995  Brendan Kehoe  <brendan@zen.org>

	* sysdeps/mips/__longjmp.c (__longjmp): Take out CONST.
	* sysdeps/alpha/__longjmp.c (__longjmp): Take out const.

Thu Mar 30 01:38:00 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* elf/elf.h (STN_UNDEF): New macro (distinct from SHN_UNDEF, though
 	both are zero).

Wed Mar 29 11:26:48 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* elf/dlfcn.h: New file.

	* Make-dist (README): Commit it to CVS if there is a CVS directory.

	More changes from Germano Caronni <caronni@tik.ethz.ch>:
	* malloc/free.c: Relocate _heapinfo when that allows us to return
 	core to the system.

	* malloc/malloc.c: Move #include <errno.h> outside #ifndef
	_MALLOC_INTERNAL.

Mon Mar 27 02:23:15 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* mach/Makefile (headers): Add mach/mach_traps.h.

	* Makerules ($(installed-libcs) rule): Fix typos.

	* sysdeps/unix/bsd/bsd4.4/revoke.S: New file.
	* sysdeps/stub/revoke.c: New file.
	* misc/Makefile (routines): Add revoke.
	* posix/unistd.h [__USE_BSD] (revoke): Declare it.
	* sysdeps/generic/pty.c (openpty, forkpty): Declare return types.
	(forkpty): Declare login_tty.
	* misc/logwtmp.c (logwtmp): Declare to return void.
	* misc/login_tty.c (login_tty): Include unistd.h.  Declare return type.

	* posix/unistd.h [__USE_BSD] (ttyslot): Declare it.

	* posix/unistd.h [__USE_BSD] (L_SET, L_INCR, L_XTND): Define
 	unless L_SET already defined.
	* misc/sys/file.h (L_SET, L_INCR, L_XTND): Don't define if L_SET
 	already defined.

	Incorporated -lutil library from 4.4-Lite.
	* misc/Makefile (extra-libs, libutil-routines): New variables.
	* misc/login.c, misc/login_tty.c, misc/logout.c, misc/logwtmp.c,
	sysdeps/generic/pty.c: New files for -lutil incorporated from 4.4-Lite.

	Support simple, light-weight unwind-protect mechanism for longjmp.
	* setjmp/longjmp.c: Call _longjmp_unwind first thing.
	* sysdeps/mach/hurd/jmp-unwind.c: New file.
	* sysdeps/stub/jmp-unwind.c: New file.
	* sysdeps/i386/jmp_buf.h (_JMPBUF_UNWINDS): New macro.
	* sysdeps/mips/jmp_buf.h (_JMPBUF_UNWINDS): New macro.
	* setjmp/Makefile (routines): Add jmp-unwind.
	* hurd/hurd/userlink.h (struct hurd_userlink): Move `next' and
 	`prevp' members into new substructure `resource'; add another such
 	substructure `thread' and members `cleanup' (function ptr) and
 	`cleanup_data' (generic ptr).
	(_hurd_userlink_link, _hurd_userlink_unlink): Insert/remove LINK
	into the `_hurd_self_sigstate ()->active_resources' list via the
	`thread' substructure.
	* hurd/hurd/port.h (_hurd_port_cleanup): Declare it.
	(_hurd_port_locked_get): Set LINK->cleanup to _hurd_port_cleanup and
	LINK->cleanup_data' to the port extracted.
	* hurd/hurd/signal.h (struct hurd_sigstate): New member
	`active_resources'.
	* hurd/port-cleanup.c: New file.
	* hurd/Makefile (routines): Add port-cleanup.

	* malloc/malloc.c: Include errno.h.

Sat Mar 25 18:24:21 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* locale/loadlocale.c (_nl_load_locale): Avoid */ inside comment.

Fri Mar 24 02:35:37 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* misc/Makefile (headers): Add utmp.h.
	* misc/utmp.h: New file, incorporated from 4.4-Lite.

	* stdio/printf-parse.h: New file, mostly written by drepper.
	* stdio/vfprintf.c: Rewritten, mostly by drepper.
	* stdio/printf-prs.c: Rewritten.
	* stdio/Makefile (distribute): Add printf-parse.h.

Thu Mar 23 22:03:44 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/unix/start.c [! NO_UNDERSCORES]: Don't declare _start
 	with asm name.  Just do a ".set start, __start".

	* malloc/realloc.c: Call _free_internal instead of free.

Tue Mar 21 00:14:27 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* locale/loadlocale.c (_nl_load_locale): If LOCALE/LC_* is a
 	directory, open LOCALE/LC_*/SYS_LC_* instead.

Mon Mar 20 03:19:23 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* stdio/fpioconst.c, stdio/fpioconst.h, stdio/gmp-impl.h,
	stdio/gmp.h, stdio/longlong.h, stdio/mp_clz_tab.c,
	stdio/gen-mpn-copy: Files moved to stdlib.
	* stdio/Makefile: All mpn stuff moved to stdlib/Makefile.
	* stdlib/Makefile: All the mpn stuff moved here from stdio/Makefile.
	* stdio/printf_fp.c: Use ../stdlib to find fpioconst.h and gmp
 	headers.
	* stdlib/strtod.c: Don't use ../stdio to find fpioconst.h and gmp
 	headers.

	* Makefile (parent-mostlyclean): Don't use $(libc.a).
	(parent-clean): Use $(objpfx) to find sysd-*.
	* Rules (generated): Append dummy.o dummy.c.
	* Makerules (lib): Depend on lib-noranlib.
	(lib-noranlib): Depend on $(install-lib) in objdir.
	(common-mostlyclean): Remove $(install-lib) and stub-$(subdir)
	from objdir.  Don't remove TAGS; it comes in the distribution.

	* malloc/malloc.c (morecore): Save errno around call to
 	_realloc_internal.  Don't account for the additional new blocks of
 	the info table itself when choosing the new table size for the
 	first crack; if it succeeds, the new blocks will have been found
 	in existing free space already described by the existing info
 	table.

	* stdio/vfscanf.c (%n): Use READ_IN - 1, so as not to count the
 	read-ahead character.

Sat Mar 18 14:07:08 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* hurd/dtable.c, hurd/getdport.c, hurd/hurd.h, hurd/hurdexec.c,
	  hurd/hurdinit.c, hurd/hurdprio.c, hurd/hurdsock.c,
	  hurd/ports-get.c, hurd/ports-set.c, hurd/setauth.c,
	  hurd/setuids.c, sysdeps/mach/hurd/i386/trampoline.c:
	Get anal with unsigned to pacify compiler.

	* stdio/vfscanf.c: Grok positional parameter specs (i.e. %3$d
 	means %d from 3rd arg).

	* sysdeps/mach/hurd/closedir.c: Include hurd/fd.h.

	* stdlib/strtol.c: If !GROUP, set END to null.  In loop, test only
 	END, not GROUP.

Fri Mar 17 12:58:37 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* Makefile (subdirs): Put elf last.

	* sunrpc/Makefile (install-lib): Variable removed.
	(rpcsvc-objs): Variable removed.
	(extra-objs): Don't include $(rpcsvc-objs).
	(extra-libs): New variable, contains librpcsvc.
	(librpcsvc-routines): New variable.
	(librpcsvc-inhibit-o): New variable, contains .so.
	(omit-deps): Set this to $(librpcsvc-routines).
	($(objpfx)rpcgen): Don't use $(libc.a).
	(lib, $(objpfx)librpcsvc.a): Targets removed.

	* o-iterator.mk, extra-lib.mk: New files.
	* Makerules (o-iterator): New variable.
	[extra-libs]: Include extra-lib.mk to generate rules for each word
	of $(extra-libs).
	* Makefile (distribute): Add extra-lib.mk, o-iterator.mk.

Fri Mar 17 13:28:04 1995  Ulrich Drepper  <drepper@ipd.info.uni-karlsruhe.de>

	* sysdeps/ieee754/ldbl2mpn.c (__mpn_extract_long_double):
	Handle 80-bit denormalized numbers correctly.

	* stdlib/strtod.c, stdlib/strtof.c, stdlib/strtold.c:
	(IMPLICIT_ONE, *_MAX_10_EXP_LOG): Macros removed; no longer needed.
	* stdlib/strtod.c (RETURN): Add parentheses around return value.
	(round_and_return): Correct handling of denormalized numbers.

	* stdio/fpioconst.c, stdio/fpioconst.h: Don't use
 	LDBL_MAX_10_EXP_LOG; LAST_POW10 defines the maximal available
 	exponent.

Thu Mar 16 00:04:41 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* locale/C-ctype.c: New correct data generated by drepper.

	* Rules: Don't use $(libc.a).

	Parsing of grouped numbers contributed by Ulrich Drepper.
	* stdlib/strtol.c (__strtol_internal): Renamed from strtol.  Take
 	new flag arg; if nonzero, parse locale-dependent thousands
 	grouping and interpret only the prefix that is correctly grouped.
	(strtol): Define this to call _strtol_internal with zero for the flag.
	Use a weak symbol for the definition.
	* stdlib/strtod.c (strtod, __strtod_internal): Likewise.
  	Check for the exponent of the number overflowing the float format.
	* stdlib/stdlib.h (__strtof, __strtold): Declarations removed.
	(__strto{f,d,ld,l,ul,q,uq}_internal): Declare these functions.
	[__OPTIMIZE__]: Define inline functions calling those.
	* stdlib/strtold.c (STRTOF): Set to strtold, not __strtold.
	(strtold): Remove weak alias.
	* stdlib/strtof.c (STRTOF): Set to strtof, not __strtof.
	(strtof): Remove weak alias.
	* stdlib/grouping.h: New file, written by drepper.
	* stdlib/Makefile (distribute): Add grouping.h.
	* stdio/vfscanf.c: Grok %' modifier to numeric conversions.  Call
 	__strtoX_internal with the grouping flag set iff the modifier is
 	present.

Wed Mar 15 00:40:54 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/generic/memchr.c: Fix typos: limit.h -> limits.h.

	* mach/Machrules: Produce static deps for all object flavors.
	[interface-library]: Remove all these variables and rules.
	($(interface-library)-routines): Define this variable.
	(extra-libs): Append $(interface-library) to this.
	* mach/Makefile (interface-library): Omit .a suffix.
	* hurd/Makefile: Likewise.

Tue Mar 14 23:40:31 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* stdio/internals.c (flushbuf): If !FLUSH_ONLY, don't skip out
 	early if no new data in buffer after priming.

Mon Mar 13 01:48:16 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* Makerules (object-suffixes, libtypes): Move all these variables
 	to Makeconfig.
	* Makeconfig (object-suffixes, libtypes): Moved here from Makerules.

	* Makerules (build-extra-lib): New canned sequence.

	* sysdeps/mach/hurd/euidaccess.c: Include fcntl.h.  Declare ERR;
 	fix uses of FILE and PORT.  Remove bogus weak alias for `access'.

	* sysdeps/mach/hurd/dirfd.c: Include hurd/fd.h and errno.h.
	Add missing semicolon.
	* sysdeps/mach/hurd/opendir.c: Include hurd/fd.h.  Use a `struct
 	hurd_fd *' temp var, since DIRP->__fd is a `void *'.
	* sysdeps/mach/hurd/readdir.c: Include hurd/fd.h.

	* stdlib/wcstombs.c: #if 0 out code for non-ASCII chars until the
 	locale data format is implemented.

	* sysdeps/mach/hurd/i386/trampoline.c (_hurd_setup_sighandler):
 	Pass &__sigreturn on the stack to the trampoline code, so it is
 	not position-dependent.

	* stdio/printf_fp.c (NDEBUG): Define this to disable assert.
  	Don't include <stdarg.h>.
	(__printf_fp): Last arg ARGS is now `const void **const';
	dereference ARGS[0] instead of using va_arg.

	* locale/setlocale.c: In LC_ALL case, initialize CATEGORY before
 	loop to install data.

	* locale/loadlocale.c (_nl_category_num_items): Use _NL_ITEM_INDEX
 	to extract number from item code.
	(_nl_load_locale): Close the descriptor when finished.

	* malloc/realloc.c (_realloc_internal): Call _malloc_internal in
 	place of malloc.

	* time/tzfile.c (__tzfile_default): Initialize RULE_STDOFF to zero.

	* stdio/printf_fp.c (group_number): Cast *GROUPING to unsigned int
 	to avoid warning.
	* sysdeps/generic/sigset.h (__SIGSETFN): Cast result of sizeof to
 	int to avoid warning.

	Support building several flavors of objects and libraries.
	* Makerules (libtypes, object-suffixes): New variables.
	(libtype.*, CFLAGS-*, CPPFLAGS-*): New variables for each object
	suffix.
	(CFLAGS, CPPFLAGS): Append $(C{,CPP}FLAGS-$(suffix $@)).
	(%.so, %.po, %.go): New compilation rules for %.S, %.s, %.c.
	(close-check-inhibit-asm): Append a semicolon.
	(sysd-rules): Generate rules for each object suffix.
	(compile.S, compile.c): Always assume gcc.
	(OUTPUT_OPTION): Define unconditionally.
	(+make-deps): In generated rule, produce a dependent for each
	object suffix.
	(.SUFFIXES): Add $(object-suffixes) in place of .o.
	(.PRECIOUS): Make all suffix flavors precious.
	($(libc.a)): Target removed.
	(lib): Depend on each enabled libtype.
	(libobjs, objects, objs): Depend on all the enabled object flavors.
	(lib%.a): New pattern rule.
	[$(build-shared)=yes] (lib%.so: lib%_pic.a): New pattern rule.
	(stamp-$(subdir)): Rewritten to a pattern rule for stamp.%-$(subdir)
	to make one for each flavor; library dep rule likewise rewritten.
	($(libc.a)(__.SYMDEF)): Target replaced with one target for each
	flavor.
	(symdef.%): New pattern rule; helper for __.SYMDEF targets.
	(installed-libcs): New variable.
	(install): Depend on that instead of
	$(libdir)/lib$(libprefix)$(libc-name).a;
	that file's rule rewritten to make each enabled libtype.
	(install-lib.so): New variable, filters lib%.so from $(install-lib).
	(install-lib): Filter out lib%.so after setting install-lib.so.
	[$(build-shared)=yes] (install): Install $(install-lib.so).
	(common-mostlyclean): Remove all flavors of objects.
	* Makefile ($(libc.a)(__.SYMDEF)): Target removed.
	[$(build-shared)=yes] (lib): Depend on $(common-objpfx)libc.so.

Sun Mar 12 18:21:10 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/stub/ulimit.c: Don't include gnu-stabs.h.
	* sysdeps/stub/pause.c: Likewise.
	* sysdeps/stub/time.c: Likewise.

	* stdlib/mbtowc.c: #if 0 out code for non-ASCII chars until the
 	locale data format is implemented.
	* stdlib/wctomb.c: Likewise.

	* mach/Makefile ($(objpfx)errsystems.c): Reenable this rule; the
 	gcc bug is fixed.
	* mach/errsystems.c: File removed.

	* Makeconfig (libc.a): Variable removed.
	(+link): Don't use it.

	* configure.in (AC_ARG_ENABLE calls): Use $enableval instead of
 	assuming `yes'.

	* malloc/malloc.h (_malloc_internal, _realloc_internal): Declare these.
	* malloc/realloc.c (_realloc_internal): Renamed from realloc;
 	don't use __realloc_hook.
	(realloc): New function; call __realloc_hook ?: _realloc_internal.
	* malloc/malloc.c (_malloc_internal): Renamed from malloc;
	don't use __malloc_hook.
	(malloc): New function; call __malloc_hook ?: _malloc_internal.
	Changes from Germano Caronni <caronni@tik.ethz.ch>:
	(initialize): Set up _heaplimit to cover the _heapinfo table.
	(morecore_recursing): New static variable.
	(morecore): If that is set, return null immediately.
	When growing the info table, before getting new core from the
 	system for it, set morecore_recursing and try moving _heapinfo
 	with _realloc_internal.  When that fails and we get new core, set
 	_heaplimit to cover the core for the new _heapinfo table.
	(register_heapinfo): New function.  Record the _heapinfo table's
	own blocks in that table and in the statistics variables.
	(initialize, _malloc_internal): Use it after allocating new table.

Fri Mar 10 22:26:28 1995  Jim Meyering  (meyering@comco.com)

	* sysdeps/generic/memchr.c: Remove ansidecl.h and clean up for use
	by other packages.
	[LONG_MAX <= LONG_MAX_32_BITS]: Don't compile 64-bit code.

Fri Mar 10 13:31:29 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* mach/errorlib.h (errors): Use const for decl.

	* time/tzfile.c (uc2ul, _uc2ul): Macros removed.
	(decode): New inline function; decode signed 32-bit integers, and
	sign-extend properly when long is longer than 32 bits.
	(__tzfile_read): Changed all uses of uc2ul to decode.
	Decode the transition times properly when sizeof (time_t) > 4.

	* stdio/printf.h: Doc fixes.  Don't #include <stddef.h>.
	(printf_function): Make last arg ARGS a vector of pointers instead of a
	pointer to va_list.

Fri Mar 10 13:46:25 1995  Ulrich Drepper  <drepper@ipd.info.uni-karlsruhe.de>

	* stdio/vfprintf.c [USE_IN_LIBIO] (PAD): Use return value of _IO_padn.
	(buffered_vfprintf): Remove line buffer when flush failed.

Fri Mar 10 00:04:55 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* time/tzfile.c (struct ttinfo): New member `isgmt'.
  	(__tzfile_read): Read isgmt flags for each type.
  	(__tzfile_default): When using TZDEFRULES DST rules, adjust
 	transition times according to the isstd and isgmt flags for the
 	types of each transition, and adjust each transition to point to
 	type index either 0 or 1.  Reset type indices 0 and 1 to describe
 	the user's settings.

Thu Mar  9 22:29:03 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* locale/categories.def (LC_CTYPE): Merge CLASS_EB and CLASS_EL
 	into just CLASS.  Add standard/optional flag to all items.

	* locale/localeinfo.h (_NL_CURRENT_DEFINE): Fix typo.

	* ctype/ctype.h [__BYTE_ORDER == __LITTLE_ENDIAN] (_ISbit):
 	Rearrange defn to satisfy compiler.

	* locale/localeinfo.h: Declare _nl_current.

	* configure.in: Use AC_CHECK_TOOL for CC, AR, RANLIB.  Accept args
 	--enable-shared, --enable-profile, --enable-omitfp; pass settings
 	through to config.make.
	* config.make.in (build-shared, build-profile, build-omitfp): New
 	config vars.

	* elf/elf.h (STN_UNDEF): Renamed to SHN_UNDEF (typo).
	(DT_NUM): New macro.

	* locale/nl_langinfo.c: Include errno.h and stddef.h.  Fix typos.

	* locale/lc-ctype.c (_nl_postload_ctype): Fix macro insanity.

	* locale/loadlocale.c (_nl_load_locale) [! MAP_COPY]: Define
 	MAP_COPY to MAP_PRIVATE.

Thu Mar  9 17:16:53 1995  Brendan Kehoe  (brendan@zen.org)

	* sysdeps/alpha/divrem.m4: Undefine `ret' to avoid the definition
	that's used inside the alpha sysdep.h.

	* sysdeps/alpha/__longjmp.c (__longjmp): Remove obsolete __NORETURN
	keyword.
	* sysdeps/alpha/__math.h (__copysign): Remove obsolete __CONSTVALUE.

	* configure.in: Match `osf*', not `osf1*'.
	* configure: Likewise.
	* sysdeps/unix/bsd/osf: Renamed from `sysdeps/unix/bsd/osf1'.

Wed Mar  8 13:38:13 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* posix/glob/configure.bat: Fixes from DJ.

	* time/backward, time/europe, time/northamerica, time/pacificnew,
	time/zdump.c, time/zic.c, time/tzfile.h, time/private.h,
	time/ialloc.c: Code and data updated from ADO's 95b.
	* time/emkdir.c: File removed.
	* time/Makefile (distribute, extra-objs, zic): Omit it.

	* time/localtime.c: Deansideclized.  Never #define __tzname et al
 	to non-__ names.

	* locale/lc-ctype.c (__ctype_tolower, __ctype_toupper): Use int *
 	instead of short int *.
	* ctype/ctype-info.c: Likewise.
	* ctype/ctype.h: Likewise.

	* locale/langinfo.h (_NL_CTYPE_CLASS): Use this (just one) instead
 	of EB and EL versions.

Mon Mar  6 12:34:56 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* ctype/ctype.h (_ISbit): New macro, defined dependent on byte order.
	(_IS* enum): Use _ISbit to produce values.

Sun Mar  5 19:40:13 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* locale/localeinfo.h: Rewritten for new locale system, using
	locale data files and with <langinfo.h> interface.
	* locale/setlocale.c: Rewritten to use locale data files.
	* langinfo.h: New file.
        * locale/langinfo.h: New file.
        * locale/nl_langinfo.c: New file.
        * locale/loadlocale.c: New file.
        * locale/lc-ctype.c: New file.
        * locale/lc-messages.c: New file.
        * locale/lc-monetary.c: New file.
        * locale/lc-numeric.c: New file.
        * locale/lc-time.c: New file.
        * locale/categories.def: New file.
	* locale/Makefile (headers): Remove localeinfo.h.
	(distribute): New variable; put localeinfo.h here, and categories.def.
	(routines): Add loadlocale.
	(categories): New variable.
	(aux): Use that to get C-category and lc-category.
	* ctype/ctype.h (_IS*): Use independent bits for all but _ISalnum.
	* ctype/ctype-info.c: For initial tables, use
	_nl_C_LC_CTYPE_{class,toupper,tolower} constant tables defined in
	locale/C-ctype.c.
	* locale/C-ctype.c, locale/C-messages.c: New files.
 	* locale/C-monetary.c, locale/C-numeric.c, locale/C-time.c:
	Default "C" locale data updated for new locale system.
	* locale/C-collate.c: File removed.
        * locale/C-ctype_ct.c: File removed.
        * locale/C-ctype_mb.c: File removed.
        * locale/C-response.c: File removed.
	* locale/localeconv.c: Use _NL_CURRENT macro to access locale data.
	* stdio/printf_fp.c, stdio/vfprintf.c, stdio/vfscanf.c,
	  stdlib/strtod.c, time/asctime.c, time/strftime.c:
	Include ../locale/localeinfo.h and use _NL_CURRENT macro to access
	locale data.
	* time/localtime.c: Don't include <localeinfo.h>.
	* time/tzset.c: Don't use locale items for default TZ value or
	"GMT" string (use "UTC").

	* stdio/vfprintf.c [USE_IN_LIBIO] (PAD): Only call the function if
 	WIDTH>0; update DONE.

	* malloc/malloc.c (morecore): Fix last change to calculate by
 	blocks instead of bytes.

Fri Mar  3 12:24:52 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/generic/sys/mman.h (__mmap, __munmap): Declare these.
	* sysdeps/unix/sysv/irix4/sys/mman.h: Likewise.
	* sysdeps/unix/bsd/ultrix4/sys/mman.h: Likewise.
	* sysdeps/unix/bsd/osf1/sys/mman.h: Likewise.
	* sysdeps/unix/bsd/sun/sunos4/sys/mman.h: Likewise.
	* sysdeps/stub/munmap.c (munmap): Rename to __munmap, add weak
 	alias munmap.
	* sysdeps/unix/mman/munmap.S: Likewise.
	* sysdeps/mach/munmap.c: Likewise.
	* sysdeps/mach/hurd/mmap.c (mmap): Rename to __mmap, add weak
 	alias mmap.
	* sysdeps/unix/mman/mmap.S: Likewise.
	* sysdeps/unix/bsd/sun/sunos4/mmap.c: Likewise.
	* sysdeps/stub/mmap.c: Likewise.

	* sysdeps/unix/bsd/setsid.c: Use __getpgid instead of __getpgrp.

	* sysdeps/unix/dirfd.c: #undef dirfd before function defn.

Thu Mar  2 12:15:24 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* misc/search.h: Add missing semicolon.

	* sysdeps/unix/dirfd.c: Fix typo.

	* sysdeps/generic/sys/mman.h (mmap): Use __off_t instead of off_t
 	in decl.

	* stdio/vfscanf.c (%c): In no-assign case, fix loop to decrement
 	WIDTH before test.

Wed Mar  1 00:57:47 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* stdlib/strtod.c: Fixes from drepper.
	[IMPLICIT_ONE]: New macro, one for IEEE754 formats.
	* stdlib/strtold.c [IMPLICIT_ONE]: New macro, 0.
	* stdlib/strtof.c [IMPLICIT_ONE]: New macro, 1.

	* stdio/vfprintf.c: Correctly notice Z modifier.

	* misc/search.h: New file.
	* misc/Makefile (headers): Add search.h.
	* misc/insremque.c: Include search.h.
	(struct qelem): Type removed.

Mon Feb 27 07:00:57 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* elf/libelf.h: New file.
	* elf/elf_hash.c: New file.

Sun Feb 26 15:51:00 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	Changes from Germano Caronni <caronni@tik.ethz.ch>:
	* malloc/malloc.c (morecore): Account in NEWSIZE for the
 	malloc_info structures for each new block.

Sat Feb 25 02:17:52 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/kill.c: When the process has no message port
 	registered and we have its task port, translate a few signals to
 	task_suspend/task_resume/task_terminate.

Fri Feb 24 14:40:48 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* io/Makefile (routines): Add euidaccess.
	* sysdeps/mach/hurd/euidaccess.c: New file.
	* sysdeps/stub/euidaccess.c: New file.
	* posix/unistd.h [__USE_GNU] (euidaccess): Declare it.

	* dirent/Makefile (routines): Add dirfd.
	* sysdeps/stub/dirfd.c: New file.
	* sysdeps/unix/dirfd.c: New file.
	* sysdeps/unix/dirstream.h (_DIR_dirfd): New macro.
	* dirent/dirent.h (dirfd): Declare new function.  Define as macro
 	_DIR_dirfd if that is defined.
	* sysdeps/mach/hurd/dirstream.h (DIR): Replace `__port' member
 	with `void *__fd'.
	* sysdeps/mach/hurd/opendir.c: Use DIRP->__fd instead of DIRP->__port.
	Open the file with `open'; set FD_CLOEXEC on the fd.
	* sysdeps/mach/hurd/closedir.c: Likewise.
	* sysdeps/mach/hurd/readdir.c: Likewise.
	* sysdeps/mach/hurd/dirfd.c: New file.

	* posix/Makefile (glob/configure): Do cvs commit if there is a CVS
 	directory.
	(glob/ChangeLog): Likewise.

	* locale/locale.h (LC_*): Use small integers instead of bit masks.

	* stdio/bug4.c: Put temporary files in /tmp.
	* stdio/bug3.c: Likewise.
	* stdio/bug5.c: Likewise.
	* stdio/test-fseek.c: Likewise.
	* stdio/test-popen.c: Likewise.

Wed Feb 22 00:44:41 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* posix/glob/configure.in: Put AC_ISC_POSIX before AC_CONST.

	* libc-symbols.h (weak_symbol): New macro.

	* hurd/hurdsig.c (_hurd_internal_post_signal): Ignore preempter
 	elts with null handlers.

	* sysdeps/mach/hurd/i386/sigreturn.c: Restore the FPU state.

Tue Feb 21 21:53:30 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* stdlib/random.c (__srandom): Change algorithm used to populate
 	the state array.
	(randtbl): Recomputed with new algorithm.

	* sysdeps/sparc/Makefile [subdir=crypt] (crypt): Reset only if set
 	to original value of `crypt'.
	* sysdeps/unix/sysv/sysv4/solaris2/sparc/Makefile [subdir=crypt]
 	(crypt): New variable, set to crypt.solar.

Tue Feb 21 11:50:37 1995  Brendan Kehoe  (brendan@zen.org)

	* sysdeps/sparc/Makefile (routines): Reference `dotmul', not `mul'.

	* config.h.in: Put comment around ^L to pacify Solaris as here too.

Tue Feb 21 00:10:50 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* string/Makefile (distribute): Add pagecopy.h.
	* sysdeps/mach/pagecopy.h: New file.
	* sysdeps/generic/pagecopy.h: New file.
	* sysdeps/generic/memcpy.c: Include pagecopy.h; call
 	PAGE_COPY_FWD_MAYBE first when word aligned.
	* sysdeps/generic/memmove.c: Likewise.

	* misc/bsd-compat.c (longjmp, setjmp): Functions removed.
	(getpgrp): Call __getpgid instead of __getpgrp.

	* Makefile (subdirs): Add elf first.
	* elf/Makefile: New file.
	* elf/elf.h: New file.

	* sysdeps/unix/start.c (errno): Only define if it's not #define'd
 	as a macro.
	[! NO_UNDERSCORES]: Define `start' as a weak alias, not a symbol
	indirection.

	* csu/Makefile (crtstuff): New variable consolidates crti, crtn;
 	add crti_s, crtn_s.
	(install-lib, extra-objs, generated-, omit-deps): Use that.
	(initfini): New canned sequence, broken out of crt[in].s rule.
	(crt[in].s rule): Use it.
	(crt[in]_s.s): New rule.
	* csu/initfini.c (GLOBAL): New macro; define it to empty if undefined.
	(_init, _fini): Use GLOBAL as storage class.
	Add self reference to avoid GCC optimizing out the functions.

	* Makefile (headers): Remove $(stddef.h).
	* Makeconfig (stddef.h): Variable removed; now require gcc version
 	>= 2.2.
	* stddef.h: File removed.

Mon Feb 20 19:42:31 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/unix/bsd/ultrix4/mips/start.S: Remove `__environ'
 	definition.
	* sysdeps/unix/bsd/osf1/alpha/start.S: Likewise.

	* stdlib/strtod.c: Allow the string to start with a decimal point
 	without a leading zero.

Mon Feb 20 04:04:57 1995  Roland McGrath  <roland@duality.gnu.ai.mit.edu>

	* Makefile (subdirs): Put csu first.

	* sysdeps/mach/hurd/start.c: Include unistd.h for __environ decl.

	* Makeconfig [elf=yes] (+preinit, +postinit): New variables, set
 	to crt[in].o.
	(csu-objpfx): New variable.
	(+link): Use it to find start.o and $(+preinit), $(+postinit).

	* Rules (subdir_lib, all): Depend on objs.

	* config.h.in [HAVE_ELF || HAVE_GNU_LD]: Define HAVE_WEAK_SYMBOLS.

	* stdlib/strtod.c (PASTE, PASTE1): New helper macros; use these in
 	access to float.h macros.

	* misc/efgcvt.c: New file.
	* misc/Makefile (routines): Add efgcvt.

Sun Feb 19 20:10:43 1995  Brendan Kehoe  <brendan@zen.org>

	* sysdeps/sparc/mul.S: Renamed to `dotmul.S'.
        * sysdeps/sparc/Makefile (routines): Reference `dotmul.S', not `mul.S',
        to avoid a misreference that would override sysdeps/generic/mul.c.
	* sysdeps/sparc/Dist: Likewise.

Sun Feb 19 17:46:13 1995  Roland McGrath  <roland@duality.gnu.ai.mit.edu>

	* posix/Makefile (aux): Add environ.
	* posix/environ.c: New file.
	* sysdeps/unix/sparc/start.c: Remove __environ definition.
	* sysdeps/unix/start.c: Likewise.
	* sysdeps/unix/sysv/irix4/start.c: Likewise.
	* sysdeps/mach/hurd/start.c: Likewise.
	* sysdeps/mach/start.c: Likewise.
	* sysdeps/stub/start.c: Likewise.

	* sysdeps/unix/make_errlist.c: In produced program, test
 	HAVE_WEAK_SYMBOLS instead of HAVE_GNU_LD.
	* sysdeps/unix/sysv/sysv4/dup2.c: Fix #include of renamed file.
  	Remove extra weak alias.

	* sysdeps/unix/sysv/sysv4/sigaltstack.S: Fix unsquashed file name
 	in #include.

	* libc-symbols.h: Put comment around ^L to pacify Solaris as.

	* sysdeps/posix/Makefile (cded-objdir-includes): New variable
 	replaced cded-objdir-CPPFLAGS; transform $(+includes) instead of
 	$(CPPFLAGS).
	(mk-stdiolim): Use it instead.

Fri Feb 17 12:16:27 1995  Roland McGrath  <roland@duality.gnu.ai.mit.edu>

	* mach/mach_init.c (__vm_page_size): Make it initialized.  It does
 	not work to make a weak alias to a bss symbol.

	* stdio/Makefile (distribute): Remove mpn-copy.mk; add gen-mpn-copy.
	(tests): Add test-fwrite.
	* stdio/test-fwrite.c: New file.

	* stdlib/stdlib.h [__USE_GNU]: Declare strtof, strtold, __strtof,
 	__strtold.

	* Makefile (autoconf-it): New canned sequence.  Do cvs commit if
 	there is a CVS directory.
	(configure, %/configure): Use $(autoconf-it) for cmds.
	* Make-dist: Likewise.
	* sysdeps/mach/hurd/Makefile (errlist.c, errnos.h): Do cvs commit
 	if there is a CVS directory.
	* sysdeps/sparc/Makefile (divrem output): Likewise.
	* sysdeps/alpha/Makefile (divrem output): Likewise.
	* Makerules ($(gpl2lgpl)): Likewise.

	* Makerules (rule to install lib%.a from $(install-lib)): Fix
 	patsubst to elide ranlib for $(non-lib.a).

	* stdio/tst-printf.c: Enable FP tests.  Add some new tests from rfg.

Thu Feb 16 04:06:06 1995  Roland McGrath  <roland@duality.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/mig-reply.c: Add weak aliases to non-__ names.
	* mach/mig-dealloc.c: Add weak alias mig_deallocate.

Wed Feb 15 13:34:01 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* hurd/hurd/signal.h (HURD_MSGPORT_RPC): Take new arg
 	DEALLOC_REFPORT; deallocate the refport after use only if it
 	evaluates to nonzero.
	* sysdeps/mach/hurd/kill.c: Pass DEALLOC_REFPORT arg of one.
	* hurd/hurdkill.c: Pass DEALLOC_REFPORT arg of zero.

	* hurd/hurdsig.c (abort_rpcs): Take new arg int *STATE_CHANGE; set
 	*STATE_CHANGE to indicate whether or not we changed *STATE and it
 	should be committed to the thread.
	(abort_all_rpcs): Take new arg LIVE; if nonzero and abort_rpcs changes
	state for a thread, do thread_set_state on that thread.  Don't use
 	SS->intr_port for collecting reply ports, it is not safe to
 	clobber that when suspending; instead, alloca a temporary array.
	(_hurd_internal_post_signal): Pass LIVE flag to abort_all_rpcs:
	zero when dying, one when suspending.  Pass new arg to abort_rpcs.

	* sysdeps/mach/hurd/stdio_init.c: Don't lock the file descriptor;
 	HURD_FD_PORT_USE will.  Don't use critical sections around
 	HURD_FD_PORT_USE invocations.

	* sysdeps/mach/hurd/stdio_init.c: Don't make pipes/FIFOs unbuffered.
	* sysdeps/posix/stdio_init.c: Likewise.

Tue Feb 14 03:01:12 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* hurd/hurd/fd.h (_hurd_fd_get): Don't do critical section
 	locking; don't leave the descriptor locked on return.
	(HURD_FD_PORT_USE): Don't expect _hurd_fd_get to return the fd locked.
	Use a critical section around locking the descriptor.
	Check for an empty descriptor and return EBADF.
	* sysdeps/mach/hurd/dup2.c: Likewise.
	* sysdeps/mach/hurd/fcntl.c: Likewise.
	Use HURD_FD_PORT_USE macro for RPCs.
	* sysdeps/mach/hurd/sysd-stdio.c: Don't lock the descriptor before
 	using HURD_FD_PORT_USE.
	* sysdeps/mach/hurd/defs.c (init_stdio): Don't expect _hurd_fd_get
 	to lock the descriptor.
	* sysdeps/mach/hurd/stdio_init.c: Use critical sections while
 	locking the descriptor.
	* sysdeps/mach/hurd/fdopen.c: Likewise.
	* hurd/fd-close.c: Likewise.
	Don't expect the descriptor to be locked on entry.
	Check for empty descriptor and return EBADF.

	Factor ctty RPC code for SIGTTIN/SIGTTOU generation out into
	new functions _hurd_ctty_input and _hurd_ctty_output, each
	called with (io_t port, io_t ctty, error_t (*rpc) (io_t)).
	* hurd/ctty-input.c: New file.
	* hurd/ctty-output.c: New file.
	* hurd/Makefile (dtable): Add ctty-input and ctty-output.
	* hurd/fd-read.c: Use _hurd_ctty_input.
	* hurd/fd-write.c: Use _hurd_ctty_output.
	* sysdeps/mach/hurd/ioctl.c: Likewise.
	* hurd/hurd/fd.h (_hurd_ctty_input, _hurd_ctty_output): Declare them.

Mon Feb 13 11:36:12 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* stdio/vfscanf.c (%e, %f, %g): Use strtod, __strtold, or __strtof
 	as appropriate to the type.

	* sysdeps/ieee754/huge_val.h (__huge_val_t): New macro to avoid
 	repeating the union.
	(HUGE_VAL, __huge_val): Use it.
	[__USE_GNU] (HUGE_VALf, HUGE_VALl): New macros, along with
	analogous macros to HUGE_VAL's: __huge_val[fl]_t, __HUGE_VAL[fl]_bytes.
	* stdlib/strtold.c (FLOAT_HUGE_VAL): Define this to HUGE_VALl.
	(STRTOF): Set to __strtold; define strtold as weak alias.
	* stdlib/strtof.c (FLOAT_HUGE_VAL): Define this to HUGE_VALf.
	(STRTOF): Set to __strtof; define strtof as weak alias.

	* sysdeps/ieee754/ieee754.h (union ieee754_float): New type.
	(IEEE754_FLOAT_BIAS): New macro.

	* sysdeps/ieee754/mpn2ldbl.c: Fix typos.

	* stdlib/testmb.c: Add tests from rfg for using normal chars as
 	multibyte chars.

	* hurd/hurdmalloc.c (malloc_init): Add self reference to avoid not
 	only the `defined but not used' warning, but also to avoid GCC
 	optimizing out the entire function (!).

	* stdlib/wctomb.c: Include ctype.h.

	* Makerules (install-lib-non.a): Don't include $(non-lib.a).

	* hurd/hurdmalloc.c: Include string.h; #define bcopy using memcpy.

Sat Feb 11 04:05:29 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* stdio/printf_fp.c: Include "fpioconst.h".
	(_tens_p): Table moved to fpioconst.c, renamed to _fpioconst_pow10.
	(__printf_fp): All references changed.
	Don't bother computing THOUSANDS_SEP if GROUPING is empty.
	(group_number): Use memmove instead of memcpy, since operands overlap.
	* stdio/fpioconst.c: New file, tables broken out of stdio/printf_fp.c.
	* stdio/fpioconst.h: New file, header declaring the table data.
	* stdio/Makefile (aux): Add fpioconst.
	(distribute): Add fpioconst.h.
	* stdlib/strtod.c: Complete rewrite from drepper.
	* stdlib/strtof.c: New file.
	* stdlib/strtold.c: New file.
	* stdlib/Makefile (routines): Add strtof, strtold.
	* stdio/Makefile (routines): Add mpn2flt, mpn2dbl, mpn2ldbl.
	* sysdeps/stub/mpn2flt.c: New file.
	* sysdeps/stub/mpn2dbl.c: New file.
	* sysdeps/stub/mpn2ldbl.c: New file.
	* sysdeps/ieee754/mpn2flt.c: New file.
	* sysdeps/ieee754/mpn2dbl.c: New file.
	* sysdeps/ieee754/mpn2ldbl.c: New file.

	* Makerules (install-lib.a): Don't filter out $(non-lib.a).
	($(install-lib.a) in $(libdir) rule): Elide ranlib command when $@
	appears in $(non-lib.a).

Fri Feb 10 17:20:14 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* stdlib/wctomb.c: A normal ASCII character translates to itself.
	* stdlib/mbtowc.c: Likewise.

Thu Feb  9 03:55:55 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* setjmp/setjmp.h (longjmp, _longjmp, __longjmp, siglongjmp):
 	Remove `const' from prototypes.
	* sysdeps/m68k/__longjmp.c: Likewise.
	* setjmp/longjmp.c: Likewise.
	* sysdeps/i386/__longjmp.c: Likewise.

	* sysdeps/posix/tempname.c: Increment *IDX at beginning of loop,
 	so when we return a name, it is incremented past the value that
 	produces that same name.

	* stdio/fgets.c (fgets): Change `size_t' to `int' in prototype.  Sigh.
	* stdio/stdio.h (fgets): Likewise.

	* stdio/vfprintf.c (printf_unknown): Print ' for INFO->group flag.

	* hurd/fd-write.c: Don't clobber ERR with the msg_sig_post call
 	when it's EBACKGROUND; we need to notice that it is EBACKGROUND
 	and retry the RPC.
	* hurd/fd-read.c: Likewise.

Wed Feb  8 05:01:11 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/sysdep.h (FATAL_PREPARE_INCLUDE): New macro, set to
 	<mach/mig_support.h>.
	* assert/assert-perr.c [FATAL_PREPARE_INCLUDE]: Include it.
	* assert/assert.c: Likewise.
	* sysdeps/posix/libc_fatal.c: Likewise.

Tue Feb  7 12:17:58 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* stdio/stdio.h [__STRICT_ANSI__] (stdin, stdout, stderr): Define
	as macros, to satisfy ANSI pedants.

	* stdio/internals.c (flushbuf): When there is no new data after
 	priming the stream, return without writing out the buffer.
	* stdio/Makefile (tests): Add bug7.
	* stdio/bug7.c: New file.

	* io/sys/stat.h (S_IFIFO, S_IFLNK, S_IFSOCK, S_ISFIFO, S_ISLNK,
 	S_ISSOCK): Define only if the corresponding underlying __S_IF* macro
 	is defined.

	* stdio/getdelim.c: Decrement COPY after getting a char from __fillbf.

	* stdio/Makefile (tests): Add errnobug.
	* stdio/errnobug.c: New file.

	* mach/mig_strncpy.c: Include string.h.

	* sysdeps/mach/sysdep.h: Don't #include <mach/mig_support.h>.  Its
 	inlines cause trouble for files defining global register variables.

	* stdio/vfprintf.c: Use _strerror_internal for %m.

	* sysdeps/ieee754/dbl2mpn.c: Fixes from drepper for 64-bit limbs.

	* stdio/printf.h (struct printf_info): New member `group', for %' flag.
	* stdio/printf-prs.c (parse_printf_format): Grok %' flag and set flag.
	* stdio/vfprintf.c (group_number): New function.
	(vfprintf): Support %' flag for integer formats, by calling
	group_number after formatting the number in WORK.
	* stdio/printf_fp.c (guess_grouping, group_number): New functions.
	(__printf_fp): Implement `group' flag using them.

	* Makefile (include sysd-dirs): Protect with ifndef avoid-generated.
	(parent-clean): Remove sysd-rules, not sysdirs.
	(distclean): Pass avoid-generated=yes to submake.
	(distclean-1): Remove $(sysdep-$(distclean-1)).

	* Makerules (objects, objs): Depend on $(extra-objs) too.
	(include sysd-Makefile): Protect with ifndef avoid-generated.

	* Makeconfig (+defines, +gnu-stabs, gnu-as): Variables removed.
	(CPPFLAGS): Use $(defines) in place of $(+defines).
	Replace -D_LIBC with -include $(..)libc-symbols.h.

	* stdio/freopen.c: Set seen bit before calling fclose.

Mon Feb  6 18:34:40 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/setpriority.c: Keep track of numbers of
 	successes and each kind of failure.  Return EPERM or EACCES only
 	if every task failed that way.

	* sysdeps/mach/hurd/getpriority.c: Handle out of band buffers
 	correctly.

	* sysdeps/mach/hurd/ptrace.c (PTRACE_ATTACH, PTRACE_DETACH): Stop
 	or resume the process after frobbing.

	* hurd/hurdsig.c: Use spin lock operations on sigstate locks
	throughout.
	(_hurd_thread_sigstate): Don't lock the sigstate lock.
	(_hurd_internal_post_signal): New subfunction `mark_pending'; replace
	repeated sequences with calls to it.  Don't expect the sigstate
 	lock to be held on entry; lock it just before examining sigaction.
  	In handler case, check SS->critical_section after calling
 	abort_rpcs; if set, mark the signal pending and resume the thread.
	* hurd/hurd/signal.h (_hurd_self_sigstate_unlocked): Function removed.
	(_hurd_self_sigstate): Don't lock the sigstate lock.
	(HURD_EINTR_RPC): Call _hurd_self_sigstate instead of
	_hurd_self_sigstate_unlocked.
	* hurd/msgportdemux.c: Don't expect _hurd_self_sigstate to lock
	the sigstate lock.
	* hurd/hurdexec.c: Use spin lock operations on sigstate lock.
  	Don't expect _hurd_self_sigstate to lock it.  Fix critical section
 	locking.
	* hurd/hurd-raise.c: Likewise.
	* sysdeps/mach/hurd/sigsuspend.c: Likewise.
	* sysdeps/mach/hurd/sigpending.c: Likewise.
	* sysdeps/mach/hurd/sigaltstack.c: Likewise.
	* sysdeps/mach/hurd/sigaction.c: Likewise.
	* sysdeps/mach/hurd/sigprocmask.c: Likewise.
	* hurd/fd-write.c: Likewise.
	* hurd/fd-read.c: Likewise.
	* sysdeps/mach/hurd/ioctl.c: Likewise.
	* sysdeps/mach/hurd/fork.c: Likewise.
	* sysdeps/mach/hurd/i386/sigreturn.c: Likewise.
	* sysdeps/mach/hurd/mips/sigreturn.c: Likewise.
	* sysdeps/mach/hurd/alpha/sigreturn.c: Likewise.
	* hurd/hurdmsg.c (get_int): Likewise.

	* stdio/vfprintf.c: Include stddef.h.  Fix typos in libio code.

	* stdio/vfprintf.c (__pad): Function renamed to __printf_pad, made
 	global.
	(PAD): Caller changed.
	* stdio/printf_fp.c (__pad): Function removed.
	(PAD): Use __printf_pad instead.

Sun Feb  5 17:59:53 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	Merged new FP printer by Ulrich Drepper.
	* stdio/printf_fp.c: Rewrite by drepper.
	* stdio/Makefile (routines): Add ldbl2mpn.
	* sysdeps/ieee754/ieee754.h (union ieee754_double): Add `ieee_nan'
 	member.
	(union ieee854_long_double): New type, from drepper.
	(IEEE754_DOUBLE_BIAS, IEEE854_LONG_DOUBLE_BIAS): New macros.
	* sysdeps/ieee754/ldbl2mpn.c: New file, by drepper.
	* sysdeps/stub/ldbl2mpn.c: New file.
	* math/Makefile (routines): Add isinfl and isnanl.
	* sysdeps/ieee754/isinfl.c: New file.
	* sysdeps/stub/isinfl.c: New file.
	* sysdeps/ieee754/isnanl.c: New file.
	* sysdeps/stub/isnanl.c: New file.

	* malloc/malloc.c (__malloc_extra_blocks): New variable.
	(malloc): When getting more core, get __malloc_extra_blocks extra;
	put the new block at the end of the free list and let the next loop
 	iteration use the initial portion of it.
	* malloc/free.c (_free_internal): Account for twice
 	__malloc_extra_blocks in deciding if we have so much extra memory
 	we should return it to the system.
	* malloc/malloc.h (__malloc_extra_blocks): Declare it.
	* posix/glob.c (prefix_array, glob_pattern_p): Remove gratuitous
 	const in parameter decl.

	* sysdeps/unix/mips/sysdep.h (ENTRY): Add `.ent' directive.

Fri Feb  3 18:15:52 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* munch.awk (EXTERNS): Print decls using __P instead of EXFUN.

	* sysdeps/mips/setjmp_aux.c: Use ENV[0].__jmpbuf[0].
	* sysdeps/mips/bsd-_setjmp.S: Use `li' insn instead of `move'.
	* sysdeps/mips/bsd-setjmp.S: Likewise.
	* sysdeps/mips/__longjmp.c: Remove obsolete __NORETURN keyword.
	* sysdeps/mach/hurd/mips/trampoline.c (_hurd_setup_sighandler):
 	Use `long int' for sigcode.  Use explicit register numbers instead
 	of names.
	(_hurdsig_rcv_interrupted_p): Use _hurdsig_catch_fault.
	* sysdeps/mach/hurd/mips/exc2signal.c: Use `long int' for sigcode.

Thu Feb  2 20:06:45 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* hurd/hurdmalloc.c: Remove bogus bcopy decl.

	* mach/mig_strncpy.c: Add missing `const' in prototype.  Rewritten
 	using __stpncpy.

	* io/ftw.c (ftw, ftw_dir): Treat ENOENT from stat like EACCES.

	* stdio/vfprintf.c: Set PREC to zero for %. without following digit.

Tue Jan 31 13:49:57 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* mach/mig_strncpy.c: Include mach.h instead of string.h.  Use
 	vm_size_t instead of size_t for arg and return types.

	* mach/mach_init.c: Don't declare __mig_init; mach/mig_support.h
 	already does.

Mon Jan 30 00:33:35 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* set-hooks.h (RUN_HOOK): Dereference PTR properly.

	* configure.in (friendly stddef.h check): Write override defn for
 	`stddef.h' Make variable.
	(AC_LINK_FILES): Use `echo ...` to avoid " " appearing nonempty.

	* configure.in (host_os=sysv4*|solaris2*): Set elf=yes.

	* Rules ($(objpfx)dummy.o): Write an empty function, not just an
 	empty file.

	* sysdeps/sparc/Makefile (sysdep-realclean): New variable.

Sat Jan 28 03:38:56 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* Makefile (distribute): Remove gnu-stabs.h; add libc-symbols.h.

	* sysdeps/mach/sysdep.h [ASSEMBLER]: Protect include of
 	mach/machine/syscall_sw.h with this.

Fri Jan 27 18:33:20 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* hurd/hurd/signal.h: Include <hurd/msg.h>, and <spin-lock.h>
 	instead of <lock-intern.h>.
	(struct hurd_sigstate): Member `lock' changed to a `spin_lock_t'.
	(_hurd_critical_section_lock): Use spin lock operators.
	Don't hold the sigstate lock, unlock it after setting the flag.
	(_hurd_critical_section_unlock): Take the sigstate lock
	to clear the flag; while holding it, check pending signals.  After
 	unlocking, sig_post ourselves if there were pending signals.

	* hurd/catch-exc.c (_S_catch_exception_raise): Don't take the
 	sigstate lock.  If it is locked, clear SS->critical_section and
 	SS->context, and unlock it.

	* sysdeps/mach/sysdep.h (EXT, LEXT): New macros.

	* set-init.c (__libc_init) [HAVE_ELF]: Run _init and atexit (_fini).
	* munch-tmpl.c: Likewise.

	* mach/Makefile (routines): Don't filter out syscall_% from
 	$(mach-syscalls).

Fri Jan 27 17:53:49 1995  Jim Meyering  (meyering@comco.com)

	* posix/fnmatch.c: Declare errno if it's not defined.
	That's simpler than testing #if !defined(__GNU_LIBRARY__)
	&& !defined(STDC_HEADERS).

Fri Jan 27 15:40:29 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* csu/Makefile: New file.
	* csu/initfini.c: New file.
	* Makefile (+other_dirs): Add csu.
	(+init): Variable renamed to libc-init.  All references changed.
	(aux): Remove start.
	(install-lib): Variable removed.
	(crt0.o, Mcrt1.o  crt1.o): Targets removed.

	* mach/Machrules (static deps of RPC_*.o): Add $(..)libc-symbols.h
	and $(objpfx)config.h.
	(static deps of RPC alias *.o): Removed.

	* sysdeps/unix/sysv/sysv4/solaris2/sparc/sysdep.h [ASSEMBLER]:
 	Protect macros with this.
	* sysdeps/unix/bsd/osf1/alpha/sysdep.h: Likewise.
	* sysdeps/unix/bsd/sequent/i386/sysdep.h: Likewise.
	* sysdeps/unix/bsd/vax/sysdep.h: Likewise.
	* sysdeps/unix/bsd/sun/m68k/sysdep.h: Likewise.
	* sysdeps/unix/bsd/sony/newsos/m68k/sysdep.h: Likewise.
	* sysdeps/unix/mips/sysdep.h: Likewise.

Thu Jan 26 00:02:01 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* Makerules (compile.[Sc]): Match gcc in $(CC) better.
	(BUILD_CFLAGS): Instead of $(config-defines), use -include config.h.

	* hurd/intr-rpc.awk: Emit weak alias.

	* sysdeps/unix/bsd/sun/sunos4/wait4.c: Call getpgrp instead of
 	__getpgrp.

	* sysdeps/unix/bsd/hp/m68k/sysdep.h [ASSEMBLER]: Protect macros with
 	this.
	* sysdeps/unix/i386/sysdep.h: Likewise.
	* sysdeps/unix/sparc/sysdep.h: Likewise.

	* io/ftw.c: Avoid `ret' as variable name.
	* posix/glob.c: Likewise.

	* ctype/ctype.h (_ISalpha): Define as its own bit.
	* locale/C-ctype_ct.c (__ctype_b_C): Set _ISalpha bit in all letters.

	* stdlib/exit.c [HAVE_GNU_LD]: Protect #include "set-hooks.h" and
 	DEFINE_HOOK with this.

Wed Jan 25 00:45:56 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* hurd/hurdinit.c: Use DECLARE_HOOK instead of `extern DEFINE_HOOK'.
	* mach/spin-solid.c (spin_lock_solid): Define as weak alias to __name.
	* mach/shortcut.awk: Emit weak alias.
	* mach/spin-lock.c: Add weak aliases for all spin-lock.h functions.
	* mach/mach_init.c (mach_init, vm_page_size): Defin weak aliases for
 	__ names.
	* mach/Makefile (lock): Remove spin-syms.
	(routines): Remove __ names, vm_page_size, msgserver_t.
	($(mach-syscalls) rule): Generate files without __, add weak alias.
	Remove symbol alias file rule.
	($(mach-shortcuts) rule): Likewise.
	[!mach-shortcuts] (user-interfaces): Filter out mach/mach4 too.
	* mach/Machrules (if-calls.c): Variable and rule removed.
	(interface-headers): Don't add $($(if)-calls).
	(transform-user-stub): Define to add weak alias.
	* set-hooks.h: Use new libc-symbols.h set access macros.
	* time/Makefile (routines): Remove __ names.
	(aux): Variable removed.
	* hurd/Makefile: Likewise.
	* sysdeps/unix/start.c (environ): Define as weak alias for __environ.
	(data_start): Define as weak alias for __data_start.
	* sysdeps/mach/hurd/start.c: Likewise.
	* sysdeps/unix/sparc/start.c: Likewise.
	* sysdeps/unix/make_errlist.c: Emit weak aliases for sys_nerr and
 	sys_errlist.
	* sysdeps/mach/hurd/errlist.awk: Likewise.
	* sysdeps/unix/bsd/osf1/alpha/start.S (environ): Define as weak
 	alias for __environ.
	* sysdeps/unix/bsd/ultrix4/mips/start.S: Likewise.
	* sysdeps/stub/setdomain.c: Use new stub_warning macro.
	* sysdeps/stub/getdomain.c: Likewise.
	* sysdeps/stub/vhangup.c: Likewise.
	* sysdeps/stub/swapon.c: Likewise.
	* sysdeps/stub/sendmsg.c: Likewise.
	* sysdeps/stub/recvmsg.c: Likewise.
	* sysdeps/stub/acct.c: Likewise.
	* sysdeps/stub/isinf.c: Likewise.  Add weak alias isinf for __isinf.
	* sysdeps/mach/hurd/_exit.c: Remove obsolete __NORETURN keyword.
	* sysdeps/posix/libc_fatal.c: Likewise.
	* sysdeps/i386/abort.c: Likewise.
	* sysdeps/i386/__longjmp.c: Likewise.
	* sysdeps/generic/make_siglist.c: Emit defn always for
 	_sys_siglist.  Emit weak alias to sys_siglist.
	* sysdeps/generic/atan.c: Remove obsolete __CONSTVALUE keyword.
	* sysdeps/ieee754/log10.c: Likewise.
	* time/difftime.c: Likewise.
	* stdlib/random.c (srand): Define as weak alias for __srandom.
	* stdlib/exit.c: Remove obsolete __NORETURN keyword.  Use set-hooks
 	macros for __libc_atexit.
	* stdlib/Makefile (routines): Remove __random, srand.
	* stdio/gets.c: Use new link_warning macro instead of old
 	warn_references.
	* stdio/Makefile (routines): Remove __ names.
	(aux): Remove syms-stdio.
	* socket/Makefile (routines): Added e on getpeernam and getsocknam.
	* setjmp/longjmp.c: Remove obsolete __NORETURN keyword.
	* setjmp/Makefile (routines): Remove _longjmp, siglongjmp.
	* setjmp/setjmp.h: Replace __NORETURN keyword with __attribute__ uses.
	* stdio/stdio.h: Likewise.
	* misc/Makefile (routines): Remove __ names.
	(aux): Remove data_start.
	* sysdeps/mach/hurd/defs.c: Don't include gnu-stabs.h.
	* sysdeps/mach/hurd/brk.c: Likewise.
	* hurd/hurdid.c: Likewise.
	* hurd/hurdpid.c: Likewise.
	* hurd/openport.c: Likewise.
	* hurd/hurdsock.c: Likewise.
	* hurd/hurdsig.c: Likewise.
	* hurd/hurdrlimit.c: Likewise.
	* hurd/hurdmalloc.c: Likewise.
	* hurd/dtable.c: Likewise.
	* hurd/setauth.c: Likewise.
	* misc/progname.c: Likewise.
	* misc/init-misc.c: Likewise.
	* sysdeps/generic/vfork.c: Likewise.
	* sysdeps/unix/bsd/init-posix.c: Likewise.
	* math/math.h: Replace __CONSTVALUE keyword with __attribute__ uses.
	* time/time.h: Likewise.
	* math/Makefile (routines): Remove __ names.
	* io/Makefile: Likewise.
	* termios/Makefile: Likewise.
	* resource/Makefile: Likewise.
	* signal/Makefile: Likewise.
	* dirent/Makefile: Likewise.
	* assert/assert.h: Replace __NORETURN keyword with __attribute__
 	uses.  Functions return void and macros deal with this.
	* assert/assert-perr.c: Remove obsolete __NORETURN keyword.
  	Return void.  Don't include gnu-stabs.h.
	* assert/assert.c: Likewise.
	* posix/Makefile (routines): Remove __ names, setpgrp.  Add
 	getpgid.
	(aux): Remove environ.
	* stdlib/stdlib.h (abort, exit): Replace __NORETURN keyword with
 	__attribute__ use.
	* posix/unistd.h (_exit): Likewise.
	(__getpgrp, __setpgrp): Declarations removed.
	(__getpgid, getpid): Declare these.

	* configure.in (host_os=gnuelf|linuxelf): Set elf=yes.  Do AC_SUBST
 	for gnu_ld, gnu_as, elf, and weak.  Call AC_LINK_FILEES on
 	$libc_link_{sources,dests}.
	* sysdeps/unix/configure.in: Remove __ from file names.  Don't
 	create files, just add to libc_link_{dests,sources}.

	* config.make.in (gnu-as, gnu-ld, elf, weak-symbols): New variables.

	* config.h.in: Add #undefs used by sysdeps configures.

	* sysdeps/unix/sysv/sysv4/Makefile (sysdep_routines): Removed
 	__setpgid, __getpgid.
	* sysdeps/unix/sysv/sco3.2.4/setpgid.c: Included file was renamed
 	from setpgrp.c.
	* sysdeps/unix/sysv/sco3.2.4/getpgid.c: Included file was renamed
 	from __getpgrp.c.
	* sysdeps/unix/bsd/getpgrp.c: File removed.
	* sysdeps/generic/getpgrp.c: Moved from sysdeps/stub/getpgrp.c.
	Call __getpgid with zero.
	* sysdeps/stub/setpgid.c: Renamed __setpgrp to __setpgid, added
 	weak aliases setpgid and setpgrp.
	* sysdeps/unix/sysv/irix4/setpgid.S: Likewise.
	* sysdeps/unix/common/setpgid.S: Likewise.
	* sysdeps/mach/hurd/setpgid.c: Likewise.
	* sysdeps/unix/sysv/sysv4/setpgid.c: Likewise.
	Use subcall 5 to __pgrpsys.
	* sysdeps/stub/getpgid.c: Renamed __getpgrp to __getpgid, added
 	weak alias getpgid.
	* sysdeps/mach/hurd/getpgid.c: Likewise.
	* sysdeps/unix/sysv/irix4/getpgid.S: Likewise.
	* sysdeps/unix/common/getpgid.S: Likewise.
	* sysdeps/unix/sysv/sysv4/getpgid.c: Likewise.
	Use subcall 4 to __pgrpsys.
	* sysdeps/stub/__getpgrp.c: Renamed to getpgid.c.
	* sysdeps/unix/sysv/sysv4/__getpgrp.c: Renamed to getpgid.c.
	* sysdeps/unix/sysv/sco3.2.4/__getpgrp.c: Renamed to getpgid.c.
	* sysdeps/unix/sysv/irix4/__getpgrp.S: Renamed to getpgid.S.
	* sysdeps/unix/common/__getpgrp.S: Renamed to getpgid.S.
	* sysdeps/mach/hurd/__getpgrp.c: Renamed to getpgid.c.
	* sysdeps/stub/setpgrp.c: Renamed to setpgid.c.
	* sysdeps/unix/sysv/sysv4/setpgrp.c: Renamed to setpgid.c.
	* sysdeps/unix/sysv/sco3.2.4/setpgrp.c: Renamed to setpgid.c.
	* sysdeps/unix/sysv/irix4/setpgrp.S: Renamed to setpgid.S.
	* sysdeps/unix/common/setpgrp.S: Renamed to setpgid.S.
	* sysdeps/mach/hurd/setpgrp.c: Renamed to setpgid.c.

	* sysdeps/unix/bsd/hp/m68k/getdents.S: Included file was renamed
 	from __getdents.S.

	* sysdeps/posix/defs.c: Don't include gnu-stabs.h.
	* sysdeps/stub/sigpending.c: Use new libc-symbols.h macro for stub
 	warning.
	* sysdeps/stub/fexecve.c: Likewise.
	* sysdeps/stub/fchdir.c: Likewise.
	* sysdeps/stub/fchflags.c: Likewise.
	* sysdeps/stub/chflags.c: Likewise.

	* sysdeps/m68k/__longjmp.c: Remove __NORETURN; it's obsolete.
	* sysdeps/generic/abort.c: Likewise.
	* sysdeps/ieee754/ldexp.c: Remove __CONSTVALUE; it's obsolete.

	* hurd/hurdioctl.c: Include hurd/ioctl.h.
	(_hurd_ioctl_handler_lists): Define this set.
	(_hurd_lookup_ioctl_handler): New function.
	* hurd/hurd/fd.h: ioctl handler stuff moved to hurd/ioctl.h.
	* hurd/hurd/ioctl.h: New file, broken out of hurd/fd.h.
	(_hurd_lookup_ioctl_handler): Declare it.
	(ioctl_handler_t): New typedef.  Use it throughout.
	* sysdeps/mach/hurd/ioctl.c: Include hurd/ioctl.h.
	(_hurd_ioctl_handler_lists): Don't define.
	(__ioctl): Call _hurd_lookup_ioctl_handler.

	* stdlib/strtol.c (maxquad): Make this const.
	[__GNUC__ == 2 && __GNUC_MINOR__ < 7]: Only use maxquad in this case.

	* posix/glob/configure.in: Put AC_AIX and AC_MINIX early, before
 	any compile tests.

	* sysdeps/mach/hurd/setitimer.c (timer_thread): Call
 	__msg_sig_post_request, not __sig_post_request.

	* misc/getusersh.c: Renamed to getusershell.c.
	* sysdeps/stub/sethostnam.c: Renamed to sethostname.c.
	* sysdeps/unix/inet/sethostnam.S: Renamed to sethostname.S.
	* sysdeps/unix/sysv/sysv4/sethostnam.c: Renamed to sethostname.c.
	* sysdeps/mach/hurd/sethostnam.c: Renamed to sethostname.c.

Tue Jan 24 00:14:30 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/stub/settod.c: Renamed to settimeofday.c.
	* sysdeps/unix/bsd/settod.S: Renamed to settimeofday.c.
	* sysdeps/unix/sysv/settod.c: Renamed to settimeofday.c.
	* sysdeps/mach/hurd/settod.c: Renamed to settimeofday.c.
	* sysdeps/stub/setitmr.c: Renamed to setitimer.c.
	* sysdeps/unix/common/setitmr.S: Renamed to setitimer.S.
	* sysdeps/mach/hurd/setitmr.c: Renamed to setitimer.c.
	* sysdeps/posix/fpathcon.c: Renamed to fpathconf.c.
	* sysdeps/stub/fpathcon.c: Renamed to fpathconf.c.
	* sysdeps/unix/sysv/irix4/fpathcon.c: Renamed to fpathconf.c.
	* sysdeps/stub/getprio.c: Renamed to getpriority.c.
	* sysdeps/unix/sysv/irix4/getprio.c: Renamed to getpriority.c.
	* sysdeps/unix/common/getprio.S: Renamed to getpriority.S.
	* sysdeps/mach/hurd/getprio.c: Renamed to getpriority.c.
	* sysdeps/stub/setprio.c: Renamed to setpriority.c.
	* sysdeps/unix/sysv/irix4/setprio.c: Renamed to setpriority.c.
	* sysdeps/unix/common/setprio.S: Renamed to setpriority.S.
	* sysdeps/mach/hurd/setprio.c: Renamed to setpriority.c.
	* sysdeps/stub/getpeernam.c: Renamed to getpeername.c.
	* sysdeps/unix/inet/getpeernam.S: Renamed to getpeername.S.
	* sysdeps/unix/sysv/linux/getpeernam.S: Renamed to getpeername.S.
	* sysdeps/mach/hurd/getpeernam.c: Renamed to getpeername.c.
	* sysdeps/stub/getsocknam.c: Renamed to getsockname.c.
	* sysdeps/unix/inet/getsocknam.S: Renamed to getsockname.S.
	* sysdeps/unix/sysv/linux/getsocknam.S: Renamed to getsockname.S.
	* sysdeps/mach/hurd/getsocknam.c: Renamed to getsockname.c.
	* sysdeps/stub/sigaltstk.c: Renamed to sigaltstack.c.
	* sysdeps/unix/bsd/bsd4.4/sigaltstk.S: Renamed to sigaltstack.S.
	* sysdeps/unix/sysv/sysv4/sigaltstk.S: Renamed to sigaltstack.S.
	* sysdeps/mach/hurd/sigaltstk.c: Renamed to sigaltstack.c.

	* sysdeps/mach/hurd/i386/sigreturn.c: Call __msg_sig_post instead
 	of __sig_post.
	* sysdeps/mach/hurd/sigsuspend.c: Likewise.
	* sysdeps/mach/hurd/kill.c: Likewise.
	* sysdeps/mach/hurd/sigprocmask.c: Likewise.

	* misc/sys/cdefs.h (__NORETURN, __CONSTVALUE): Macros removed.
	[!__GNUC__ || __GNUC__<2] (__attribute__): Define to empty.

	* sysdeps/stub/remove.c: New file.
	* sysdeps/posix/remove.c: New file.

Mon Jan 23 03:26:09 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* time/mktime.c [weak_alias] (timelocal): Define as weak alias for
 	mktime.
	* mach/mig_strncpy.c (mig_strncpy): Define as weak alias for
 	__mig_strncpy.
	* mach/msg-destroy.c: Renamed from __msg_dest.c.
	(mach_msg_destroy): Define as weak alias for __mach_msg_destroy.
	* mach/setup-thread.c (mach_setup_thread): Define as weak alias.
	* time/tzset.c (tzname, daylight, timezone): Define as weak
	aliases for __ names.
	* hurd/hurdkill.c (hurd_sig_post): Define as weak alias.
	* hurd/hurdlookup.c: Add weak aliases for non-__ names.
	* Makefile (+init): Test $(gnu-ld)=yes, not for $(+gnu-stabs)
	being defined.

Sun Jan 22 15:19:51 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* string/Makefile (routines): Remove __ names, index, rindex, and
	bcmp.
	* sysdeps/alpha/strchr.c [weak_alias] (index): Define as weak
	alias for strchr.
	* sysdeps/generic/strchr.c: Likewise.
	* sysdeps/generic/strrchr.c [weak_alias] (rindex): Define as weak
	alias for strrchr.
	* sysdeps/generic/memcmp.c [weak_alias] (bcmp): Define as weak
	alias for memcmp.

	* malloc/free.c (cfree): Define this function, with weak_alias if
	available, otherwise a C function.
	* malloc/Makefile (gmalloc-routines): Remove cfree.

Sat Jan 21 08:08:58 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* stdio/fseek.c: Do move bufp by O when that puts it exactly at
	get_limit.  This has the effect of no-op'ing properly for zero.

	* configure.in: Add AC_CONFIG_HEADER(config.h).
	(--with-elf, --with-weak-symbols): Grok these and define HAVE_*.
	* config.h.in: New file.

	* setjmp/longjmp.c: Add weak aliases _longjmp, siglongjmp.
	All code converted to use weak symbols, defined in the files which
	define the real code (with the __ names, the non-__ names are weak).
	All old symbol alias files removed.
	Many files renamed to remove __ prefix since there is now just
	the one file for both the __ and non-__ name for each function.
	* libc-symbols.h: New file.
	* set-hooks.h: Use libc-symbols.h macros for accessing symbol
	sets.
	* gnu-stabs.h: Prepend #error this file is obsolete.
	* sysdeps/ieee754/ldexp.c: Add weak aliases scalb and __scalb.
	* sysdeps/stub/__access.c: Renamed to access.c; added weak alias
	access.
	* sysdeps/unix/common/__access.S: Likewise.
	* sysdeps/mach/hurd/__access.c: Likewise.
	* sysdeps/stub/__adjtime.c: Renamed to adjtime.c; added weak alias
	adjtime.
	* sysdeps/unix/common/__adjtime.S: Likewise.
	* sysdeps/mach/__adjtime.c: Likewise.
	* sysdeps/mach/hurd/__adjtime.c: Likewise.
	* sysdeps/stub/__brk.c: Renamed to brk.c; added weak alias brk.
	* sysdeps/unix/bsd/sun/m68k/__brk.S: Likewise.
	* sysdeps/unix/bsd/vax/__brk.S: Likewise.
	* sysdeps/unix/bsd/hp/m68k/__brk.S: Likewise.
	* sysdeps/unix/bsd/osf1/alpha/__brk.S: Likewise.
	* sysdeps/unix/i386/__brk.S: Likewise.
	* sysdeps/unix/sparc/__brk.S: Likewise.
	* sysdeps/unix/mips/__brk.S: Likewise.
	* sysdeps/mach/hurd/__brk.c: Likewise.
	* sysdeps/standalone/__brk.c: Likewise.
	* sysdeps/stub/__chdir.c: Renamed to chdir.c; added weak alias chdir.
	* sysdeps/unix/__chdir.S: Likewise.
	* sysdeps/mach/hurd/__chdir.c: Likewise.
	* sysdeps/stub/__chmod.c: Renamed to chmod.c; added weak alias chmod.
	* sysdeps/unix/__chmod.S: Likewise.
	* sysdeps/mach/hurd/__chmod.c: Likewise.
	* sysdeps/stub/__chown.c: Renamed to chown.c; added weak alias chown.
	* sysdeps/unix/__chown.S: Likewise.
	* sysdeps/mach/hurd/__chown.c: Likewise.
	* sysdeps/stub/__close.c: Renamed to close.c; added weak alias close.
	* sysdeps/unix/__close.S: Likewise.
	* sysdeps/mach/hurd/__close.c: Likewise.
	* sysdeps/standalone/__close.c: Likewise.
	* sysdeps/generic/__copysign.c: Renamed to copysign.c; added weak
	alias copysign.
	* sysdeps/ieee754/__copysign.c: Likewise.
	* sysdeps/alpha/__copysign.c: Likewise.
	* sysdeps/ieee754/__drem.c: Renamed to drem.c; added weak alias drem.
	* sysdeps/m68k/fpu/__drem.c: Likewise.
	* sysdeps/stub/__drem.c: Likewise.
	* sysdeps/posix/__dup.c: Renamed to dup.c; added weak alias dup.
	* sysdeps/stub/__dup.c: Likewise.
	* sysdeps/unix/__dup.S: Likewise.
	* sysdeps/posix/__dup2.c: Renamed to dup2.c; added weak alias dup2.
	* sysdeps/stub/__dup2.c: Likewise.
	* sysdeps/unix/sysv/sysv4/__dup2.c: Likewise.
	* sysdeps/unix/sysv/irix4/__dup2.c: Likewise.
	* sysdeps/unix/common/__dup2.S: Likewise.
	* sysdeps/mach/hurd/__dup2.c: Likewise.
	* sysdeps/stub/__execve.c: Renamed to execve.c; added weak alias
	execve.
	* sysdeps/unix/__execve.S: Likewise.
	* sysdeps/mach/hurd/__execve.c: Likewise.
	* sysdeps/generic/__expm1.c: Renamed to expm1.c; added weak alias
	expm1.
	* sysdeps/m68k/fpu/__expm1.c: Likewise.
	* sysdeps/stub/__fchmod.c: Renamed to fchmod.c; added weak alias
	fchmod.
	* sysdeps/unix/common/__fchmod.S: Likewise.
	* sysdeps/mach/hurd/__fchmod.c: Likewise.
	* sysdeps/stub/__fchown.c: Renamed to fchown.c; added weak alias
	fchown.
	* sysdeps/unix/common/__fchown.S: Likewise.
	* sysdeps/mach/hurd/__fchown.c: Likewise.
	* sysdeps/stub/__fcntl.c: Renamed to fcntl.c; added weak alias fcntl.
	* sysdeps/unix/__fcntl.S: Likewise.
	* sysdeps/mach/hurd/__fcntl.c: Likewise.
	* math/__finite.c: Renamed to finite.c; added weak alias finite.
	* sysdeps/posix/__flock.c: Renamed to flock.c; added weak alias flock.
	* sysdeps/stub/__flock.c: Likewise.
	* sysdeps/unix/bsd/__flock.S: Likewise.
	* sysdeps/mach/hurd/__flock.c: Likewise.
	* hurd/__fopenport.c: Renamed to fopenport.c; added weak alias
	fopenport.
	* sysdeps/stub/__fork.c: Renamed to fork.c; added weak alias fork.
	* sysdeps/unix/__fork.S: Likewise.
	* sysdeps/unix/bsd/osf1/alpha/__fork.S: Likewise.
	* sysdeps/unix/i386/__fork.S: Likewise.
	* sysdeps/unix/sparc/__fork.S: Likewise.
	* sysdeps/unix/mips/__fork.S: Likewise.
	* sysdeps/mach/hurd/__fork.c: Likewise.
	* sysdeps/posix/__fpathcon.c: Renamed to fpathcon.c; added weak
	alias fpathconf.
	* sysdeps/stub/__fpathcon.c: Likewise.
	* sysdeps/unix/sysv/irix4/__fpathcon.c: Likewise.
	* sysdeps/stub/__fstat.c: Renamed to fstat.c; added weak alias fstat.
	* sysdeps/unix/__fstat.S: Likewise.
	* sysdeps/unix/sysv/sysv4/i386/__fstat.S: Likewise.
	* sysdeps/mach/hurd/__fstat.c: Likewise.
	* stdio/__getdelim.c: Renamed to getdelim.c; added weak alias
	getdelim.
	* sysdeps/stub/__getdents.c: Renamed to getdents.c; added weak
	alias getdents.
	* sysdeps/unix/__getdents.c: Likewise.
	* sysdeps/unix/bsd/sun/__getdents.S: Likewise.
	* sysdeps/unix/bsd/hp/m68k/__getdents.S: Likewise.
	* sysdeps/unix/bsd/ultrix4/__getdents.S: Likewise.
	* sysdeps/unix/bsd/bsd4.4/__getdents.S: Likewise.
	* sysdeps/unix/bsd/osf1/alpha/__getdents.S: Likewise.
	* sysdeps/unix/sysv/__getdents.c: Likewise.
	* sysdeps/mach/hurd/__getdents.c: Likewise.
	* hurd/__getdport.c: Renamed to getdport.c; added weak alias getdport.
	* sysdeps/posix/__getdtsz.c: Renamed to getdtsz.c; added weak
	alias getdtablesize.
	* sysdeps/stub/__getdtsz.c: Likewise.
	* sysdeps/unix/bsd/__getdtsz.S: Likewise.
	* sysdeps/unix/sysv/sysv4/__getdtsz.c: Likewise.
	* sysdeps/mach/hurd/__getdtsz.c: Likewise.
	* sysdeps/stub/__getegid.c: Renamed to getegid.c; added weak alias
	getegid.
	* sysdeps/unix/__getegid.S: Likewise.
	* sysdeps/mach/hurd/__getegid.c: Likewise.
	* sysdeps/stub/__geteuid.c: Renamed to geteuid.c; added weak alias
	geteuid.
	* sysdeps/unix/__geteuid.S: Likewise.
	* sysdeps/mach/hurd/__geteuid.c: Likewise.
	* sysdeps/stub/__getgid.c: Renamed to getgid.c; added weak alias
	getgid.
	* sysdeps/unix/__getgid.S: Likewise.
	* sysdeps/mach/hurd/__getgid.c: Likewise.
	* sysdeps/stub/__getgrps.c: Renamed to getgroups.c; added weak
	alias getgroups.
	* sysdeps/unix/bsd/sequent/i386/__getgrps.S: Likewise.
	* sysdeps/unix/sysv/sco3.2.4/__getgrps.c: Likewise.
	* sysdeps/unix/sysv/irix4/__getgrps.c: Likewise.
	* sysdeps/unix/common/__getgrps.S: Likewise.
	* sysdeps/mach/hurd/__getgrps.c: Likewise.
	* sysdeps/stub/__gethstnm.c: Renamed to gethostname.c; added weak
	alias gethostname.
	* sysdeps/unix/inet/__gethstnm.S: Likewise.
	* sysdeps/unix/sysv/__gethstnm.c: Likewise.
	* sysdeps/unix/sysv/sysv4/__gethstnm.c: Likewise.
	* sysdeps/mach/hurd/__gethstnm.c: Likewise.
	* sysdeps/stub/__getitmr.c: Renamed to getitimer.c; added weak
	alias getitimer.
	* sysdeps/unix/common/__getitmr.S: Likewise.
	* sysdeps/mach/hurd/__getitmr.c: Likewise.
	* stdio/__getline.c: Renamed to getline.c; added weak alias getline.
	* sysdeps/posix/__getpgsz.c: Renamed to getpagesize.c; added weak
	alias getpagesize.
	* sysdeps/stub/__getpgsz.c: Likewise.
	* sysdeps/unix/__getpgsz.c: Likewise.
	* sysdeps/unix/bsd/__getpgsz.S: Likewise.
	* sysdeps/unix/sysv/sysv4/__getpgsz.c: Likewise.
	* sysdeps/mach/__getpgsz.c: Likewise.
	* sysdeps/stub/__getpid.c: Renamed to getpid.c; added weak alias
	getpid.
	* sysdeps/unix/__getpid.S: Likewise.
	* sysdeps/mach/hurd/__getpid.c: Likewise.
	* sysdeps/stub/__getppid.c: Renamed to getppid.c; added weak alias
	getppid.
	* sysdeps/unix/__getppid.S: Likewise.
	* sysdeps/mach/hurd/__getppid.c: Likewise.
	* sysdeps/posix/__gettod.c: Renamed to gettimeofday.c; added weak
	alias gettimeofday.
	* sysdeps/stub/__gettod.c: Likewise.
	* sysdeps/unix/sysv/irix4/__gettod.c: Likewise.
	* sysdeps/unix/common/__gettod.S: Likewise.
	* sysdeps/mach/__gettod.c: Likewise.
	* sysdeps/stub/__getuid.c: Renamed to getuid.c; added weak alias
	getuid.
	* sysdeps/unix/__getuid.S: Likewise.
	* sysdeps/mach/hurd/__getuid.c: Likewise.
	* sysdeps/generic/__infnan.c: Renamed to infnan.c; added weak
	alias infnan.
	* sysdeps/ieee754/__infnan.c: Likewise.
	* sysdeps/vax/__infnan.c: Likewise.
	* sysdeps/stub/__ioctl.c: Renamed to ioctl.c; added weak alias ioctl.
	* sysdeps/unix/__ioctl.S: Likewise.
	* sysdeps/mach/hurd/__ioctl.c: Likewise.
	* sysdeps/posix/__isatty.c: Renamed to isatty.c; added weak alias
	isatty.
	* sysdeps/stub/__isatty.c: Likewise.
	* sysdeps/unix/bsd/__isatty.c: Likewise.
	* sysdeps/mach/hurd/__isatty.c: Likewise.
	* sysdeps/ieee754/__isinf.c: Renamed to isinf.c; added weak alias
	isinf.
	* sysdeps/m68k/fpu/__isinf.c: Likewise.
	* sysdeps/stub/__isinf.c: Likewise.
	* sysdeps/generic/__isnan.c: Renamed to isnan.c; added weak alias
	isnan.
	* sysdeps/ieee754/__isnan.c: Likewise.
	* sysdeps/m68k/fpu/__isnan.c: Likewise.
	* sysdeps/stub/__kill.c: Renamed to kill.c; added weak alias kill.
	* sysdeps/unix/__kill.S: Likewise.
	* sysdeps/mach/hurd/__kill.c: Likewise.
	* sysdeps/stub/__link.c: Renamed to link.c; added weak alias link.
	* sysdeps/unix/__link.S: Likewise.
	* sysdeps/mach/hurd/__link.c: Likewise.
	* sysdeps/ieee754/__logb.c: Renamed to logb.c; added weak alias logb.
	* sysdeps/m68k/fpu/__logb.c: Likewise.
	* sysdeps/stub/__logb.c: Likewise.
	* sysdeps/stub/__lseek.c: Renamed to lseek.c; added weak alias lseek.
	* sysdeps/unix/__lseek.S: Likewise.
	* sysdeps/mach/hurd/__lseek.c: Likewise.
	* sysdeps/generic/__lstat.c: Renamed to lstat.c; added weak alias
	lstat.
	* sysdeps/stub/__lstat.c: Likewise.
	* sysdeps/unix/sysv/sysv4/i386/__lstat.S: Likewise.
	* sysdeps/unix/common/__lstat.S: Likewise.
	* sysdeps/mach/hurd/__lstat.c: Likewise.
	* sysdeps/generic/__memccpy.c: Renamed to memccpy.c; added weak
	alias memccpy.
	* sysdeps/vax/__memccpy.c: Likewise.
	* sysdeps/stub/__mkdir.c: Renamed to mkdir.c; added weak alias mkdir.
	* sysdeps/unix/sysv/__mkdir.c: Likewise.
	* sysdeps/unix/common/__mkdir.S: Likewise.
	* sysdeps/mach/hurd/__mkdir.c: Likewise.
	* sysdeps/stub/__mknod.c: Renamed to mknod.c; added weak alias mknod.
	* sysdeps/unix/__mknod.S: Likewise.
	* sysdeps/unix/sysv/sysv4/i386/__mknod.S: Likewise.
	* sysdeps/mach/hurd/__mknod.c: Likewise.
	* mach/__msg.c: Renamed to msg.c; added weak alias mach_msg.
	* mach/__msgserver.c: Renamed to msgserver.c; added weak alias
	mach_msg_server.
	* sysdeps/stub/__open.c: Renamed to open.c; added weak alias open.
	* sysdeps/unix/__open.S: Likewise.
	* sysdeps/mach/hurd/__open.c: Likewise.
	* sysdeps/standalone/__open.c: Likewise.
	* sysdeps/stub/__pathconf.c: Renamed to pathconf.c; added weak
	alias pathconf.
	* sysdeps/unix/sysv/sco3.2.4/__pathconf.S: Likewise.
	* sysdeps/unix/sysv/irix4/__pathconf.c: Likewise.
	* hurd/__pid2task.c: Renamed to pid2task.c; added weak alias pid2task.
	* sysdeps/stub/__pipe.c: Renamed to pipe.c; added weak alias pipe.
	* sysdeps/unix/bsd/vax/__pipe.S: Likewise.
	* sysdeps/unix/bsd/m68k/__pipe.S: Likewise.
	* sysdeps/unix/bsd/osf1/alpha/__pipe.S: Likewise.
	* sysdeps/unix/i386/__pipe.S: Likewise.
	* sysdeps/unix/sparc/__pipe.S: Likewise.
	* sysdeps/unix/mips/__pipe.S: Likewise.
	* sysdeps/mach/hurd/__pipe.c: Likewise.
	* stdlib/__random.c: Renamed to random.c; added weak alias random.
	* sysdeps/stub/__read.c: Renamed to read.c; added weak alias read.
	* sysdeps/unix/__read.S: Likewise.
	* sysdeps/mach/hurd/__read.c: Likewise.
	* sysdeps/standalone/__read.c: Likewise.
	* sysdeps/stub/__readlink.c: Renamed to readlink.c; added weak
	alias readlink.
	* sysdeps/unix/common/__readlink.S: Likewise.
	* sysdeps/mach/hurd/__readlink.c: Likewise.
	* sysdeps/generic/__rint.c: Renamed to rint.c; added weak alias rint.
	* sysdeps/m68k/fpu/__rint.c: Likewise.
	* sysdeps/stub/__rmdir.c: Renamed to rmdir.c; added weak alias rmdir.
	* sysdeps/unix/sysv/__rmdir.c: Likewise.
	* sysdeps/unix/common/__rmdir.S: Likewise.
	* sysdeps/mach/hurd/__rmdir.c: Likewise.
	* sysdeps/generic/__sbrk.c: Renamed to sbrk.c; added weak alias sbrk.
	* sysdeps/stub/__sbrk.c: Likewise.
	* sysdeps/mach/hurd/__sbrk.c: Likewise.
	* math/__scalb.c: Renamed to scalb.c; added weak alias scalb.
	* sysdeps/stub/__select.c: Renamed to select.c; added weak alias
	select.
	* sysdeps/unix/common/__select.S: Likewise.
	* sysdeps/mach/hurd/__select.c: Likewise.
	* hurd/__setauth.c: Renamed to setauth.c; added weak alias setauth.
	* sysdeps/stub/__setgid.c: Renamed to setgid.c; added weak alias
	setgid.
	* sysdeps/unix/__setgid.S: Likewise.
	* sysdeps/unix/bsd/__setgid.c: Likewise.
	* sysdeps/mach/hurd/__setgid.c: Likewise.
	* sysdeps/stub/__setitmr.c: Renamed to setitmr.c; added weak alias
	setitmr
	* sysdeps/unix/common/__setitmr.S: Likewise.
	* sysdeps/mach/hurd/__setitmr.c: Likewise.
	* sysdeps/stub/__setpgrp.c: Renamed to setpgrp.c; added weak alias
	setpgrp
	* sysdeps/unix/sysv/sysv4/__setpgrp.c: Likewise.
	* sysdeps/unix/sysv/sco3.2.4/__setpgrp.c: Likewise.
	* sysdeps/unix/sysv/irix4/__setpgrp.S: Likewise.
	* sysdeps/unix/common/__setpgrp.S: Likewise.
	* sysdeps/mach/hurd/__setpgrp.c: Likewise.
	* sysdeps/stub/__setregid.c: Renamed to setregid.c; added weak
	alias setregid.
	* sysdeps/unix/common/__setregid.S: Likewise.
	* sysdeps/mach/hurd/__setregid.c: Likewise.
	* sysdeps/stub/__setreuid.c: Renamed to setreuid.c; added weak
	alias setreuid.
	* sysdeps/unix/common/__setreuid.S: Likewise.
	* sysdeps/mach/hurd/__setreuid.c: Likewise.
	* sysdeps/stub/__setsid.c: Renamed to setsid.c; added weak alias
	setsid.
	* sysdeps/unix/bsd/__setsid.c: Likewise.
	* sysdeps/unix/bsd/sun/sunos4/__setsid.S: Likewise.
	* sysdeps/unix/bsd/ultrix4/__setsid.S: Likewise.
	* sysdeps/unix/bsd/bsd4.4/__setsid.S: Likewise.
	* sysdeps/unix/sysv/linux/__setsid.S: Likewise.
	* sysdeps/unix/sysv/sysv4/__setsid.c: Likewise.
	* sysdeps/unix/sysv/sco3.2.4/__setsid.c: Likewise.
	* sysdeps/mach/hurd/__setsid.c: Likewise.
	* sysdeps/stub/__settod.c: Renamed to settod.c; added weak alias
	settimeofday.
	* sysdeps/unix/bsd/__settod.S: Likewise.
	* sysdeps/unix/sysv/__settod.c: Likewise.
	* sysdeps/mach/hurd/__settod.c: Likewise.
	* sysdeps/stub/__setuid.c: Renamed to setuid.c; added weak alias
	setuid.
	* sysdeps/unix/__setuid.S: Likewise.
	* sysdeps/unix/bsd/__setuid.c: Likewise.
	* sysdeps/mach/hurd/__setuid.c: Likewise.
	* sysdeps/posix/__sigblock.c: Renamed to sigblock.c; added weak
	alias sigblock.
	* sysdeps/stub/__sigblock.c: Likewise.
	* sysdeps/unix/bsd/__sigblock.S: Likewise.
	* sysdeps/unix/bsd/bsd4.4/__sigblock.c: Likewise.
	* sysdeps/unix/bsd/osf1/alpha/__sigblock.S: Likewise.
	* sysdeps/posix/__sigpause.c: Renamed to sigpause.c; added weak
	alias sigpause.
	* sysdeps/stub/__sigpause.c: Likewise.
	* sysdeps/unix/bsd/__sigpause.S: Likewise.
	* sysdeps/unix/bsd/osf1/alpha/__sigpause.S: Likewise.
	* sysdeps/stub/__sigproc.c: Renamed to sigprocmask.c; added weak
	alias sigprocmask.
	* sysdeps/unix/bsd/__sigproc.c: Likewise.
	* sysdeps/unix/sysv/sysv4/__sigproc.S: Likewise.
	* sysdeps/unix/sysv/sco3.2.4/__sigproc.S: Likewise.
	* sysdeps/mach/hurd/__sigproc.c: Likewise.
	* sysdeps/stub/__sigret.c: Renamed to sigreturn.c; added weak
	alias sigreturn.
	* sysdeps/unix/bsd/sun/__sigret.S: Likewise.
	* sysdeps/unix/sysv/i386/__sigret.S: Likewise.
	* sysdeps/unix/sysv/irix4/__sigret.S: Likewise.
	* sysdeps/unix/i386/__sigret.S: Likewise.
	* sysdeps/unix/mips/__sigret.S: Likewise.
	* sysdeps/mach/hurd/i386/__sigret.c: Likewise.
	* sysdeps/mach/hurd/alpha/__sigret.c: Likewise.
	* sysdeps/mach/hurd/mips/__sigret.c: Likewise.
	* sysdeps/posix/__sigvec.c: Renamed to sigvec.c; added weak alias
	sigvec.
	* sysdeps/stub/__sigvec.c: Likewise.
	* sysdeps/unix/bsd/__sigvec.S: Likewise.
	* sysdeps/unix/bsd/sun/__sigvec.S: Likewise.
	* sysdeps/unix/bsd/sequent/i386/__sigvec.S: Likewise.
	* sysdeps/unix/bsd/ultrix4/mips/__sigvec.S: Likewise.
	* sysdeps/unix/bsd/bsd4.4/__sigvec.c: Likewise.
	* sysdeps/unix/bsd/osf1/alpha/__sigvec.S: Likewise.
	* sysdeps/stub/__stat.c: Renamed to stat.c; added weak alias stat.
	* sysdeps/unix/__stat.S: Likewise.
	* sysdeps/unix/sysv/sysv4/i386/__stat.S: Likewise.
	* sysdeps/mach/hurd/__stat.c: Likewise.
	* sysdeps/generic/__stpncpy.c: Renamed to stpncpy.c; added weak
	alias stpncpy.
	* sysdeps/stub/__symlink.c: Renamed to symlink.c; added weak alias
	symlink.
	* sysdeps/unix/common/__symlink.S: Likewise.
	* sysdeps/mach/hurd/__symlink.c: Likewise.
	* sysdeps/posix/__sysconf.c: Renamed to sysconf.c; added weak
	alias sysconf.
	* sysdeps/stub/__sysconf.c: Likewise.
	* sysdeps/unix/bsd/ultrix4/__sysconf.c: Likewise.
	* sysdeps/unix/sysv/sysv4/__sysconf.c: Likewise.
	* sysdeps/unix/sysv/sco3.2.4/__sysconf.S: Likewise.
	* sysdeps/unix/sysv/irix4/__sysconf.c: Likewise.
	* hurd/__task2pid.c: Renamed to task2pid.c; added weak alias task2pid.
	* sysdeps/stub/__times.c: Renamed to times.c; added weak alias times.
	* sysdeps/unix/bsd/__times.c: Likewise.
	* sysdeps/unix/sysv/__times.S: Likewise.
	* time/__tzset.c: Renamed to tzset.c; added weak alias tzset.
	* sysdeps/stub/__umask.c: Renamed to umask.c; added weak alias umask.
	* sysdeps/unix/__umask.S: Likewise.
	* sysdeps/mach/hurd/__umask.c: Likewise.
	* sysdeps/stub/__unlink.c: Renamed to unlink.c; added weak alias
	unlink.
	* sysdeps/unix/__unlink.S: Likewise.
	* sysdeps/mach/hurd/__unlink.c: Likewise.
	* sysdeps/stub/__utimes.c: Renamed to utimes.c; added weak alias
	utimes.
	* sysdeps/unix/bsd/__utimes.S: Likewise.
	* sysdeps/unix/sysv/sysv4/solaris2/__utimes.S: Likewise.
	* sysdeps/mach/hurd/__utimes.c: Likewise.
	* sysdeps/generic/__vfork.c: Renamed to vfork.c; added weak alias
	vfork.
	* sysdeps/unix/bsd/sun/m68k/__vfork.S: Likewise.
	* sysdeps/unix/bsd/vax/__vfork.S: Likewise.
	* sysdeps/unix/bsd/i386/__vfork.S: Likewise.
	* sysdeps/unix/bsd/hp/m68k/__vfork.S: Likewise.
	* sysdeps/unix/bsd/ultrix4/mips/__vfork.S: Likewise.
	* sysdeps/unix/sysv/sysv4/i386/__vfork.S: Likewise.
	* sysdeps/unix/sparc/__vfork.S: Likewise.
	* stdio/__vfscanf.c: Renamed to vfscanf.c; added weak alias vfscanf.
	* stdio/__vsscanf.c: Renamed to vsscanf.c; added weak alias vsscanf.
	* sysdeps/posix/__wait.c: Renamed to wait.c; added weak alias wait.
	* sysdeps/stub/__wait.c: Likewise.
	* sysdeps/unix/bsd/sony/newsos4/__wait.c: Likewise.
	* sysdeps/unix/bsd/sun/sunos4/__wait.c: Likewise.
	* sysdeps/unix/bsd/sun/sunos3/m68k/__wait.S: Likewise.
	* sysdeps/unix/bsd/vax/__wait.S: Likewise.
	* sysdeps/unix/bsd/m68k/__wait.S: Likewise.
	* sysdeps/unix/bsd/bsd4.4/__wait.c: Likewise.
	* sysdeps/unix/sysv/i386/linux/__wait.S: Likewise.
	* sysdeps/unix/sysv/irix4/__wait.S: Likewise.
	* sysdeps/unix/i386/__wait.S: Likewise.
	* sysdeps/unix/mips/__wait.S: Likewise.
	* sysdeps/posix/__wait3.c: Renamed to wait3.c; added weak alias wait3.
	* sysdeps/stub/__wait3.c: Likewise.
	* sysdeps/unix/bsd/sony/newsos4/__wait3.c: Likewise.
	* sysdeps/unix/bsd/sun/sunos4/__wait3.c: Likewise.
	* sysdeps/unix/bsd/vax/__wait3.S: Likewise.
	* sysdeps/unix/bsd/i386/__wait3.S: Likewise.
	* sysdeps/unix/bsd/hp/m68k/__wait3.S: Likewise.
	* sysdeps/unix/bsd/ultrix4/__wait3.S: Likewise.
	* sysdeps/unix/bsd/bsd4.4/__wait3.c: Likewise.
	* sysdeps/unix/sysv/irix4/__wait3.S: Likewise.
	* sysdeps/stub/__wait4.c: Renamed to wait4.c; added weak alias wait4.
	* sysdeps/unix/bsd/sony/newsos4/__wait4.c: Likewise.
	* sysdeps/unix/bsd/sun/sunos4/__wait4.c: Likewise.
	* sysdeps/unix/bsd/bsd4.4/__wait4.S: Likewise.
	* sysdeps/unix/bsd/osf1/alpha/__wait4.S: Likewise.
	* sysdeps/unix/sysv/linux/__wait4.S: Likewise.
	* sysdeps/mach/hurd/__wait4.c: Likewise.
	* sysdeps/stub/__waitpid.c: Renamed to waitpid.c; added weak alias
	waitpid.
	* sysdeps/unix/bsd/sun/sunos4/__waitpid.c: Likewise.
	* sysdeps/unix/bsd/ultrix4/__waitpid.S: Likewise.
	* sysdeps/unix/bsd/bsd4.4/__waitpid.c: Likewise.
	* sysdeps/unix/bsd/osf1/alpha/__waitpid.c: Likewise.
	* sysdeps/unix/sysv/linux/__waitpid.S: Likewise.
	* sysdeps/unix/sysv/sysv4/__waitpid.c: Likewise.
	* sysdeps/unix/sysv/sco3.2.4/__waitpid.S: Likewise.
	* sysdeps/unix/sysv/irix4/__waitpid.c: Likewise.
	* sysdeps/stub/__write.c: Renamed to write.c; added weak alias write.
	* sysdeps/unix/__write.S: Likewise.
	* sysdeps/mach/hurd/__write.c: Likewise.
	* sysdeps/standalone/__write.c: Likewise.
	* sysdeps/stub/__tcgetatr.c: Renamed to tcgetattr.c; added weak
	alias tcgetattr.
	* sysdeps/unix/bsd/__tcgetatr.c: Likewise.
	* sysdeps/unix/bsd/sun/sunos4/__tcgetatr.c: Likewise.
	* sysdeps/unix/bsd/bsd4.4/__tcgetatr.c: Likewise.
	* sysdeps/unix/sysv/__tcgetatr.c: Likewise.
	* sysdeps/stub/__sigact.c: Renamed to sigaction.c; added weak
	alias sigaction.
	* sysdeps/unix/bsd/__sigact.c: Likewise.
	* sysdeps/unix/sysv/__sigact.c: Likewise.
	* sysdeps/unix/sysv/sysv4/__sigact.c: Likewise.
	* sysdeps/unix/sysv/sco3.2.4/__sigact.S: Likewise.
	* sysdeps/mach/hurd/__sigact.c: Likewise.
	* sysdeps/posix/__sigstmsk.c: Renamed to sigsetmask.c; added weak
	alias sigsetmask.
	* sysdeps/stub/__sigstmsk.c: Likewise.
	* sysdeps/unix/bsd/__sigstmsk.S: Likewise.
	* sysdeps/unix/bsd/bsd4.4/__sigstmsk.c: Likewise.
	* sysdeps/unix/bsd/osf1/alpha/__sigstmsk.S: Likewise.
	* sysdeps/stub/__getrusag.c: Renamed to getrusage.c; added weak
	alias getrusage.
	* sysdeps/unix/sysv/irix4/__getrusag.c: Likewise.
	* sysdeps/unix/common/__getrusag.S: Likewise.
	* hurd/task2pid.c: File removed.
	* hurd/setauth.c: File removed.
	* hurd/pid2task.c: File removed.
	* hurd/hurdsyms.c: File removed.
	* hurd/getdport.c: File removed.
	* hurd/fopenport.c: File removed.
	* mach/thread-sym.c: File removed.
	* mach/spin-syms.c: File removed.
	* mach/msgserver_t.c: File removed.
	* mach/msgserver.c: File removed.
	* mach/msg.c: File removed.
	* mach/mig_syms.c: File removed.
	* malloc/mcheck-init.c: File removed.
	* malloc/cfree.c: File removed.
	* io/flock.c: File removed.
	* io/write.c: File removed.
	* io/unlink.c: File removed.
	* io/umask.c: File removed.
	* io/symlink.c: File removed.
	* io/rmdir.c: File removed.
	* io/readlink.c: File removed.
	* io/read.c: File removed.
	* io/pipe.c: File removed.
	* io/open.c: File removed.
	* io/mkdir.c: File removed.
	* io/lstat.c: File removed.
	* io/lseek.c: File removed.
	* io/link.c: File removed.
	* io/isatty.c: File removed.
	* io/stat.c: File removed.
	* io/fstat.c: File removed.
	* io/fchown.c: File removed.
	* io/fchmod.c: File removed.
	* io/dup2.c: File removed.
	* io/dup.c: File removed.
	* io/close.c: File removed.
	* io/fcntl.c: File removed.
	* io/chmod.c: File removed.
	* io/chdir.c: File removed.
	* io/access.c: File removed.
	* io/chown.c: File removed.
	* time/tzset.c: File removed.
	* time/timelocal.c: File removed.
	* time/syms-time.c: File removed.
	* time/settod.c: File removed.
	* time/setitmr.c: File removed.
	* time/gettod.c: File removed.
	* time/getitmr.c: File removed.
	* time/adjtime.c: File removed.
	* termios/tcgetattr.c: File removed.
	* string/stpncpy.c: File removed.
	* string/rindex.c: File removed.
	* string/memccpy.c: File removed.
	* string/index.c: File removed.
	* string/bcmp.c: File removed.
	* stdlib/srand.c: File removed.
	* stdlib/random.c: File removed.
	* stdio/vsscanf.c: File removed.
	* stdio/vfscanf.c: File removed.
	* stdio/syms-stdio.c: File removed.
	* stdio/remove.c: File removed.
	* stdio/getline.c: File removed.
	* stdio/getdelim.c: File removed.
	* signal/ssignal.c: File removed.
	* signal/sigvec.c: File removed.
	* signal/sigsetmask.c: File removed.
	* signal/sigret.c: File removed.
	* signal/sigproc.c: File removed.
	* signal/sigpause.c: File removed.
	* signal/sigblock.c: File removed.
	* signal/sigaction.c: File removed.
	* signal/kill.c: File removed.
	* signal/gsignal.c: File removed.
	* setjmp/siglongjmp.c: File removed.
	* setjmp/_longjmp.c: File removed.
	* resource/getrusage.c: File removed.
	* posix/waitpid.c: File removed.
	* posix/wait4.c: File removed.
	* posix/wait3.c: File removed.
	* posix/wait.c: File removed.
	* posix/times.c: File removed.
	* posix/sysconf.c: File removed.
	* posix/setuid.c: File removed.
	* posix/setsid.c: File removed.
	* posix/setpgrp.c: File removed.
	* posix/setpgid.c: File removed.
	* posix/setgid.c: File removed.
	* posix/pathconf.c: File removed.
	* posix/getuid.c: File removed.
	* posix/getppid.c: File removed.
	* posix/getpid.c: File removed.
	* posix/getgrps.c: File removed.
	* posix/getgid.c: File removed.
	* posix/geteuid.c: File removed.
	* posix/getegid.c: File removed.
	* posix/fpathcon.c: File removed.
	* posix/fork.c: File removed.
	* posix/execve.c: File removed.
	* posix/environ.c: File removed.
	* misc/utimes.c: File removed.
	* misc/setreuid.c: File removed.
	* misc/setregid.c: File removed.
	* misc/select.c: File removed.
	* misc/sbrk.c: File removed.
	* misc/mknod.c: File removed.
	* misc/ioctl.c: File removed.
	* misc/getpgsz.c: File removed.
	* misc/gethstnm.c: File removed.
	* misc/getdtsz.c: File removed.
	* misc/data_start.c: File removed.
	* misc/brk.c: File removed.
	* math/scalb.c: File removed.
	* math/rint.c: File removed.
	* math/logb.c: File removed.
	* math/isnan.c: File removed.
	* math/isinf.c: File removed.
	* math/infnan.c: File removed.
	* math/finite.c: File removed.
	* math/expm1.c: File removed.
	* math/drem.c: File removed.
	* math/copysign.c: File removed.
	* math/__scalb.c: File removed.
	* dirent/getdents.c: File removed.

Fri Jan 20 16:11:06 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/generic/morecore.c (__default_morecore): Use
	__malloc_ptrdiff_t; don't cast arg to int.

	* resolv/getnetnamadr.c: Include "conf/portability.h".

Thu Jan 19 02:20:04 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* stdlib/strtol.c: Include errno.h.
	[QUAD] (ULONG_MAX): Define to a static variable initialized to
	ULONG_LONG_MAX. This is to work around a GCC bug in using the
	constant in arithmetic.

	* posix/unistd.h (daemon): Declare it.

	* malloc/mcheck-init.c: Remove GNU ld hacks.
	(__malloc_initialize_hook): Initialize this hook to turn_on_mcheck.
	* malloc/malloc.c (__malloc_initialize_hook): New hook variable.
	(initialize): Call the hook if set.
	* malloc/malloc.h: Use __malloc_{size,ptrdiff}_t in prototypes.
	(__malloc_initialize_hook): Declare new hook variable.

Wed Jan 18 01:43:39 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* hurd/hurdsig.c: Prepend `msg_' to server RPC names.
	* hurd/hurdpid.c: Likewise.
	* hurd/hurdauth.c: Likewise.

Tue Jan 17 03:16:47 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/__select.c: If some replies are EINTR, succeed
        if any are successful.

	* hurd/hurdmsg.c: Prepend `msg_' to all RPC names.
	(_S_msg_get_exec_flags, _S_msg_set_exec_flags,
	_S_msg_set_some_exec_flags, _S_msg_clear_some_exec_flags): New
        functions.
	(_S_io_select_done, _S_dir_changed, _S_file_changed): Stubs removed.

	* hurd/hurdkill.c: __sig_post renamed to __msg_sig_post.
	* hurd/hurd-raise.c: Likewise.
	* hurd/hurdsig.c (post_reply): Prepend `msg_' to RPC names.

	* sysdeps/mach/hurd/ptrace.c: New file.

	* sysdeps/mach/hurd/__select.c: Revamped to use new io_select
	interface, which has normal EINTR semantics.  Instead of waiting
	for io_select_done notification messages, send io_select messages
	with short reply timeout and then wait for io_select_reply
	messages.

	* hurd/hurdexec.c (_hurd_exec): Pass (_hurd_exec_flags &
        EXEC_INHERITED) to file_exec.

	* hurd/hurdsig.c (post_reply): Take new arg UNTRACED; if nonzero,
	use sig_post_untraced_reply.  All callers changed.
	(abort_thread, abort_rpcs): Take same new arg and pass it through.
	All callers changed.
	(_hurd_internal_post_signal): Take new arg UNTRACED.
	If zero and process is traced, stop with SIGNO as stop signal.  If
	nonzero, resume process before delivering signal (unless
	ACT==stop).  Expand local fn sigwakeup into block at end taken iff
	SIGNO!=0.
	(signal_allowed): New function, broken out of _S_sig_post.
	(_S_sig_post): Call it.  Pass UNTRACED arg of false to
	_hurd_internal_post_signal.
	(_S_sig_post_untraced): New function.  Just like _S_sig_post, but
	pass true for UNTRACED.
	* hurd/hurd/signal.h (_hurd_internal_post_signal): Take new arg
        UNTRACED.
	* hurd/catch-exc.c (_S_catch_exception_raise): Pass UNTRACED arg
        to _hurd_internal_post_signal (value zero).

Mon Jan 16 16:40:01 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* hurd/hurdinit.c (_hurd_exec_flags): New variable.
	(_hurd_init): Initialize it from FLAGS arg.
	(_hurd_proc_init): If EXEC_TRACED is set in _hurd_exec_flags,
	raise a SIGTRAP signal (with a sigcode of zero).
	* hurd/hurd.h (_hurd_exec_flags): Declare it.

	* Version 1.09.5.

Mon Jan 16 16:16:55 1995  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* malloc/malloc.c (malloc): Fix 1-off in previous change.

Mon Jan 16 15:49:07 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* posix/glob/Makefile.in: Remove config.h and config.log.

Sun Jan 15 06:56:47 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* posix/glob/configure.in: Add AC_CONST check.

	* conf/portability.h: #undef sun.
	* resolv/res_query.c: Updated from BIND-4.9.3-BETA17.
	* resolv/getnetnamadr.c: Likewise.

	* socket/Makefile (headers): Add sockaddrcom.h.
	* inet/netinet/in.h: Include <sockaddrcom.h>.
	(struct sockaddr_in): Use the __SOCKADDR_COMMON macro.
	* socket/sys/un.h (struct sockaddr_in): Likewise.
	* socket/sys/socket.h (struct sockaddr): Likewise.
	* sysdeps/unix/bsd/bsd4.4/sockaddrcom.h: New file.
	* sysdeps/generic/sockaddrcom.h: New file.

	* sysdeps/unix/sysv/sysv4/ftruncate.c: New file.
	* sysdeps/unix/common/fcntlbits.h [__USE_SVID] (F_ALLOCSP,
        F_FREESP): New macros.
	* sysdeps/posix/truncate.c: New file.

	* malloc/malloc.c (malloc): Fix typos in RMS's change.

	* malloc/Makefile (dist-routines): Add malloc-find.
	* malloc/malloc.h (malloc_find_object_address): Declare it.
	* malloc/malloc-find.c: New file.

	* malloc/malloc.h (__malloc_ptrdiff_t): New macro, defined a la
        __malloc_size_t.
	(malloc_info): Use that type for member `busy.info.size'.

	* stdlib/strtol.c: Change uses of `long' keyword throughout to use
        `LONG' macro.
	[! QUAD] (LONG): Define as long.
	[QUAD] (LONG): Define as long long.
	[QUAD] (LONG_MIN, LONG_MAX, ULONG_MAX): Redefine to long long
	versions.
	[QUAD] (strtoul, strtol): Define to strtouq, strtoq.
	* stdlib/Makefile (routines): Add strtoq and strtouq.
	* stdlib/strtoq.c, stdlib/strtouq.c: New files.
	* stdlib/stdlib.h [__GNUC__ && __USE_BSD] (strtoq, strtouq):
        Declare them.

	* stdio/vfprintf.c: If there was a precision specified, ignore the
	0 flag and always pad with spaces.

	* stdio/vfprintf.c: Don't use strchr to skip text until next %.
	Use a loop and also stop on first !isascii char.

Wed Jan 11 00:07:10 1995  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* malloc/malloc.h (malloc_info): Change usage of .busy.info.size.

	* malloc/malloc.c (malloc): For a multi-block object, store a
	negative number into the busy.info.size of all but the first block.

Tue Jan 10 13:45:20 1995  Brendan Kehoe  <brendan@zen.org>

	* sysdeps/unix/bsd/ultrix4/mips/start.S: Use s0, s1, and s2
	instead of t0, t1, and t2.

Tue Jan 10 05:53:50 1995  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* malloc/memalign.c (__memalign_hook): New variable.
	(memalign): Call it if set.
	* malloc/malloc.h (__memalign_hook): Declare new variable.

Wed Dec 28 03:27:21 1994  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* conf/portability.h: Include string.h and stdlib.h.
	* inet/netdb.h (NETDB_INTERNAL, NETDB_SUCCESS): New macros.
	* resolv/resolv.h, resolv/arpa/nameser.h, resolv/gethnamaddr.c,
	resolv/getnetbyname.c, resolv/getnetent.c, resolv/herror.c,
	resolv/res_mkquery.c, resolv/res_send.c, resolv/res_comp.c,
	resolv/res_debug.c, resolv/res_init.c: Updated from BIND 4.9.3-BETA14.

	* sysdeps/m68k/fpu/__math.h (__m81_inline): New macro.  Replace
	all uses of `extern __inline' with `__m81_inline'.

	* sysdeps/unix/bsd/hp/m68k/__vfork.S: Use subl, not decl.
	* sysdeps/unix/__fork.S: Swap args in subl.

	* posix/sys/types.h [__USE_MISC] (ushort, uint): New typedefs, for
        compatibility.

Tue Dec 20 13:33:20 1994  Michael I Bushnell  <mib@geech.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/__setpgrp.c (__setpgrp): Use __swtch_pri instead
        of swtch.
	* sysdeps/mach/hurd/__setsid.c (__setsid): Likewise.
	* mach/spin-solid.c (__spin_lock_solid): Likewise.

Thu Dec 15 12:01:07 1994  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* inet/rcmd.c (iruserok): Use alloca instead of fixed-size buffer
        for PBUF.
	(__ivaliduser): Use getline instead of fgets with fixed-size buffer.

	* sysdeps/mach/hurd/Makefile (subdirs): Don't elide inet.

Wed Dec 14 18:20:56 1994  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/alpha/bsd-setjmp.S: Reverse register and immediate args
	in `bis' insn; immediate must be second.

	* sysdeps/unix/__fork.S: Use subl instead of decl.
	* sysdeps/unix/i386/__fork.S: New file.

	* sysdeps/mach/hurd/alpha/trampoline.c (_hurd_setup_sighandler):
	Remove A macro; just use `asm volatile' with proper quotes in each
	line.
	* sysdeps/mach/alpha/sysdep.h (CALL_WITH_SP): Put parens around
        jmp target register.

	* time/africa, time/asia, time/australasia, time/emkdir.c,
	time/europe, time/ialloc.c, time/northamerica, time/private.h,
	time/scheck.c, time/yearistype, time/zdump.c, time/zic.c: New code
	and data from ADO 94h distribution.

	* sysdeps/sparc/setjmp.S: Use sethi and or to put address of
	__sigjmp_save in %g1 and jmp there.  jmp cannot contain a complete
	absolute pointer.  Put second store in jmp delay slot.

Tue Dec 13 15:47:52 1994  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* sysdeps/sparc/bsd-_setjmp.S: Use sethi and or to put address of
	__sigsetjmp in %g1 and jmp there.  jmp cannot contain a complete
	absolute pointer.
	* sysdeps/sparc/bsd-setjmp.S: Likewise.

	* configure.in: Use ; before } in { ... } exprs.



See ChangeLog.4 for earlier changes.
